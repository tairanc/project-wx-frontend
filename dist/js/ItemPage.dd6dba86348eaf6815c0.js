(window.webpackJsonp=window.webpackJsonp||[]).push([[26,15],{"3fLG":function(e,t,a){"use strict";(function(e){var n=c(a("Zx67")),r=c(a("kiBT")),i=c(a("OvRC")),o=c(a("pFYg")),l=c(a("C4MV")),s=c(a("woOf"));function c(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var u=s.default||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},d=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,l.default)(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();t.preventScroll=T,t.ItemPageState=D,t.ItemPageDispatch=P;var p=a("U7vG"),m=x(p),f=a("4n+p"),h=a("Zfgq"),g=a("f2Hk"),v=x(a("qAHI")),_=a("qeJi"),y=a("d2xe"),E=(a("fw66"),a("5qLU")),w=a("f2t5");a("6quk"),a("nztU");a("kjFZ");var b=x(a("JmOZ")),S=x(a("m9/l")),k=x(a("Wkbk"));function x(e){return e&&e.__esModule?e:{default:e}}var N={Detail:{url:E.WXAPI+"/item/detail",method:"get"},Mix:{url:E.WXAPI+"/item/mix",method:"get"},Promotion:{url:E.WXAPI+"/item/promotion",method:"get"},Rate:{url:E.WXAPI+"/item/rate",method:"get"},Recommend:{url:E.WXAPI+"/item/recommend",method:"get"},GetCart:{url:E.WXAPI+"/cart/count",type:"get"}},C=(0,g.actionAxios)("itemIndex"),A=(0,g.concatPageAndType)("itemIndex");function I(t){t.find("a").each(function(){var t=e(this).attr("href");if(t&&!/^t/.test(t)&&!/channel/.test(t)){var a;a=t+(/\?/.test(t)?"&":"?")+"channel="+channel,e(this).attr("href",a)}})}function T(t){t?e("body").css({overflow:"hidden"}):e("body").css({overflow:"auto"})}var M=function(t){function a(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,o.default)(t))&&"function"!=typeof t?e:t}(this,(a.__proto__||(0,n.default)(a)).call(this,e));return t.selectModel=function(){var e=void 0;switch(t.props.data.item_type){case"GroupBuy":e=m.default.createElement(k.default,t.props);break;case"SecKill":e=m.default.createElement(S.default,t.props);break;default:e=m.default.createElement(b.default,t.props)}return e},t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,o.default)(t)));e.prototype=(0,i.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(r.default?(0,r.default)(e,t):e.__proto__=t)}(a,p.Component),d(a,[{key:"componentWillMount",value:function(){var e=this.props.location.query,t=e.item_id,a=e.mini;(0,w.redirectURL)(location.pathname+location.search,a),document.title="商品详情";var n=_.browser.versions,r=n.iPhone,i=n.iPad,o=n.weixin,l=location.href.split("#")[0];o&&!i&&!r&&(0,y.getJSApi)(l);var s=this.props.firstT||+new Date+"",c=this.props.data&&this.props.data.item_id?+new Date+"":0;t||h.browserHistory.push("/"),t==this.props.data.item_id&&"loginBack"!==this.props.loginBack||(this.props.InitAndClearData(),this.props.Detail(t),this.props.Promotion(t),this.props.Rate(t),this.props.isLogin&&this.props.GetCart()),this.props.data.title&&window.sessionStorage.setItem("dcpPageTitle",this.props.data.title),this.props.UpdataTimer(s,c)}},{key:"componentDidMount",value:function(){var t,a,n,r;(t="channel",a=window.location.search.replace(/^\?/,""),n=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),(r=a.match(n))?r[2]:null)&&I(e("body")),this.props.buyModal||this.props.promotionModal||this.props.couponsModal||this.props.searverModal?T(!0):T(!1)}},{key:"componentWillReceiveProps",value:function(t){var a=t.location.query.item_id,n=this.props.location.query.item_id,r=t.status,i=t.mixStatus,o=t.rateStatus,l=t.recommendStatus,s=t.proStatus,c=t.cartInfoStatus,u=window.mapScrollHeight&&window.mapScrollHeight[n];if(r&&i&&o&&l&&s&&c&&u&&(this.timer=setTimeout(function(){e(window).scrollTop(u)},1),this.timer=null,window.mapScrollHeight.item_id=null),this.props.isLogin!==t.isLogin&&this.props.GetCart(),a!=n){this.props.InitAndClearData(),this.props.Detail(a),this.props.Promotion(a),this.props.Rate(a),this.props.GetCart();var d=e(window).scrollTop();(window.mapScrollHeight=window.mapScrollHeight||{})[n]=d}t.buyModal||t.promotionModal||t.couponsModal||t.searverModal?T(!0):T(!1)}},{key:"componentWillUnmount",value:function(){var t=this.props.data.item_id,a=e(window).scrollTop();(window.mapScrollHeight=window.mapScrollHeight||{})[t]=a}},{key:"render",value:function(){return this.props.updata?this.props.status?this.selectModel():m.default.createElement(y.EmptyPage,{config:{bgImgUrl:"/src/img/item/item-noexist-icon.png",msg:"商品过期不存在",noBtn:!0}}):m.default.createElement(y.LoadingRound,null)}}]),a}();function D(e,t){return u({},e.itemIndex,e.global)}function P(e,t){return{InitAndClearData:function(){e(A("initAndClearData"))},Detail:function(t){v.default.request(u({},N.Detail,{params:{item_id:t}})).then(function(a){var n=a.data;if(0===n.code){var r={title:n.data.title,desc:"我在泰然城发现了一个不错的商品，赶紧来看看吧！",link:location.protocol+"//"+location.host+"/item?item_id="+t,imgUrl:n.data.images[0]};(0,y.ShareConfig)(r),e(A("initData",{data:n.data,status:!0,updata:!0,itemId:t})),e(C("recommendData",u({},N.Recommend,{params:{item_id:t,category_id:n.data.category_id,shop_id:n.data.shop_id}}))),e(C("mixData",u({},N.Mix,{params:{item_id:t}})))}}).catch(function(t){console.log(t),e(A("changeStatus",{updata:!0,status:!1}))})},Promotion:function(t){e(C("promotionData",u({},N.Promotion,{params:{item_id:t}})))},Rate:function(t){e(C("rateData",u({},N.Rate,{params:{item_id:t}})))},GetCart:function(){e(C("cartInfoData",N.GetCart))},UpdateBuyModal:function(t){e(A("updateBuyModal",t))},InitState:function(t){e(A("initState",{ret:t}))},UpdateCartInfo:function(t){e(A("updateCartInfo",t))},UpdataTimer:function(t,a){e(A("UpdataTimer",{T1:t,T2:a}))}}}t.default=(0,f.connect)(D,P)(M)}).call(this,a("OOjC"))},"5dqp":function(e,t,a){},"8x+B":function(e,t,a){"use strict";var n=s(a("Zx67")),r=s(a("kiBT")),i=s(a("OvRC")),o=s(a("pFYg")),l=s(a("C4MV"));function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.NewModal=void 0;var c,u=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,l.default)(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=a("U7vG"),p=h(d),m=(a("XKGu"),h(a("bhYP"))),f=h(a("211U"));function h(e){return e&&e.__esModule?e:{default:e}}t.NewModal=(0,f.default)(m.default,{allowMultiple:!0})(c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,o.default)(t))&&"function"!=typeof t?e:t}(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,o.default)(t)));e.prototype=(0,i.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(r.default?(0,r.default)(e,t):e.__proto__=t)}(t,d.Component),u(t,[{key:"render",value:function(){var e=this.props.isOpen;return p.default.createElement("div",null,e?p.default.createElement("div",{styleName:"shady",onClick:this.props.onClose}):"",p.default.createElement("div",{styleName:"animationModal "+(e?"active":""),style:{borderRadius:"10px 10px 0 0"}},this.props.title&&p.default.createElement("span",{styleName:"title"},this.props.title),p.default.createElement("span",{styleName:"closeBtn",onClick:this.props.onClose},p.default.createElement("i",null)),p.default.createElement("div",null,this.props.children)))}}]),t}())||c},"G/Ei":function(e,t,a){"use strict";var n=s(a("Zx67")),r=s(a("kiBT")),i=s(a("OvRC")),o=s(a("pFYg")),l=s(a("C4MV"));function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.loadMask=void 0;var c,u=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,l.default)(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=a("U7vG"),p=g(d),m=g(a("211U")),f=g(a("XSP4")),h=a("f+hS");function g(e){return e&&e.__esModule?e:{default:e}}var v=(0,m.default)(f.default)(c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,o.default)(t))&&"function"!=typeof t?e:t}(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,o.default)(t)));e.prototype=(0,i.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(r.default?(0,r.default)(e,t):e.__proto__=t)}(t,d.Component),u(t,[{key:"render",value:function(){return p.default.createElement("div",{styleName:"mask"},p.default.createElement("img",{styleName:"mask-load",src:a("rgEM")}))}}]),t}())||c;t.loadMask=new h.Modal(v)},"H+oF":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onAreaResultJSBrige=function(e,t){return function(a){var n=void 0,r=void 0;n=/110100|120100|500100|310100/.test(a.provinceCode)?a.provinceName+a.cityName:a.cityName+a.countyName,r=function(e,t){var a=t.length,n=e,r=void 0;if(!0===n)return!0;for(;a--;){if(r=t[a],!(n&&r in n))return!1;if(!0===n[r])return!0;n=n[r]}return!0}(e,[a.provinceCode,a.cityCode,a.countyCode].filter(function(e){return e})),t&&t(n,r)}}},JmOZ:function(e,t,a){"use strict";(function(e){var n,r,i,o,l,s,c,u=y(a("mvHQ")),d=y(a("fZjL")),p=y(a("Zx67")),m=y(a("gRE1")),f=y(a("kiBT")),h=y(a("OvRC")),g=y(a("pFYg")),v=y(a("woOf")),_=y(a("C4MV"));function y(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.BarrageStripConnnect=t.BarrageStripWrap=t.createChooseSpec=t.createBuyAction=t.Buy=t.BuyModal=t.ExpectTax=t.Specs=t.BuyModalButton=t.BuyModalTitle=t.TotopAndCart=t.Collect=t.GoodsDetail=t.ShopArea=t.RecommendArea=t.LinkChange=t.LinkAndChange=t.EvaluateAreaContents=t.EvaluateArea=t.SeverArea=t.CouponList=t.CouponWrap=t.PromotionWrap=t.ActiveArea=t.Tag=t.GoodsTit=t.VipArea=t.Price=t.PriceArea=t.ScrollImageState=t.ItemNav=t.CouponType=t.params=t.PromotionInfo=t.pageApi=void 0;var E=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,_.default)(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),w=v.default||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};t.setExtraInfo=K,t.rangePrice=$,t.chooseSpec=ee,t.scaleImg=te,t.flyToCart=ae,t.FreePostage=ue,t.promotionState=ge,t.promotionDispatch=ve,t.couponsState=we,t.couponsDispatch=be,t.addState=Ae,t.addDispatch=Ie,t.searverState=De,t.searverDispatch=Pe,t.collectState=Ye,t.collectDispatch=Ke;var b=a("U7vG"),S=q(b),k=(q(a("O27J")),a("4n+p")),x=(q(a("BYKG")),a("Zfgq")),N=a("rsfq"),C=a("f2Hk"),A=a("G/Ei"),I=a("d2xe"),T=a("6quk"),M=a("fw66"),D=a("8x+B"),P=a("ZdiO"),B=a("XKGu"),L=q(a("qAHI")),R=a("5qLU"),F=a("tJWF"),O=a("f2t5");function q(e){return e&&e.__esModule?e:{default:e}}function U(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,g.default)(t))&&"function"!=typeof t?e:t}function G(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,g.default)(t)));e.prototype=(0,h.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(f.default?(0,f.default)(e,t):e.__proto__=t)}a("kjFZ");(0,C.actionAxios)("itemIndex");var j=(0,C.concatPageAndType)("itemIndex"),W=void 0,H=void 0,Q=function(e){return w({},e.global)},Y=t.pageApi={toCart:{url:R.WXAPI+"/cart/add",method:"post"},DelFav:{url:R.WXAPI+"/user/removeItemCollection",method:"get"},Fav:{url:R.WXAPI+"/user/saveItemCollection",method:"post"},GetCoupon:{url:R.WXAPI+"/promotion/obtainCoupon",method:"post"},Coupon:{url:R.WXAPI+"/item/coupon",method:"get"},CheckGroupBuy:{url:R.WXAPI+"/promotion/checkGroupBuy",method:"post"}};function K(e,t,a,n,r,i){return{type:"ds-gwc",goodsId:e,skuId:t,goodsCounts:a,httpcode:n,serviceCode:r,message:i}}var X=t.PromotionInfo={DirectReduction:{getValue:function(e){var t=e.itemdata,a=e.deductPrice,n=t.deduct_price;return S.default.createElement("span",null,"直降",parseFloat(a||n),"元 ")},getTagName:"直降"},SecKill:{getValue:function(e){return S.default.createElement("span",null,"限时秒杀,每个ID限购",e.itemdata.rules.user_buy_limit,"件")},getTagName:"秒杀"},FlashSale:{getValue:function(e){return S.default.createElement("span",null,"限时特卖正在火热抢购中...")},getTagName:"特卖"},FullMinus:{link:function(e){return"/searchResult?promotion_id="+e.id+"&shop="+e.shop_id},getValue:function(e){var t=e.itemdata,a=t.rules.rule.map(function(e,a){return"满"+e.limit_money+"减"+e.deduct_money+(a!==t.rules.rule.length-1?";":"")});return t.rules.no_capped&&a.push(";上不封顶"),S.default.createElement("ul",{className:"full-cut-list c-fl"},S.default.createElement("li",{className:"minus-full-activity"},a.join("")))},name:"fullminus",getTagName:"满减"},FullDiscount:{link:function(e){return"/searchResult?promotion_id="+e.id+"&shop="+e.shop_id},getValue:function(e){var t=e.itemdata.rules;return S.default.createElement("ul",{className:"full-cut-list c-fl"},S.default.createElement("li",{className:"minus-full-activity"},t.map(function(e,a){return e.full+"件"+e.percent/10+"折"+(a!==t.length-1?";":"")}).join(""),";"))},getTagName:"满折"},OptionBuy:{link:function(e){return"/searchResult?promotion_id="+e.id+"&shop="+e.shop_id},getValue:function(e){var t=e.itemdata;return S.default.createElement("span",{className:"option-buy"},t.rules.amount+"元任选"+t.rules.quantity+"件")},getTagName:"N元任选"},ExchangeBuy:{getValue:function(e){var t=e.itemdata;return e.flag?S.default.createElement("a",{href:"/searchResult?promotion_id="+t.id+"&shop="+t.shop_id},S.default.createElement("span",null,"满",t.rules.exchange_full,"元加价可在购物袋换购热销商品"),S.default.createElement("i",{className:"icon icon-forward vertical-middle"},S.default.createElement("img",{src:"/src/img/icon/arrow/arrow-right-icon.png"}))):S.default.createElement("span",null,"满",t.rules.exchange_full,"元加价可在购物袋换购热销商品")},getTagName:"加价换购"},GiftBuy:{getValue:function(e){if(e.flag){var t=[];(0,m.default)(e.itemdata.subItems).forEach(function(e,a){for(var n in e)t.push(e[n])});var a=t.map(function(e,t){return S.default.createElement("li",{key:t},S.default.createElement("span",{className:"title"},"赠品",t+1),S.default.createElement("a",{href:"/item?item_id="+e.item_id},S.default.createElement("span",{className:"image"},S.default.createElement("img",{src:"open"===e.subItemStatus?e.primary_image:"/src/img/item/no-item.png"})),S.default.createElement("i",null,"×",e.giftNum)))});return S.default.createElement("div",{className:"gift-title"},S.default.createElement("p",{className:"gift-p"},"购买可获赠热销商品，赠完为止"),S.default.createElement("div",{className:"gift-wrapper"},S.default.createElement("ul",{className:"gift-buy"},S.default.createElement("div",{className:"wrapper"},a))))}return S.default.createElement("div",{className:"gift-title",style:{display:"inline-block"}},S.default.createElement("p",{style:{display:"inline-block",lineHeight:"28px"}},"购买可获赠热销商品，赠完为止"))},getTagName:"赠品"},default:function(){return null}},z={Good:"好评!",Bad:"差评!",Neutral:"中评!"},V=t.params={newTime:0,oldTime:0,enlarge:!1,touchesX:0,touchesY:0,FirstX:0,FirstY:0,x1:0,x2:0,y1:0,startX:0,startY:0,endX:0,endY:0,wid:0,hei:0,lef:0,to:0,timerScale:null};function J(t){var a=Math.abs(e(window).scrollTop()||e("#item-details")[0]&&-e("#item-details")[0].offsetTop||J.disTop);t&&e("#item-details")[0]?(J.disTop=a,e("#item-details").css({position:"fixed",top:-a,width:"100%"})):(e("#item-details").css({position:"static",top:""}),e(window).scrollTop(J.disTop||0))}function $(e,t){var a=e.info.skus,n=[],r=void 0;for(var i in a)t?n.push(parseFloat(parseFloat(a[i].price).toFixed(2))):n.push(parseFloat(parseFloat(a[i].market_price).toFixed(2)));return n.length>1?(n=n.sort(function(e,t){return e-t}),r="FlashSale"===e.activity_type||"SecKill"===e.activity_type||e.groupBuy?n[0]:n[0]!==n[n.length-1]?n[0]+"-"+n[n.length-1]:n[0]):r=n[0],r}function ee(e,t){var a=e.specKey,n=e.selectArr,r=[],i=void 0;return a&&a.map(function(e,a){i=t[e].values.filter(function(e,t){return e.spec_value_id==n[a]}),r.push(S.default.createElement("span",{key:e},i[0].text," "))}),r}function te(t,a,n){var r=n.newTime,i=n.oldTime,o=n.enlarge,l=n.touchesX,s=n.touchesY,c=n.FirstX,u=n.FirstY,d=n.x1,p=(n.x2,n.y1),m=n.startX,f=n.endX,h=(n.startY,n.endY,n.wid),g=(n.hei,n.lef),v=n.to,_=n.timerScale,y=n.self;n.isLarge;e(t+" img").on("touchstart",function(n){n.preventDefault();var E=n.target;clearTimeout(_);var w=E.height/E.width;d=2*(e(n.target).offset().left-e(t).offset().left)-n.touches[0].clientX,p=2*(e(n.target).offset().top-e(t).offset().top)-n.touches[0].clientY,2==n.touches.length&&(n.touches[1].pageX,m=Math.abs(n.touches[0].clientX-n.touches[1].clientX),Math.abs(n.touches[0].pageY-n.touches[1].pageY),h=E.width,E.height,g=e(n.target).offset().left-e(t).offset().left,v=e(n.target).offset().top-e(t).offset().top),l=n.touches[0].clientX,s=n.touches[0].pageY,c=e(n.target).offset().left-e(t).offset().left,u=e(n.target).offset().top-e(t).offset().top,i=r,r=(new Date).getTime(),_=setTimeout(function(){r-i>300?(y.setState({isLarge:!1}),o=!1,r=0,e(E).css({width:w>1.8?"80%":"100%",height:"auto",top:"50%",left:"50%",transform:"translate(-50%, -50%)",position:"relative"}),a&&a.unlockSwipeToNext(),a&&a.unlockSwipeToPrev()):!1===o?(e(E).css({width:w>1.8?"160%":"200%",height:"auto",top:p,left:d,transform:"translate(0, 0)",position:"relative"}),a&&a.lockSwipeToNext(),a&&a.lockSwipeToPrev(),o=!0):(e(E).css({width:w>1.8?"80%":"100%",height:"auto",top:"50%",left:"50%",transform:"translate(-50%, -50%)",position:"relative"}),a&&a.unlockSwipeToNext(),a&&a.unlockSwipeToPrev(),o=!1)},300);var b=function(t){if(t.preventDefault(),1==t.targetTouches.length){var n=t.targetTouches[0];o&&(e(E).css({left:n.pageX-l+c}),e(E).css({top:n.pageY-s+u})),Math.abs(n.pageX-d)>2&&clearTimeout(_)}else if(2==t.targetTouches.length){clearTimeout(_);var r=t.targetTouches[0],i=t.targetTouches[1];f=Math.abs(r.clientX-i.clientX),Math.abs(r.pageY-i.pageY);e(window).height();var p=h+(f-m),y=e(window).width();(p=(p=p>2*y?2*y:p)<y?y:p)>y?(e(E).css({margin:0}),o=!0,a&&a.lockSwipeToNext(),a&&a.lockSwipeToPrev()):(o=!1,a&&a.unlockSwipeToNext(),a&&a.unlockSwipeToPrev()),e(E).css({width:p+"px",left:g-(f-m)/2,top:v-(f-m)/2*w,transform:"translate(0, 0)",position:"relative"})}};E.addEventListener("touchmove",b,!1),e(E).on("touchend",function(t){t.preventDefault(),E.removeEventListener("touchmove",b,!1),E.width!=e(window).width()&&E.height!=e(window).height()||e(E).css({width:w>1.8?"80%":"100%",height:"auto",top:"50%",left:"50%",transform:"translate(-50%, -50%)",position:"relative"})})})}function ae(){var t=e(".posit-img").find("img").offset(),a=e(".cart-toTop .cart").offset(),n=e(".posit-img").find("img").attr("src");Zepto('<img class="u-flyer" src="'+n+'" />').fly({start:{left:t.left,top:t.top-document.body.scrollTop},end:{left:a.left+40,top:a.top-document.body.scrollTop+40,width:0,height:0},onEnd:function(){this.destory()}})}var ne=t.CouponType={text:function(e){return e.apply_text},title:function(e){return"0"===e.type?"店铺券":"1"===e.type?"跨店券":"2"===e.type?"平台券":"3"===e.type?"红包抵用券":"免单券"}},re=t.ItemNav=function(t){function a(t){U(this,a);var n=Z(this,(a.__proto__||(0,p.default)(a)).call(this,t));return n.scrollEvent=function(){var t=n.state.ratio;window.removeEventListener("scroll",n.addScrollEvent),n.addScrollEvent=function(){var a=e(window).scrollTop(),r=e(".scroll-banner").height()-44;t=(t=a/r)>=1?1:t,n.setState({ratio:t});var i=n.state;e(".item-nav").css({display:t<=0?"none":"block",backgroundColor:"rgba(255,255,255,"+t+")",color:"rgba(53,53,53,"+t+")"}),a<e(".screen-rate")[0].offsetTop-44?0!==i&&n.setState({index:0}):a<e(".screen-detail")[0].offsetTop-44?1!==i&&n.setState({index:1}):2!==i&&n.setState({index:2})},window.addEventListener("scroll",n.addScrollEvent)},n.navClick=function(t){0===t?e(window).scrollTop(0):1===t?e(window).scrollTop(e(".screen-rate")[0].offsetTop-44):e(window).scrollTop(e(".screen-detail")[0].offsetTop-44)},n.state={index:0,ratio:0},n}return G(a,B.PureComponent),E(a,[{key:"componentDidMount",value:function(){this.scrollEvent()}},{key:"componentDidUpdate",value:function(){}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.addScrollEvent)}},{key:"render",value:function(){var e=this,t=this.state,a=t.index,n=t.ratio;return S.default.createElement("div",{className:"item-nav c-fs14 c-c666",style:{display:"none"}},S.default.createElement("ul",null,S.default.createElement("li",{onClick:function(){e.navClick(0)}},S.default.createElement("span",{style:0===a?{borderBottom:"2px solid rgba(53,53,53,"+n+")"}:{}},"商品")),S.default.createElement("li",{onClick:function(){e.navClick(1)}},S.default.createElement("span",{className:1===a?"active":""},"评价")),S.default.createElement("li",{onClick:function(){e.navClick(2)},className:"c-fr"},S.default.createElement("span",{className:2===a?"active":""},"详情"))))}}]),a}(),ie=t.ScrollImageState=function(e){function t(e){U(this,t);var a=Z(this,(t.__proto__||(0,p.default)(t)).call(this,e));return a.largeBanner=function(){a.setState({isLarge:!a.state.isLarge})},a.state={isLarge:!1},a}return G(t,B.PureComponent),E(t,[{key:"componentDidMount",value:function(){var e=w({},V,{isLarge:this.state.isLarge,self:this});this.initSwiper(),this.initLargeSwiper(),te(".swiper-container-large",H,e)}},{key:"initSwiper",value:function(){W&&W.destroy(),W=new Swiper(this.refs.swiperBanner,{pagination:".swiper-pagination-banner",observer:!0,loop:!1,paginationType:"fraction",onSlideChangeStart:function(e){H.slideTo(e.activeIndex)}})}},{key:"initLargeSwiper",value:function(){H&&H.destroy(),H=new Swiper(this.refs.swiperLarge,{pagination:".swiper-pagination-large",observer:!0,loop:!1,paginationType:"fraction",onSlideChangeStart:function(e){W.slideTo(e.activeIndex)}})}},{key:"render",value:function(){var e=this,t=this.props.data,a=t.images,n=t.item_type,r=t.activity_type,i=this.props.group_data,o=this.props.data.item_tag&&this.props.data.item_tag.images.mb_square_img,l=this.props.data.item_tag&&this.props.data.item_tag.images.mb_rectangular_img,s=this.state.isLarge,c=a&&a.length>0?a.map(function(t,a){return S.default.createElement("div",{className:"swiper-slide",key:a},S.default.createElement("img",{src:(0,O.addImageSuffix)(t,"_l")||"/src/img/item/no-img.png",onClick:e.largeBanner}))}):S.default.createElement("div",{className:"swiper-slide"},S.default.createElement("img",{src:"/src/img/item/no-img.png"})),u=a.map(function(t,a){return S.default.createElement("div",{className:"swiper-slide swiper-slide-large",key:a,onClick:function(t){e.setState({isLarge:!1})}},S.default.createElement("img",{src:(0,O.addImageSuffix)(t,"_l")||"/src/img/item/no-img.png",id:"img"+a}))});return S.default.createElement("div",{className:"c-pr scroll-banner","data-plugin":"swiper"},s&&S.default.createElement("div",{className:"shady-banner"}),i&&"Rookie"===i.group_type?S.default.createElement("img",{className:"c-pa tag2",src:"/src/img/activity/new-group.png"}):o?S.default.createElement("img",{className:"c-pa tag1",src:o}):"",S.default.createElement("div",{className:"swiper-container",ref:"swiperBanner"},S.default.createElement("div",{className:"swiper-wrapper"},c),a.length>0&&S.default.createElement("div",{className:"swiper-pagination swiper-pagination-banner"})),S.default.createElement("div",{className:"swiper-container swiper-container-large",ref:"swiperLarge",style:s?{display:"block"}:{display:"none"}},S.default.createElement("div",{className:"swiper-wrapper"},u),S.default.createElement("div",{className:"swiper-pagination swiper-pagination-banner swiper-pagination-large"})),!l||"NORMAL"!==n&&"VIRTUAL"!==n&&"INTERNAL"!==n||"FlashSale"===r?"":S.default.createElement("img",{className:"H5D_pic",src:l}))}}]),t}(),oe=t.PriceArea=(n=function(e){function t(e){U(this,t);var a=Z(this,(t.__proto__||(0,p.default)(t)).call(this,e));return r.call(a),a.state={flashsaleFlag:!1},a}return G(t,B.PureComponent),E(t,[{key:"componentDidMount",value:function(){this.props.proStatus&&"FlashSale"===this.props.data.activity_type&&this.judgeFlashsale(this.props.promotion)}},{key:"componentWillReceiveProps",value:function(e){e.proStatus&&e.proStatus!==this.props.proStatus&&"FlashSale"===e.data.activity_type&&this.judgeFlashsale(e.promotion)}},{key:"render",value:function(){var e=this.state.flashsaleFlag,t=this.props,a=t.proStatus,n=t.promotion,r=t.data;return S.default.createElement("div",null,e&&a&&S.default.createElement(le,this.props),S.default.createElement("div",{className:"price-area"},e?null:S.default.createElement(se,{item:r,proStatus:a,promotion:n}),S.default.createElement(de,{item:r,promotion:n}),S.default.createElement(pe,{item:r})))}}]),t}(),r=function(){var e=this;this.judgeFlashsale=function(t){var a=e.props.intervalT,n=t.promotion[0],r=n.start_time,i=n.now_time,o=n.end_time,l=n.type;i=new Date(i.replace(/-/g,"/")).getTime()+parseInt(a),r=new Date(r.replace(/-/g,"/")).getTime(),o=new Date(o.replace(/-/g,"/")).getTime(),"FlashSale"===l&&i>r&&i<o&&e.setState({flashsaleFlag:!0})}},n),le=function(e){function t(e){U(this,t);var a=Z(this,(t.__proto__||(0,p.default)(t)).call(this,e));return a.getMarketPrice=function(e,t){var a=e.info.skus,n=void 0;for(var r in a)if(a[r].price===t){n=a[r].market_price;break}return n},a.state={time:0},a}return G(t,b.Component),E(t,[{key:"componentDidMount",value:function(){var e=this.props.intervalT,t=this.props.promotion.promotion[0],a=t.end_time,n=t.now_time;a=new Date(a.replace(/-/g,"/")).getTime(),(n=new Date(n.replace(/-/g,"/")).getTime()+parseInt(e))<a&&this.setState({time:parseInt((a-n)/1e3)}),this.intervalTime()}},{key:"intervalTime",value:function(){var e=this;this.timer=setTimeout(function(){var t=--e.state.time;t<0?location.reload():(e.state.time=t,e.setState(e.state),e.intervalTime())},1e3)}},{key:"componentWillUnmount",value:function(){window.clearTimeout(this.timer),this.timer=null}},{key:"render",value:function(){var e=$(this.props.promotion,!0),t=this.getMarketPrice(this.props.promotion,e);return S.default.createElement("div",{className:"flashsale-price c-cfff"},S.default.createElement("span",{className:"c-fs25 c-dpib c-fl"}," ¥",e),t&&t!==e?S.default.createElement("span",{className:"c-dpib c-fl market-price c-ml5"}," ¥",t):null,S.default.createElement("span",{className:"flashsale-tag"},"限时特卖"),S.default.createElement("div",{className:"c-fr c-tr"},S.default.createElement("div",{className:"time-notice"},"距结束仅剩"),S.default.createElement("div",{className:"time-notice"},O.timeCtrl.formatTextTime(this.state.time))))}}]),t}(),se=t.Price=function(e){function t(e){U(this,t);var a=Z(this,(t.__proto__||(0,p.default)(t)).call(this,e));return a.getMarketPrice=function(e,t){var a=e.info.skus,n=void 0;for(var r in a)if(a[r].price===t){n=a[r].market_price;break}return n},a.state={sellPrice:parseFloat(parseFloat(a.props.item.sell_price).toFixed(2)),marketPrice:parseFloat(parseFloat(a.props.item.market_price).toFixed(2))},a}return G(t,b.Component),E(t,[{key:"componentWillReceiveProps",value:function(e){e.proStatus&&e.proStatus!==this.props.proStatus&&this.setState({sellPrice:$(e.promotion,!0),marketPrice:"seckill"===e.item.item_type?this.getMarketPrice(e.promotion,$(e.promotion,!0)):$(e.promotion,!1)})}},{key:"componentDidMount",value:function(){this.props.proStatus&&(this.setState({sellPrice:$(this.props.promotion,!0)}),this.setState({marketPrice:"seckill"===this.props.item.item_type?this.getMarketPrice(this.props.promotion,$(this.props.promotion,!0)):$(this.props.promotion,!1)}))}},{key:"render",value:function(){var e=this.props.item,t=e.is_free,a=e.trade_type,n=e.tax_rate,r=e.item_type,i=e.shop,o=e.activity_type,l=this.state,s=l.sellPrice,c=l.marketPrice;return S.default.createElement("div",{className:"price-info c-clrfix"},S.default.createElement("span",{className:"c-dpib c-fl standard-price"}," ¥",s),c?S.default.createElement("span",{className:"c-dpib c-fl market-price"}," ¥",c):null,"NORMAL"===r&&3!==i.attr&&"FlashSale"!==o&&S.default.createElement(ue,{data:{is_free:t,trade_type:a,tax_rate:n},className:"c-fl"}))}}]),t}(),ce=t.VipArea=function(e){function t(){return U(this,t),Z(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return G(t,b.Component),E(t,[{key:"render",value:function(){var e=this.props.vipInfo,t=void 0===e?{}:e,a=t.is_support_vip,n=t.vip_discount,r=a&&n/10;return S.default.createElement("div",null,a?S.default.createElement("div",{className:"price-vip"},S.default.createElement("img",{src:"/src/img/icon/icon-vip.png"}),S.default.createElement("span",{className:"vip-title"},"泰享会员"+r+"折特惠")):null)}}]),t}();function ue(e){var t=e.data,a=e.className;return t.is_free||"DOMESTIC"!==t.trade_type&&!Number(t.tax_rate)?S.default.createElement("span",{className:a+" free-postage-tag"},t.is_free?"包邮":"","DOMESTIC"!==t.trade_type&&0===Number(t.tax_rate)?"包税":""):null}var de=t.GoodsTit=function(e){function t(){return U(this,t),Z(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return G(t,b.Component),E(t,[{key:"render",value:function(){var e=this.props.item,t=e.title,a=e.sub_title,n=e.vip_info;return S.default.createElement("div",null,S.default.createElement(ce,{vipInfo:n}),S.default.createElement("p",{className:"goods-tit"},t),a&&S.default.createElement("p",{className:"c-c666 sub-title"},a))}}]),t}(),pe=t.Tag=function(e){function t(){return U(this,t),Z(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return G(t,b.Component),E(t,[{key:"getList",value:function(){var e=this.props.item,t=e.country,a=e.trade_type,n=e.shop.biz_model,r=(0,N.FilterTradeType)(a),i=[];return t.imageUrl&&i.push(S.default.createElement("li",{key:"brandcountry"},S.default.createElement("img",{src:t.imageUrl}),t.text,"品牌")),r&&i.push(S.default.createElement("li",{key:"tradetype"},S.default.createElement("img",{src:"/src/img/icon/trade-type-icon.png"})," ",r)),1===n?i.push(S.default.createElement("li",{key:"trc"},S.default.createElement("img",{src:"/src/img/icon/trc-logo-icon.png"})," 泰然城自营")):i.push(S.default.createElement("li",{key:"trc"},S.default.createElement("img",{src:"/src/img/icon/trc-logo-icon.png"})," 泰然城精选商家")),i}},{key:"render",value:function(){var e=this.getList();return e.length?S.default.createElement("ul",{className:"all-tag"},e):null}}]),t}(),me=t.ActiveArea=function(e){function t(){return U(this,t),Z(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return G(t,B.PureComponent),E(t,[{key:"render",value:function(){return S.default.createElement("div",{className:"active-area"},S.default.createElement(ye,this.props),S.default.createElement(fe,this.props))}}]),t}(),fe=t.PromotionWrap=function(e){function t(){return U(this,t),Z(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return G(t,b.Component),E(t,[{key:"getPromotion",value:function(){var e=this.props.promotion,t=e.promotion,a=e.activity_type;return t.length?S.default.createElement(he,{promotion:t,activity_type:a,retState:this.props.retState}):null}},{key:"render",value:function(){return this.getPromotion()}}]),t}(),he=(0,k.connect)(ge,ve)(i=function(e){function t(){return U(this,t),Z(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return G(t,b.Component),E(t,[{key:"getList",value:function(e){for(var t=this.props.promotion,a=0,n=[],r=void 0;r=t[a];)n.push(S.default.createElement(_e,w({},this.props,{itemdata:r,key:a,hasLink:e,flag:e}))),a++;return n}},{key:"render",value:function(){var e=this;return S.default.createElement("div",null,S.default.createElement("div",{className:"goods-promotion",onClick:function(){e.props.ChangePromotionModal(!0)}},S.default.createElement(D.NewModal,{isOpen:this.props.promotionModal,title:"促销活动",onClose:function(t){t.stopPropagation(),e.props.ChangePromotionModal(!1)}},S.default.createElement("div",{className:"goods-promotion-modal"},S.default.createElement("section",{className:"promotion-list-modal"},S.default.createElement("div",{className:"list-details-modal"},S.default.createElement("ul",{className:"promotion-ul-modal"},this.getList(!0)))))),S.default.createElement("div",{className:"promotion_ti c-fl"},"促销"),S.default.createElement("section",{className:"promotion-list c-fl"},S.default.createElement("div",{className:"list-details"},S.default.createElement("ul",{className:"promotion-ul"},this.getList()))),S.default.createElement("i",{className:"icon icon-forward vertical-middle"},S.default.createElement("img",{src:"/src/img/icon/arrow/arrow-right-icon.png"})),S.default.createElement("p",{className:"clearfix"})))}}]),t}())||i;function ge(e){return{promotionModal:e.itemIndex.promotionModal}}function ve(e){return{BackFlag:function(){e(j("promotionBackFlag"))},ChangePromotionModal:function(t){e(j("changePromotionModal",{flag:t}))}}}var _e=function(e){function t(){return U(this,t),Z(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return G(t,b.Component),E(t,[{key:"linkTo",value:function(){var e=this.getLink();e&&x.browserHistory.push(e),this.props.BackFlag()}},{key:"getLink",value:function(){var e=this.props.itemdata,t=X[e.type];if(t)return"function"==typeof t.link?t.link(e):t.link}},{key:"render",value:function(){var e=this,t=this.props,a=t.itemdata,n=t.flag,r=t.hasLink,i=t.retState,o=X[a.type];return S.default.createElement("li",{className:"promotion-li",onClick:function(){return r&&e.linkTo()}},S.default.createElement("div",{className:"clearfix"},S.default.createElement("button",{type:"button",className:"c-fl"},o.getTagName),o?S.default.createElement(o.getValue,{itemdata:a,flag:n,deductPrice:i&&i.deductPrice}):S.default.createElement(X.default,this.props),r&&this.getLink()?S.default.createElement("i",{className:"icon icon-forward vertical-middle"},S.default.createElement("img",{src:"/src/img/icon/arrow/arrow-right-icon.png"})):null))}}]),t}(),ye=t.CouponWrap=function(e){function t(){return U(this,t),Z(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return G(t,b.Component),E(t,[{key:"getCoupon",value:function(){var e=this.props,t=e.promotion,a=e.shop;return t.coupon?S.default.createElement(Ee,{promotion:t,shop:a}):null}},{key:"render",value:function(){return this.getCoupon()}}]),t}(),Ee=(0,k.connect)(we,be)(o=function(e){function t(e){U(this,t);var a=Z(this,(t.__proto__||(0,p.default)(t)).call(this,e));return a.getModalCouponList=function(){var e=[];A.loadMask.show(),L.default.request(w({},Y.Coupon,{params:{item_id:a.props.item_id}})).then(function(t){var n=t.data;A.loadMask.destroy(),n.data&&n.data.map(function(t,n){e.push(S.default.createElement(ke,w({},a.props,{itemdata:t,key:n})))}),a.setState({couponList:e})}).catch(function(e){A.loadMask.destroy(),console.log(e),T.tip.show({msg:e.response.data.message||"服务器繁忙"})})},a.state={couponList:[]},a}return G(t,b.Component),E(t,[{key:"getCouponList",value:function(){var e=[];return this.props.promotion.coupon.some(function(t,a){if(!(a<=2))return!1;e.push(S.default.createElement("span",{key:a},"满",t.limit_money,"减",t.deduct_money))}),e}},{key:"render",value:function(){var e=this;return S.default.createElement("div",{className:"addr-ser"},S.default.createElement(D.NewModal,{title:"领取优惠劵",isOpen:this.props.couponsModal,onClose:function(t){t.stopPropagation(),e.props.ChangeCouponsModal(!1)}},S.default.createElement("div",{className:"goods-coupon-modal"},S.default.createElement("div",{className:"coupon-wrap"},S.default.createElement("div",{className:"coupone-list"},this.state.couponList)))),S.default.createElement("div",{className:"sever-addr",onClick:function(){e.getModalCouponList(),e.props.ChangeCouponsModal(!0)}},S.default.createElement("span",{className:"coupon-list"},"领券： ",this.getCouponList(),S.default.createElement("i",{className:"icon icon-forward vertical-middle"},S.default.createElement("img",{src:"/src/img/icon/arrow/arrow-right-icon.png"})))))}}]),t}())||o;function we(e){return{couponsModal:e.itemIndex.couponsModal,item_id:e.itemIndex.data.item_id}}function be(e){return{BackFlag:function(){e(j("couponsBackFlag"))},ChangeCouponsModal:function(t){e(j("changeCouponsModal",{flag:t}))}}}var Se=function(t){function a(e){U(this,a);var t=Z(this,(a.__proto__||(0,p.default)(a)).call(this,e));return t.getCoupon=function(){var e=t,a=e.props,n=a.itemdata,r=a.shop;e.setState({buttonClick:!1}),L.default.request(w({},Y.GetCoupon,{params:{coupon_id:n.id,shop_id:r.id,source:"goods"}})).then(function(t){t&&200===t.status&&(e.setState({buttonClick:!0}),T.tip.show({msg:"领取成功"}))}).catch(function(t){e.setState({buttonClick:!0}),console.log(t),T.tip.show({msg:t.response.data.message||"服务器繁忙"})})},t.state={buttonClick:!0},t}return G(a,b.Component),E(a,[{key:"render",value:function(){var t=this,a=this.props,n=a.itemdata,r=a.shop,i=a.BackFlag,o=a.isLogin;n.shop=r;var l;n.coupon_type;return S.default.createElement("div",{className:"coupon "+(l=n,l.isset_limit_money?"coupon-red":"coupon-yellow")},S.default.createElement("div",{className:"coupon-li-wrap"},S.default.createElement("div",{className:"c-fl coupon-left"},S.default.createElement("h3",{className:String(n.deduct_money).length<4?"h3-a":"h3-b"},S.default.createElement("span",null,"¥"),n.deduct_money),S.default.createElement("p",null,"满",n.limit_money,"使用")),S.default.createElement("div",{className:"c-fr coupon-right"},S.default.createElement("h3",null,ne.title(n)),S.default.createElement(qe,{BackFlag:i,flag:!0},S.default.createElement("button",{className:"buy-button",onClick:function(a){var n=e(a.target).parent()[0].href;t.state.buttonClick&&!n&&o&&t.getCoupon()}},"立即领取")),S.default.createElement("p",{className:"coupon-right-type"},"• ",ne.text(n)),S.default.createElement("p",{className:"coupon-right-use-date"},O.dateUtil.format(new Date(n.use_start_time.replace(/-/g,"/")).getTime(),"Y/M/D H:F").slice(2),"至 ",O.dateUtil.format(new Date(n.use_end_time.replace(/-/g,"/")).getTime(),"Y/M/D H:F").slice(2)))))}}]),a}(),ke=t.CouponList=(0,k.connect)(Q)(Se),xe=t.SeverArea=function(e){function t(){return U(this,t),Z(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return G(t,B.PureComponent),E(t,[{key:"render",value:function(){return S.default.createElement("div",{className:"c-pb10"},S.default.createElement(Ce,null),S.default.createElement(Ne,this.props),S.default.createElement(Me,this.props))}}]),t}(),Ne=function(e){function t(){var e,a,n;U(this,t);for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];return a=n=Z(this,(e=t.__proto__||(0,p.default)(t)).call.apply(e,[this].concat(i))),n.showChargeMsg=function(e,t,a){switch(e){case 0:return S.default.createElement("li",null,"该商品已包邮 ",S.default.createElement("span",{className:"tag"},"包邮"));case 1:return S.default.createElement("li",null,"满 "+a+" 件包邮");case 2:return S.default.createElement("li",null,"满 "+t+" 元包邮");case 3:return S.default.createElement("li",null,"满 "+a+" 件，且满 "+t+"元包邮");case 4:return S.default.createElement("li",null,a+" kg内包邮");case 5:return S.default.createElement("li",null,"满 "+t+" 元包邮");case 6:return S.default.createElement("li",null,a+" kg内，且满 "+t+"元包邮")}},n.chooseChargeRule1=function(e){var t=n.props.retState;t.nowPrice,t.num;if(e.limit_quantity)switch(e.free_type){case 1:return n.showChargeMsg(1,null,e.limit_quantity);case 2:return n.showChargeMsg(2,e.limit_money,null);case 3:return n.showChargeMsg(3,e.limit_money,e.limit_quantity)}else switch(e.free_type){case 1:return n.showChargeMsg(4,null,e.limit_weight);case 2:return n.showChargeMsg(5,e.limit_money,null);case 3:return n.showChargeMsg(6,e.limit_money,e.limit_weight)}},n.chooseChargeRule2=function(e,t){var a=e.start_standard,r=e.start_freight,i=e.add_standard,o=e.add_freight,l=void 0,s=n.props.retState,c=s.num,u=s.weight;return i&&o&&(1===t?+e.start_standard<c*u:+e.start_standard<c)?(l=1===t?+r+Math.ceil((c*u-a)/i)*o:+r+(i&&o&&Math.ceil((c-a)/i)*o),l=parseFloat(l.toFixed(2))):l=+r,S.default.createElement("li",null,"预计运费",l,"元")},n.chooseChargeRule3=function(e){var t=e.rules;if(!(t instanceof Array)){var a=[];for(var r in t)a.push(t[r]);t=a}var i=n.props.retState,o=i.nowPrice,l=i.num,s=i.groupPrice;o=s||o;var c=String(o).split("-").length;o=1===c?o*l:n.props.data.sell_price*l;var u=void 0;return t.filter(function(e,t){(e.upper?o>=+e.boundary&&o<+e.upper:o>=+e.boundary)&&(u=e.freight)}),S.default.createElement("li",null,"预计运费",u,"元")},n.chooseAssignArea=function(e,t){return e.filter(function(a,n){var r=a.area&&a.area.split(",");return r&&r.some(function(a){if(a===t[0]||a===t[1])return e[n]})})},n.calculateCharge=function(){var e=n.props.mix.dlytmplInfo,t=n.props.areaData.areaCode,a=[],r=e.freight_conf,i=e.free_conf,o=e.valuation_type,l=e.is_free,s=n.props.retState,c=s.num,u=s.weight;if(+l)return S.default.createElement("li",null,"该商品已包邮 ",S.default.createElement("span",{className:"tag"},"包邮"));if(1===o||2===o){if(i){if((a=n.chooseAssignArea(i,t)).length>0&&(3===a[0].free_type&&(a[0].limit_weight||a[0].limit_quantity)&&a[0].limit_money||2===a[0].free_type&&a[0].limit_money||1===a[0].free_type&&(a[0].limit_quantity||a[0].limit_weight)))return n.chooseChargeRule1(a[0]);if(i[0]&&(3===i[0].free_type&&(i[0].limit_weight||i[0].limit_quantity)&&i[0].limit_money||2===i[0].free_type&&i[0].limit_money||1===i[0].free_type&&(i[0].limit_quantity||i[0].limit_weight)))return n.chooseChargeRule1(i[0])}var d=(a=n.chooseAssignArea(r,t)).length>0&&a[0],p=d.start_standard,m=d.start_freight,f=d.add_standard,h=d.add_freight;return a.length&&(""!=p&&""!=m&&""!=f&&""!=h||""!=f&&""!=h&&(1===o?u<=p:c<=p))?n.chooseChargeRule2(a[0],o):n.chooseChargeRule2(r[0],o)}return(a=n.chooseAssignArea(r,t)).length?n.chooseChargeRule3(a[0]):n.chooseChargeRule3(r[0])},Z(n,a)}return G(t,b.Component),E(t,[{key:"render",value:function(){var e=this.calculateCharge();return S.default.createElement("ul",{className:"charge c-fs13"},S.default.createElement("li",{className:"c-mr15"},"运费"),e)}}]),t}(),Ce=(0,k.connect)(Ae,Ie)(l=function(t){function a(e){U(this,a);var t=Z(this,(a.__proto__||(0,p.default)(a)).call(this,e));return t.isInArea=function(e,a){var n=t.props.mix.delivery_regions;return!(n instanceof Array)||n.some(function(t){if(t==e||t==a)return!0})},t.changeState=function(e){t.setState(e)},t.confirmAnimal=function(e,a,n,r,i,o){t.isInArea(r,i)?(n?t.props.ChangeAreaData({areaData:{area:e+"/"+a+"/"+n,areaCode:[r,i],addressData:{area:{province:{code:r,text:e},city:{code:i,text:a},district:{code:o,text:n}},detail_address:e+a+n}}}):t.props.ChangeAreaData({areaData:{area:e+"/"+a,areaCode:[r,i],addressData:{area:{province:{code:r,text:e},city:{code:i,text:a}},detail_address:e+a}}}),t.setState({animalStatus:!1,slideIn:!1,shadySlide:!1,addSlideIn:!1})):T.tip.show({msg:"不在配送区域"})},t.cancel=function(){var e=t.state,a=e.animalStatus,n=e.slideIn,r=t.props.mix.addrList,i=t.props.isLogin;!i||i&&0===r.recent_addr.length&&!r.default_addr.area?t.changeState({slideIn:!1,shadySlide:!1,addSlideIn:!1,flag:!0}):a&&n?t.changeState({slideIn:!1,flag:!0}):t.changeState({shadySlide:!1,addSlideIn:!1,flag:!0})},t.state={flag:!0,shadySlide:!1,addSlideIn:!1,addStart:!1,animalStatus:!1,slideIn:!1},t}return G(a,b.Component),E(a,[{key:"render",value:function(){var t=this,a=this.props,n=a.mix,r=a.areaData,i=a.ChangeAreaData,o=a.isLogin,l=(n.dlytmplInfo,n.addrList),s=n.storehouse&&n.storehouse.name,c=this.state,u=c.shadySlide,d=c.addSlideIn,p=c.addStart,m=c.animalStatus,f=c.slideIn,h=c.flag,g=S.default.createElement("div",{className:"addr-solected"},S.default.createElement("span",{className:"c-mr15"},"配送"),S.default.createElement("span",{className:"addr-fh"}),s,"至",S.default.createElement("i",{className:"icon place-icon"}),S.default.createElement("span",null,r.area),S.default.createElement("i",{className:"icon icon-forward vertical-middle"},S.default.createElement("img",{src:"/src/img/icon/arrow/arrow-right-icon.png"})));return S.default.createElement("div",{className:"addr-ser"},S.default.createElement("div",{className:"shady "+(u?"":"c-dpno"),style:{height:e(window).height()},onClick:this.cancel}),S.default.createElement(Te,{addrList:l,addStart:p,shadySlide:u,flag:h,addSlideIn:d,areaData:r,animalStatus:m,slideIn:f,cancel:this.cancel,changeState:this.changeState,confirm:this.confirmAnimal,ChangeAreaData:i,isInArea:this.isInArea}),S.default.createElement("div",{className:"sever-addr"},S.default.createElement("div",{className:"addr-a",onClick:function(){t.changeState({addStart:!0,shadySlide:!0,addSlideIn:!0,flag:!1}),(!o||o&&l.recent_addr.length<0||o&&!l.default_addr)&&t.setState({animalStatus:!0,slideIn:!0})}},g)))}}]),a}())||l;function Ae(e){return w({mix:e.itemIndex.mix,areaData:e.itemIndex.areaData},e.global)}function Ie(e){return{ChangeAreaData:function(t){e(j("changeAreaData",t))}}}var Te=function(t){function a(){return U(this,a),Z(this,(a.__proto__||(0,p.default)(a)).apply(this,arguments))}return G(a,b.Component),E(a,[{key:"render",value:function(){var t=this;this.props.addSlideIn?J(!0):J(!1);var a=this.props,n=a.addSlideIn,r=a.addStart,i=a.animalStatus,o=a.slideIn,l=a.addrList,s=a.areaData,c=l?l.recent_addr.length>0?l.recent_addr:l.default_addr:[],u=c.length>0&&c.map(function(a,n){var r=e(".addr-d"+n).height();return S.default.createElement("li",{key:n,className:"choose-add add-detail",style:r>19?{paddingTop:"8px"}:{paddingTop:"15px"},onClick:function(){var e=a.area,n=e.province,r=e.city,i=e.district,o=[];t.props.isInArea(a.area.province.code,a.area.city.code)?(o.push(n.code),o.push(r.code),i.code&&o.push(i.code),a.address_id=a.id,t.props.ChangeAreaData({areaData:{area:a.detail_address,areaCode:o,addressData:a}}),t.props.changeState({shadySlide:!1,addSlideIn:!1})):T.tip.show({msg:"不在配送区域"})}},S.default.createElement("img",{className:"img-l",src:s.area===a.detail_address?"/src/img/icon/orientation-icon-red.png":"/src/img/icon/orientation-icon.png"}),S.default.createElement("div",{className:"addr-d"+n+" "+(s.area===a.detail_address?"c-cdred":"")},a.detail_address))});return S.default.createElement("div",{className:"add-pop"},S.default.createElement(P.ChooseAddress,{animalStatus:i,slideIn:o,confirm:this.props.confirm}),S.default.createElement("div",{className:"animation-add "+(r?n?"animation1":"animation2":"")},S.default.createElement("div",{className:"title"},S.default.createElement("li",{className:"c-fr",onClick:this.props.cancel},S.default.createElement("img",{src:"/src/img/icon/close/icon-modal-close.png"})),S.default.createElement("li",{className:"c-c35 c-fs15"},"配送至")),S.default.createElement("ul",{className:"c-fs13 "},u,S.default.createElement("li",{className:"c-cdred choose-add",onClick:function(){t.props.changeState({animalStatus:!0,slideIn:!0})}},S.default.createElement("img",{className:"img-l",src:"/src/img/icon/choose-add.png"}),"选择其他区域"))))}}]),a}(),Me=(0,k.connect)(De,Pe)(s=function(e){function t(){var e,a,n;U(this,t);for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];return a=n=Z(this,(e=t.__proto__||(0,p.default)(t)).call.apply(e,[this].concat(i))),n.onClose=function(){n.props.ChangeSearverModal(!1)},Z(n,a)}return G(t,b.Component),E(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.mix,n=t.data,r=t.searverModal,i=a.storehouse&&a.storehouse.name,o=(0,N.TradeFade)(n),l=a.delivery_regions,s=a.tags;return S.default.createElement("div",null,S.default.createElement(Be,{mix:a,isTradeFade:o,data:n,searverModal:r,onClose:function(){return e.onClose()}}),S.default.createElement("div",{className:"goods-tax",onClick:function(){e.props.ChangeSearverModal(!0)}},S.default.createElement("ul",null,S.default.createElement("li",{className:n.support_ecard?"":"no-support"},S.default.createElement("i",{className:n.support_ecard?"detail-serve-icon":"point-notice-icon"}),n.support_ecard?"支持活动e卡":"不支持活动e卡"),o&&"DOMESTIC"!==n.trade_type?S.default.createElement("li",null,S.default.createElement("i",{className:"detail-serve-icon"}),"商品税费"):null,S.default.createElement("li",{className:s.free_refund?"":"no-support"},S.default.createElement("i",{className:s.free_refund?"detail-serve-icon":"point-notice-icon"}),s.free_refund?"支持":"不支持","七天无理由退换货"),n.is_free?S.default.createElement("li",null,S.default.createElement("i",{className:"detail-serve-icon"}),"包邮"):null,S.default.createElement("li",null,S.default.createElement("i",{className:"detail-serve-icon"}),"正品保证"),i?S.default.createElement("li",null,S.default.createElement("i",{className:"detail-serve-icon"}),i):"",S.default.createElement("li",null,S.default.createElement("i",{className:"detail-serve-icon"}),"担保交易"),"number"!=typeof l?S.default.createElement("li",null,S.default.createElement("i",{className:"detail-serve-icon"}),"部分区域配送"):""),S.default.createElement("p",{className:"clearfix"})))}}]),t}())||s;function De(e){return{searverModal:e.itemIndex.searverModal}}function Pe(e){return{ChangeSearverModal:function(t){e(j("changeSearverModal",{flag:t}))}}}var Be=function(e){function t(){return U(this,t),Z(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return G(t,b.Component),E(t,[{key:"render",value:function(){var e=this.props,t=e.mix,a=e.isTradeFade,n=e.data,r=t.storehouse&&t.storehouse.name,i=t.delivery_regions,o=t.tags,l=(1e4*+n.tax_rate/1e4*100).toFixed(2);return S.default.createElement(D.NewModal,{isOpen:this.props.searverModal,title:"服务说明",onClose:this.props.onClose},S.default.createElement("section",{className:"modal-wrap-container",style:{height:"335px"}},S.default.createElement("ul",null,S.default.createElement("li",null,S.default.createElement("div",{className:"hd"},S.default.createElement("i",{className:n.support_ecard?"mark-icon":"no-mark-icon"})," ",n.support_ecard?"支持活动e卡":"不支持活动e卡"),S.default.createElement("div",{className:"tax-cont"},n.support_ecard?"店铺为支持活动e卡，商品贸易类型为一般贸易的商品。":"不支持活动e卡。")),a&&"DOMESTIC"!==n.trade_type?S.default.createElement("li",null,S.default.createElement("div",{className:"hd"},S.default.createElement("i",{className:"mark-icon"})," 商品税费"),S.default.createElement("div",{className:"tax-cont"},"按照国家规定，本商品适用于跨境综合税，税率为",l,"%， 实际结算税费请以提交订单时的应付总额明细为准。")):null,S.default.createElement("li",null,S.default.createElement("div",{className:"hd"},S.default.createElement("i",{className:o.free_refund?"mark-icon":"no-mark-icon"})," ",o.free_refund?null:"不支持","七天无理由退换货"),S.default.createElement("div",{className:"tax-cont"},o.free_refund?"此商品支持7天无理由退换货，在商品签收之日起7天内可发起退换货申请，退回商品应不影响第二次销售":"此商品不支持七天无理由退换货")),n.is_free?S.default.createElement("li",null,S.default.createElement("div",{className:"hd"},S.default.createElement("i",{className:"mark-icon"})," 包邮"),S.default.createElement("div",{className:"tax-cont"},"此商品全国地区包邮。")):null,S.default.createElement("li",null,S.default.createElement("div",{className:"hd"},S.default.createElement("i",{className:"mark-icon"})," 正品保证"),S.default.createElement("div",{className:"tax-cont"},"泰然城每件商品都经过严苛的质量把关，保障正品、保障品质，杜绝一切假货，让您购物无忧。")),r?S.default.createElement("li",null,S.default.createElement("div",{className:"hd"},S.default.createElement("i",{className:"mark-icon"})," ",r),S.default.createElement("div",{className:"tax-cont"},"本商品由",r,"发货。")):null,S.default.createElement("li",null,S.default.createElement("div",{className:"hd"},S.default.createElement("i",{className:"mark-icon"})," 担保交易"),S.default.createElement("div",{className:"tax-cont"},"担保交易，放心购买。")),"number"!=typeof i?S.default.createElement("li",null,S.default.createElement("div",{className:"hd"},S.default.createElement("i",{className:"mark-icon"})," 部分区域配送"),S.default.createElement("div",{className:"tax-cont"},"本商品只支持部分配送区域。")):null)))}}]),t}(),Le=t.EvaluateArea=function(e){function t(){return U(this,t),Z(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return G(t,B.PureComponent),E(t,[{key:"render",value:function(){var e=this.props,t=e.rate,a=e.itemId,n=t.rates,r=t.total,i=t.good_rate_ratio;return S.default.createElement("div",{className:"evaluate-area detail"},S.default.createElement("div",{className:"hd"},S.default.createElement(x.Link,{to:"/evaluate?item_id="+a,"data-notLogin":!0},"商品评价 (",r,")",S.default.createElement("i",{className:"icon icon-forward"},S.default.createElement("span",{className:"c-cdred"},"好评",i,"%"),S.default.createElement("img",{src:"/src/img/icon/arrow/arrow-right-icon.png"})))),n.length>0&&S.default.createElement(Re,{rates:n,itemId:a}))}}]),t}(),Re=t.EvaluateAreaContents=function(e){function t(){return U(this,t),Z(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return G(t,b.Component),E(t,[{key:"getList",value:function(){var e=this.props,t=e.rates,a=e.itemId;return t.map(function(e,t){return S.default.createElement(Fe,{data:e,key:t,itemId:a})})}},{key:"componentDidMount",value:function(){this.refs.swiper&&this.initSwiper()}},{key:"initSwiper",value:function(){this.swiper=new Swiper(this.refs.swiper,{loop:!1,slidesPerView:1.35})}},{key:"render",value:function(){var e=this.getList(),t=this.props.rates.length;return 7===t?S.default.createElement("div",{"data-plugin":"swiper"},S.default.createElement("div",{className:"swiper-container evaluate-swiper-container",ref:"swiper"},S.default.createElement("div",{className:"swiper-wrapper"},e,S.default.createElement("div",{className:"swiper-slide more-evaluate c-fs12 c-c666",key:t},S.default.createElement(x.Link,{to:"/evaluate?item_id="+this.props.itemId,"data-notLogin":!0},S.default.createElement("ul",{className:"more"},S.default.createElement("li",null,"查看更多"),S.default.createElement("li",{className:"line-wrap"},S.default.createElement("i",{className:"line"}," ")),S.default.createElement("li",null,"See more"))))))):null}}]),t}(),Fe=function(e){function t(){var e,a,n;U(this,t);for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];return a=n=Z(this,(e=t.__proto__||(0,p.default)(t)).call.apply(e,[this].concat(i))),n.getName=function(e){return e?e.length>2?e.substring(0,1)+"**"+e.substring(e.length-1):e:null},n.getPhone=function(e){var t=String(e);return e?t.substring(0,3)+"***"+t.substring(t.length-3):null},Z(n,a)}return G(t,b.Component),E(t,[{key:"render",value:function(){var e=this.props,t=e.data,a=e.itemId;return S.default.createElement("div",{className:"swiper-slide each-evaluate"},S.default.createElement(x.Link,{to:"/evaluate?item_id="+a,"data-notLogin":!0},S.default.createElement("div",{className:"c-fl",style:0===t.images.length?{width:"100%"}:{}},S.default.createElement("h2",null,S.default.createElement("div",{className:"head"},S.default.createElement("img",{src:t.head_portrait?(0,O.addImageSuffix)(t.head_portrait,"_t"):"/src/img/icon/avatar/default-avatar.png"})),S.default.createElement("font",null,t.user_name)),S.default.createElement("div",{className:"evaluate-content"},t.content||z[t.experience])),t.images.length>0&&S.default.createElement("div",{className:"c-fr"},S.default.createElement("img",{src:(0,O.addImageSuffix)(t.images[0],"_s")}),S.default.createElement("span",{className:"img-num"},t.images.length,"张"))),S.default.createElement("p",{className:"c-cb"}))}}]),t}(),Oe=t.LinkAndChange=function(t){function a(){return U(this,a),Z(this,(a.__proto__||(0,p.default)(a)).apply(this,arguments))}return G(a,b.Component),E(a,[{key:"render",value:function(){var t=this.props,a=t.notLogin,n=t.onTouchTap,r=t.onClick,i=t.className,o=t.style,l=t.children,s=t.isLogin,c=t.to,u=t.href,d=t.flag,p=t.BackFlag,m=t.GoScrollHeght,f={onTouchTap:n,onClick:r,className:i,style:o,href:u,to:c},h={className:i,style:o,href:u,to:c};encodeURIComponent(c||location.href.slice(location.origin.length));return!0===a||s?S.default.createElement(x.Link,f,l):S.default.createElement(x.Link,w({},h,{onClick:function(t){t.preventDefault(),d?p():m(e(window).scrollTop()),x.browserHistory.push("/login?redirect_uri="+location.href)}}),l)}}]),a}(),qe=t.LinkChange=(0,k.connect)(Q,function(e){return{GoScrollHeght:function(t){e(j("goScrollHeght",{height:t}))}}})(Oe),Ue=t.RecommendArea=function(e){function t(){return U(this,t),Z(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return G(t,B.PureComponent),E(t,[{key:"componentDidMount",value:function(){this.refs.swiperRecommend&&this.initSwiper()}},{key:"initSwiper",value:function(){this.swiper=new Swiper(this.refs.swiperRecommend,{pagination:".swiper-pagination-recommend"})}},{key:"render",value:function(){var e=this.props.recommend,t=[],a=(t=e.length<=6?[e]:e.length>6&&e.length<=12?[e.slice(0,6),e.slice(6,e.length)]:[e.slice(0,6),e.slice(6,12),e.slice(12,e.length)]).map(function(e,t){return S.default.createElement(Ze,{key:t,data:e})});return e.length>0?S.default.createElement("div",{className:"recommend-area c-fs14","data-plugin":"swiper"},S.default.createElement("p",null,"为您推荐"),S.default.createElement("div",{className:"swiper-container recommend-swiper-container",ref:"swiperRecommend"},S.default.createElement("div",{className:"swiper-wrapper"},a),t.length>1&&S.default.createElement("div",{className:"swiper-pagination swiper-pagination-recommend"}))):null}}]),t}(),Ze=function(e){function t(){return U(this,t),Z(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return G(t,b.Component),E(t,[{key:"render",value:function(){var e=this.props.data.map(function(e,t){return S.default.createElement("li",{key:t,className:"rec-item",style:(t+1)%3==0?{marginRight:"0px"}:{}},S.default.createElement(x.Link,{to:"/item?item_id="+e.item_id},S.default.createElement("div",{className:"img-wraper"},S.default.createElement("img",{src:e.images[0]&&(0,O.addImageSuffix)(e.images[0],"_m")||"/src/img/item/no-img.png"}),e.promotion.tag&&S.default.createElement("span",{className:"tag"},e.promotion.tag)),S.default.createElement("div",{className:"title"},e.title),S.default.createElement("div",{className:"price"},S.default.createElement("span",{className:"c-fs11 c-cdred"},"¥",e.sell_price))))});return S.default.createElement("div",{className:"swiper-slide recommend-content"},e)}}]),t}(),Ge=t.ShopArea=function(e){function t(){return U(this,t),Z(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return G(t,b.Component),E(t,[{key:"render",value:function(){var e=this.props.shop;return e.is_open?S.default.createElement(x.Link,{className:"link",to:"/store/home?shop="+ +e.id},S.default.createElement("div",{className:"gap bgf4"}),S.default.createElement("ul",{className:"shop-arer"},S.default.createElement("li",{className:"image"},S.default.createElement("img",{src:(0,O.addImageSuffix)(e.logo,"_s")})),S.default.createElement("li",null,S.default.createElement("p",{className:"shop-name c-fs15"},e.alias?e.alias:e.name),S.default.createElement("p",{className:"shop-msg c-fs10 c-c999"},1===e.biz_model?"泰然城自营":"泰然城精选商家")),S.default.createElement("li",{className:"button"},"进入店铺"))):null}}]),t}(),je=function(t){function a(t){U(this,a);var n=Z(this,(a.__proto__||(0,p.default)(a)).call(this,t));return n.onClickImage=function(t){e(t.target).height(),e(t.target).width();var a=t.target.width,r=t.target.height;n.props.changeImgData(e(t.target)[0].src,a,r)},n.state={imgUrl:""},n}return G(a,b.Component),E(a,[{key:"componentDidMount",value:function(){e(".goods-pic img").click(this.onClickImage)}},{key:"render",value:function(){var e=this.props.data;return S.default.createElement("div",null,S.default.createElement("div",{className:"goods-pic",dangerouslySetInnerHTML:{__html:e.desc&&e.desc.wap}}))}}]),a}(),We=t.GoodsDetail=function(t){function a(e){U(this,a);var t=Z(this,(a.__proto__||(0,p.default)(a)).call(this,e));return t.changeImgData=function(e,a,n){t.setState({imgSrc:e,width:a,height:n})},t.state={active:0,imgSrc:"",width:0,height:0},t}return G(a,B.PureComponent),E(a,[{key:"componentWillUnmount",value:function(){this.unMount&&this.unMount()}},{key:"componentDidMount",value:function(){this.unMount=this.mount()}},{key:"mount",value:function(){var t=e(window).height(),a=this,n=e(this.refs.twContent).offset().top;function r(){window.scrollY+t>=n&&(a.setState(a.state),e(window).unbind("scroll",r))}return e(this.refs.detail).css("min-height",t-140),e(window).bind("scroll",r),function(){return e(window).unbind("scroll",r)}}},{key:"changeTag",value:function(e){e!=this.state.active&&this.setState({active:e})}},{key:"checkTag",value:function(e){return this.state.active===e?"active":""}},{key:"getList",value:function(){var e=this.props.data,t=e.properties,a=e.art_no,n=e.shelved_at,r=e.weight,i=[S.default.createElement("li",{key:"id"},"商品编号：",S.default.createElement("span",{className:"c-fr"},a)),S.default.createElement("li",{key:"time"},n&&"上架时间：",S.default.createElement("span",{className:"c-fr"},n&&n.split(" ")[0])),S.default.createElement("li",{key:"weight"},"商品毛重：",S.default.createElement("span",{className:"c-fr"},r,"kg"))];for(var o in t)i.push(S.default.createElement("li",{key:o},t[o].name,"：",S.default.createElement("span",{className:"c-fr"},t[o].text)));return i}},{key:"render",value:function(){var t=this,a=this.props.data,n=a.trade_type,r=this.state,i=r.imgSrc,o=r.width,l=r.height;return S.default.createElement("div",{className:"pic-area detail goods-detail",ref:"twContent"},S.default.createElement(M.ItemFix,null,S.default.createElement("div",{className:"tab-ti-wrap"},S.default.createElement("div",{className:"tab-ti"},S.default.createElement("ul",null,S.default.createElement("li",{className:this.checkTag(0),onClick:function(){return t.changeTag(0)}},S.default.createElement("span",null,"商品介绍")),S.default.createElement("li",{className:this.checkTag(1),onClick:function(){return t.changeTag(1)}},S.default.createElement("span",null,"商品参数")))))),S.default.createElement("div",{className:"tab-con"},S.default.createElement("div",{className:"tw-con "+this.checkTag(0)},"Direct"==n||"Overseas"==n?S.default.createElement("div",{className:"zhiyou img-w"},S.default.createElement("img",{src:"/src/img/pintuan/zhiyou.jpg",onClick:function(a){t.changeImgData("/src/img/pintuan/zhiyou.jpg",e(window).width(),a.target.height)}})):null,S.default.createElement(je,{data:a,changeImgData:this.changeImgData}),"Direct"==n||"Bonded"==n||"Overseas"==n?S.default.createElement("div",{className:"goods_text img-w"},S.default.createElement("img",{src:"/src/img/pintuan/goods_text.jpg",onClick:function(a){t.changeImgData("/src/img/pintuan/goods_text.jpg",e(window).width(),a.target.height)}})):"",S.default.createElement("div",{className:"price_text img-w"},S.default.createElement("img",{src:"/src/img/pintuan/price_text.jpg",onClick:function(a){t.changeImgData("/src/img/pintuan/price_text.jpg",e(window).width(),a.target.height)}}))),S.default.createElement("div",{className:"cs-con "+this.checkTag(1),ref:"detail"},S.default.createElement("ul",{className:"goods-detail"},this.getList()))),i&&S.default.createElement(He,{imgSrc:i,width:o,height:l,changeImgSrc:function(){t.state.imgSrc=""}}))}}]),a}(),He=function(e){function t(e){U(this,t);var a=Z(this,(t.__proto__||(0,p.default)(t)).call(this,e));return a.photoSwiper=function(e){a.state.gallery;var t=document.querySelectorAll(".pswp")[0],n=[{src:a.props.imgSrc,w:a.props.width,h:a.props.height}];new PhotoSwipe(t,PhotoSwipeUI_Default,n,{history:!1,focus:!1,tapToClose:!0,showAnimationDuration:0,hideAnimationDuration:0}).init()},a.state={gallery:""},a}return G(t,b.Component),E(t,[{key:"componentDidMount",value:function(){this.photoSwiper()}},{key:"componentDidUpdate",value:function(){this.photoSwiper()}},{key:"render",value:function(){return S.default.createElement("div",null,S.default.createElement("div",{className:"pswp",tabIndex:"-1",role:"dialog","aria-hidden":"true"},S.default.createElement("div",{className:"pswp__bg",onClick:this.props.changeImgSrc()}),S.default.createElement("div",{className:"pswp__scroll-wrap"},S.default.createElement("div",{className:"pswp__container"},S.default.createElement("div",{className:"pswp__item"}),S.default.createElement("div",{className:"pswp__item"}),S.default.createElement("div",{className:"pswp__item"})),S.default.createElement("div",{className:"pswp__ui pswp__ui--hidden"},S.default.createElement("div",{className:"pswp__top-bar"},S.default.createElement("div",{className:"pswp__counter"}),S.default.createElement("div",{className:"pswp__preloader"},S.default.createElement("div",{className:"pswp__preloader__icn"},S.default.createElement("div",{className:"pswp__preloader__cut"},S.default.createElement("div",{className:"pswp__preloader__donut"}))))),S.default.createElement("div",{className:"pswp__share-modal pswp__share-modal--hidden pswp__single-tap"},S.default.createElement("div",{className:"pswp__share-tooltip"})),S.default.createElement("button",{className:"pswp__button pswp__button--arrow--left",title:"Previous (arrow left)"}),S.default.createElement("button",{className:"pswp__button pswp__button--arrow--right",title:"Next (arrow right)"}),S.default.createElement("div",{className:"pswp__caption"},S.default.createElement("div",{className:"pswp__caption__center"}))))))}}]),t}(),Qe=t.Collect=(0,k.connect)(Ye,Ke)(c=function(e){function t(){var e,a,n;U(this,t);for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];return a=n=Z(this,(e=t.__proto__||(0,p.default)(t)).call.apply(e,[this].concat(i))),n.onCollect=function(){var e=n.props.favorite;if(!n.locked()){n.locked(!0);var t=w({},e?Y.DelFav:Y.Fav,{params:{item_id:n.props.data.item_id}});L.default.request(t).then(function(t){n.props.ChangeCollectStatus(!e),n.locked(!1)}).catch(function(e){console.log(e),T.tip.show({msg:e.response.data.message||"服务器繁忙"})})}},Z(n,a)}return G(t,b.Component),E(t,[{key:"locked",value:function(e){return null!=e&&(this.update=e),this.update}},{key:"render",value:function(){var e=this,t=this.props.favorite;return S.default.createElement("div",{className:"collect"},S.default.createElement(qe,{className:t?"save curr uncollect-goods":"save collect-goods",onClick:function(){return e.onCollect()}},t?[S.default.createElement("span",{className:"icon icon-favor text_sc",key:"0"},S.default.createElement("img",{src:"/src/img/icon/collected-icon.png"})),S.default.createElement("span",{className:"icon-title",key:"1"},"已收藏")]:[S.default.createElement("span",{className:"shoucang",key:"0"},S.default.createElement("img",{src:"/src/img/icon/collect-icon.png"})),S.default.createElement("span",{className:"icon-title",key:"1"}," 收藏")]))}}]),t}())||c;function Ye(e){return{favorite:e.itemIndex.favorite}}function Ke(e){return{ChangeCollectStatus:function(t){e(j("changeCollectStatus",{status:t}))}}}var Xe=t.TotopAndCart=function(t){function a(){return U(this,a),Z(this,(a.__proto__||(0,p.default)(a)).apply(this,arguments))}return G(a,b.Component),E(a,[{key:"componentWillUnmount",value:function(){e(window).unbind("scroll.top")}},{key:"componentDidMount",value:function(){var t=e(window),a=(t.height(),e(".toTop")),n=void 0;a.on("click",function(){clearInterval(n);var e=t.scrollTop();n=setInterval(function(){e-=100,t.scrollTop(e),e<=0&&clearInterval(n)},1)}),e(window).bind("scroll.top",function(){e(this).scrollTop()>e(window).height()?a.show():a.hide()})}},{key:"render",value:function(){var e=this.props.cartNum;return S.default.createElement("div",{className:"cart-toTop",style:(0,O.judgeIphoneX)()?{bottom:"80px"}:{}},S.default.createElement("ul",null,S.default.createElement("div",{onClick:function(){window.sessionStorage.setItem("areaData",""),x.browserHistory.push("/shopCart")}},S.default.createElement("li",{className:"cart"},S.default.createElement("span",{className:e?e>=10?"width2":"width1":"c-dpno"},e))),S.default.createElement("li",{className:"toTop"})))}}]),a}(),ze=t.BuyModalTitle=function(t){function a(){U(this,a);var e=Z(this,(a.__proto__||(0,p.default)(a)).call(this));return e.state={isLarge:!1},e}return G(a,b.Component),E(a,[{key:"getImg",value:function(){var e=this.props.data,t=this.props.retState,a=t.specKey,n=t.selectArr,r=this.props.promotion.info,i=void 0,o=void 0;return a&&a.some(function(e,t){return o=r.specs[e].values.filter(function(e,a){return e.spec_value_id==n[t]}),i=o[0].image}),i||e.primary_image}},{key:"componentDidUpdate",value:function(){this.state.isLarge&&te(".ui-table-view-large-wrapper",null,{newTime:0,oldTime:0,enlarge:!1,relativeX:0,relativeY:0,x1:0,x2:0,y1:0,startX:0,endX:0,wid:0,hei:0,lef:0,to:0,timerScale:null,self:this,isLarge:this.state.isLarge})}},{key:"render",value:function(){var t=this,a=this.props,n=(a.data,a.retState),r=a.promotion.info.specs,i=this.state.isLarge,o=this.props.retState.storeNum,l=ee(n,r);return S.default.createElement("div",null,i&&S.default.createElement("div",{className:"ui-table-view-large-img",style:{height:e(window).height(),top:e(".action-buy-modal").height()}},S.default.createElement("div",{className:"buy-shady",onClick:function(){t.setState({isLarge:!1})}}),S.default.createElement("div",{className:"ui-table-view-large-wrapper",style:{height:e(window).height()}},S.default.createElement("img",{src:(0,O.addImageSuffix)(this.getImg(),"_l")}))),S.default.createElement("ul",{className:"ui-table-view"},S.default.createElement("li",{className:"ui-table-view-cell"},S.default.createElement("span",{className:"posit-img"},S.default.createElement("img",{className:"ui-media-object ui-pull-left",src:this.getImg()?(0,O.addImageSuffix)(this.getImg(),"_s"):"/src/img/item/no-img.png",width:"80",height:"80",onClick:function(){t.setState({isLarge:!0})}})),S.default.createElement("div",{className:"ui-media-body window-head"},S.default.createElement("div",{className:"price-tag"},S.default.createElement("p",{className:"ui-ellipsis text-price action-update-price"},"¥",n.nowPrice)),S.default.createElement("span",{className:"c-c999"},"库存",o),!(r instanceof Array)&&l.length>0&&S.default.createElement("p",{className:"text-price-sel",style:{display:"block"}}," 已选：",l," ")))))}}]),a}(),Ve=function(e){function t(){var e,a,n;U(this,t);for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];return a=n=Z(this,(e=t.__proto__||(0,p.default)(t)).call.apply(e,[this].concat(i))),n.initList=function(){var e=n.props.promotion.info.specs;return(0,d.default)(e).map(function(t,a){return S.default.createElement($e,w({specs:e[t],index:a},n.props,{key:a}))})},n.getLimit=function(){var e=n.props.promotion.activity_type,t=n.props.promotionData;return"FlashSale"===e?S.default.createElement("span",{className:"limit_buy"},"限购",t[e].rules.user_buy_limit,"件 (已购",t[e].purchased_quantity,"件)"):null},n.numValid=function(e){var t=n.props,a=t.addMinNum,r=t.promotionData,i=n.props.promotion.activity_type,o=n.props.retState,l=o.num,s=o.storeNum,c=o.once,u=o.min;l=+l;var d="FlashSale"===i?r[i].rules.user_buy_limit-r[i].purchased_quantity:null;switch(e){case"plus":c?(l+c<=s&&(l+=c),a(l)):!(l===s||""===l||null!==d&&l>=d||0===s)&&a(l+1);break;case"minus":l>u&&(c?l%c?l=parseInt(l/c)*c:l-c>=c&&(l-=c):l-=1,a(l))}},Z(n,a)}return G(t,b.Component),E(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.changeNum,n=t.importNum,r=t.promotionData,i=t.focusNum,o=this.props.promotion.activity_type,l=this.props.retState,s=l.num,c=l.storeNum,u=l.min,d=l.once,p=l.moqAmount,m="FlashSale"===o?r[o].rules.user_buy_limit-r[o].purchased_quantity:null;return S.default.createElement("div",{className:"attr-wrap"},S.default.createElement("div",{className:"standard-area stable-standard cur"},S.default.createElement("div",{className:"standard-info"},this.initList())),S.default.createElement("div",{className:"buy-amount"},S.default.createElement("span",{className:"amount-tit row-title"},"购买数量："),!d&&p?S.default.createElement("span",{className:"c-c999 c-fs10"},"(",p,"件起售)"):"",d?S.default.createElement("span",{className:"c-c999 c-fs10"},"(",d,"倍购买)"):"",S.default.createElement("span",{className:"number-increase-decrease"},S.default.createElement("span",{className:"btn btn-action action-decrease "+(s<=u||""===s?"dis-click":""),onTouchTap:function(){e.numValid("minus")}},"－"),S.default.createElement("input",{type:"number",className:"action-quantity-input",value:s,onBlur:n,onChange:a,onFocus:i}),S.default.createElement("span",{className:"btn btn-action action-increase "+(s>=c||""===s||null!==m&&s>=m||0===c||d&&s+d>c?"dis-click":""),onTouchTap:function(){e.numValid("plus")}},"＋")),this.getLimit(),S.default.createElement("div",{className:"clearfix"})),S.default.createElement(et,this.props))}}]),t}(),Je=t.BuyModalButton=function(e){function t(){return U(this,t),Z(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return G(t,b.Component),E(t,[{key:"render",value:function(){var e=this.props,t=e.buyActive,a=e.onClickCart,n=e.onClickBuy,r=(e.purchaseLimit,e.toCartClick),i=e.isNonPayment,o=e.retState,l=this.props.promotion.realStore;return S.default.createElement("div",null,o.optionBtnShow?S.default.createElement("div",{className:"buy-option-btn",style:(0,O.judgeIphoneX)()?{height:"85px"}:{}},i?S.default.createElement("div",{className:"btn-tobuy-disable",style:{width:"100%"}},"还有机会"):S.default.createElement("div",null,l?S.default.createElement("div",{className:"btn-addcart "+("chooseSpec"===t?"btn-group btn-group-cart":"buy"===t?"c-dpno":"")+" "+("cart"===t?"btn-cart-only":""),onTouchTap:r?a:"",id:"add-package"},"加入购物袋"):S.default.createElement("div",{className:"btn-tobuy-disable"},"已售罄"),S.default.createElement("div",null,null,S.default.createElement("div",{className:"btn-tobuy "+("chooseSpec"===t?"btn-group btn-group-buy":"cart"===t?"c-dpno":""),onTouchTap:function(){n(t)}},"立即购买")))):null)}}]),t}(),$e=t.Specs=function(e){function t(){return U(this,t),Z(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return G(t,b.Component),E(t,[{key:"initList",value:function(){var e=this,t=this.props,a=t.isHasStore,n=t.specs,r=(t.promotion,t.index),i=t.judgeSingleSku,o=this.props.retState,l=o.newData,s=o.selectArr,c=n.values,u=n.spec_id;return c.map(function(t,n){var o=t.spec_value_id,c=a({spec:o,index:r},l,s);return S.default.createElement("li",{key:n,onClick:function(t){!i()&&c&&e.props.specSelect(o,r,u)},className:c?i()||s[r]===o?"on":"abled":"disabled"},S.default.createElement("span",{title:t.text},"Text"!=t.show_type&&t.image?S.default.createElement("span",null,S.default.createElement("img",{src:t.image,width:"25",height:"25",style:{marginTop:"-4px"}})," ",S.default.createElement("span",null," ",t.text," ")):t.text))})}},{key:"render",value:function(){var e=this.props.specs;return S.default.createElement("div",{className:"color parameter"},S.default.createElement("span",{className:"tit row-title"},e.name),S.default.createElement("ul",{className:"size_ul"},this.initList()))}}]),t}(),et=t.ExpectTax=function(e){function t(e){U(this,t);var a=Z(this,(t.__proto__||(0,p.default)(t)).call(this,e));return a.state={rateShow:!1},a}return G(t,b.Component),E(t,[{key:"getRate",value:function(){var e=this,t=this.props,a=t.data,n=t.buyActive,r=t.promotion,i=this.props.retState,o=i.nowPrice,l=i.num;if(!(0,N.TradeFade)(a)||"DOMESTIC"===a.trade_type)return null;var s=(1e4*+a.tax_rate/1e4*100).toFixed(2),c=String(o).split("-").length;o="groupBuy"===n?r.promotion[0].rules.group_price:1===c?o:a.sell_price;var u=(l="groupBuy"===n?1:l)*a.tax_rate*o;return+(u=(+u.toFixed(2)+(parseFloat((u-u.toFixed(2)).toFixed(10))>=1e-5?.01:0)).toFixed(2))?S.default.createElement("div",null,S.default.createElement("div",{className:"expect_tax",onClick:function(){return e.setState({rateShow:!e.state.rateShow})}},"预计税费",S.default.createElement("span",{className:"icon_slide c-fr "+(this.state.rateShow?"rotate":"")},S.default.createElement("img",{src:"/src/img/icon/arrow/arrow-btm-icon.png"})),S.default.createElement("span",{className:"tax_count c-fr",style:{display:this.state.rateShow?"none":"block"}},"￥",u)),S.default.createElement("div",{className:"expect_tax_con disnon",style:{display:this.state.rateShow?"block":"none"}},S.default.createElement("div",{className:"tax_count"},"￥",u),S.default.createElement("div",{className:"c-pl15 c-pr15"},S.default.createElement("div",{className:"hd"},S.default.createElement("img",{src:"/src/img/icon/checked-icon.png"})," 税率",S.default.createElement("span",{id:"tax_cou"},s),"%"),S.default.createElement("div",{className:"tax_cont tax_cont1"}," 按照国家规定，本商品适用于跨境综合税，税率为",s,"%， 实际结算税费请以提交订单时的应付总额明细为准。"),S.default.createElement("div",{className:"hd"},S.default.createElement("img",{src:"/src/img/icon/checked-icon.png"})," 税费计算"),S.default.createElement("div",{className:"tax_cont"},"进口税费=商品完税价格*税率")))):null}},{key:"render",value:function(){return this.getRate()}}]),t}(),tt=t.BuyModal=function(e){function t(e){U(this,t);var a=Z(this,(t.__proto__||(0,p.default)(t)).call(this,e));return a.changeBusinessPrice=function(){var e=a.props.retState,t=(e.num,e.nowPrice),n=e.nowSkuId,r=e.storeNum,i=e.selectArr,o=e.specKey,l=e.originalPrice,s=(e.min,e.once,a.props.promotion.info.skus),c=a.props.promotion.info.specs,u=(0,d.default)(s),p=void 0;u.map(function(e){0!==s[""+e].store&&(p=e)}),p=p||u[0],t=s[p].price,l=s[p].price,n=s[p].sku_id,r=s[p].store,i=p.split("_"),o=(0,d.default)(c);var m=w({},a.props.retState,{nowPrice:t,nowSkuId:n,storeNum:r,selectArr:i,specKey:o,originalPrice:l});a.props.InitState(m)},a.judgeSingleSku=function(){var e=a.props.promotion.info.skus,t=[],n=(0,d.default)(e);return n.map(function(a){0!==e[""+a].store&&t.push(e[""+a])}),1===n.length||1===t.length},a.addMinNum=function(e){var t=a.props.retState,n=t.num,r=t.nowPrice,i=(t.nowSkuId,t.selectArr,t.oldNum);n=i=e;var o=w({},a.props.retState,{num:n,oldNum:i,nowPrice:r});a.props.InitState(o)},a.purchaseLimit=function(){var e=a.props.data.trade_type;if(a.props.retState.num>1&&a.props.retState.nowSkuId&&(0,N.PurchaseLimit)(e))return a.props.retState.num*a.props.retState.nowPrice>2e3},a.getActionData=function(e){var t=a.props,n=t.retState,r=t.promotion,i=t.areaData,o=t.data,l=o.shop_id,s=(o.shop.attr,t.itemId),c=[],u=a.props.location.query.user_id;a.props.mix&&a.props.mix.addrList;r.promotion&&r.promotion.map(function(e,t){c.push({promotion_id:e.id,role:"main_good",type:e.type})});var d={subscribe:[{quantity:n.num,cart_id:0,sku_id:n.nowSkuId,item_id:s,created_at:(new Date).getTime(),extra:{promotion:c,commission_user_id:u}}]};return d=e?w({},d,{buyMode:"fast_buy",bizMode:"online",bizAttr:"trmall",address:i.addressData}):{item_id:s,sku_id:n.nowSkuId,quantity:n.num,shop_id:l,extra:{price:n.originalPrice,commission_user_id:u}}},a.onClickCart=function(){var e=a;a.checkSpec()?T.tip.show({msg:"请选择规格"}):(e.setState({toCartClick:!1}),L.default.request(w({},Y.toCart,{params:a.getActionData()})).then(function(t){e.setState({toCartClick:!0}),e.props.UpdateCartInfo(t.data.data),ae(),e.props.closeModal();var n=a.getActionData(),r=n.item_id,i=n.quantity,o=K(r,n.sku_id,i,t.status,t.data.code,"加入购物车成功");sdk.dispatch("click",document.getElementById("add-package"),o)}).catch(function(t){var n=t.response,r=n.status,i=n.data,o=n.message,l=a.getActionData(),s=l.item_id,c=l.quantity,u=K(s,l.sku_id,c,r,i.code,o);sdk.dispatch("click",document.getElementById("add-package"),u),T.tip.show({msg:t.response.data.message||"服务器繁忙"}),e.setState({toCartClick:!0})}))},a.onClickBuy=function(e){var t=a.props.location.query.item_id;if(a.checkSpec())T.tip.show({msg:"请选择规格"});else{var n=a.getActionData(!0);sessionStorage.setItem("fast_buy",(0,u.default)(n)),x.browserHistory.push("/orderConfirm?item_id="+t)}},a.isHasStore=function(e,t,a){return t&&t.some(function(t,n){if(t.ids[e.index]==e.spec){var r=a.slice();return r[e.index]&&delete r[e.index],!!r.every(function(e,n){return a[n]==t.ids[n]})&&t.skus.store>0}return!1})},a.specSelect=function(e,t,n){var r,i=a.props.retState,o=a.props.promotion.info.skus,l=a.props.promotion,s=l.realStore,c=(l.activity_type,i.selectArr),u=i.specKey,d=i.nowSku,p=i.storeNum,m=i.newData,f=i.nowSkuId,h=i.nowPrice,g=i.num,v=i.min,_=i.oldNum,y=i.deductPrice,E=i.originalPrice;(c=c.slice())[t]===e?(delete c[t],delete u[t]):(c[t]=e,u[t]=n),r=c.join("_"),c.length==m[0].ids.length&&o[r]?(d=o[r],f=o[r].sku_id,h=o[r].price,E=o[r].price,_=g=(g=+v)<(p=o[r].store)?g:p,y=o[r].deduct_price):(h=$(a.props.promotion,!0),p=s,f="",d="",y="",E="",g=+v);var b=w({},a.props.retState,{nowSku:d,selectArr:c,specKey:u,nowSkuId:f,nowPrice:h,num:g,min:v,oldNum:_,storeNum:p,deductPrice:y,originalPrice:E});a.props.InitState(b)},a.importNum=function(e){var t=+e.target.value,n=void 0,r=a.props.retState,i=r.num,o=r.storeNum,l=r.nowPrice,s=r.once,c=r.oldNum,u=r.min,d=(r.optionBtnShow,a.props),p=d.promotionData,m=d.promotion.activity_type,f="FlashSale"===m?p[m].rules.user_buy_limit-p[m].purchased_quantity:null;t?s?t%s?(i=c,n="仅支持"+s+"倍购买"):i=c=t>o?o:t:t<u?(n="该商品"+u+"件起售",i=o<u?c=o:c):i=c=o<u?o:t>o?o:t:i=c,f&&(i=c=i>f?f:i),n&&T.tip.show({msg:n});var h=w({},a.props.retState,{num:i,oldNum:c,nowPrice:l,optionBtnShow:!0});a.props.InitState(h)},a.changeNum=function(e){var t=a.props.retState.num;t=e.target.value.replace(/[^\d]/g,"");var n=w({},a.props.retState,{num:t});a.props.InitState(n)},a.focusNum=function(){a.props.retState.optionBtnShow;var e=w({},a.props.retState,{optionBtnShow:!1});a.props.InitState(e)},a.state={toCartClick:!0},a}return G(t,b.Component),E(t,[{key:"componentWillMount",value:function(){this.judgeSingleSku()&&this.changeBusinessPrice()}},{key:"checkSpec",value:function(){var e=this.props.retState,t=e.specKey,a=e.nowSkuId,n=this.props.promotion.info.specs;return!a&&((0,d.default)(n).filter(function(e,a){return+e!==t[a]}),!0)}},{key:"render",value:function(){var e=w({focusNum:this.focusNum,addMinNum:this.addMinNum,changeNum:this.changeNum,importNum:this.importNum,isHasStore:this.isHasStore,onClickCart:this.onClickCart,onClickBuy:this.onClickBuy,specSelect:this.specSelect,judgeSingleSku:this.judgeSingleSku,purchaseLimit:this.purchaseLimit,retState:this.props.retState,promotion:this.props.promotion,promotionData:this.props.promotionData,data:this.props.data,buyActive:this.props.buyActive,isNonPayment:this.props.isNonPayment},this.state);return S.default.createElement(D.NewModal,{isOpen:this.props.buyModal,onClose:this.props.closeModal},S.default.createElement("div",{className:"action-buy-modal",style:(0,O.judgeIphoneX)()?{paddingBottom:"34px"}:{}},S.default.createElement(ze,e),S.default.createElement(Ve,e),S.default.createElement(Je,e)))}}]),t}(),at=t.Buy=function(e){function t(){var e,a,n;U(this,t);for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];return a=n=Z(this,(e=t.__proto__||(0,p.default)(t)).call.apply(e,[this].concat(i))),n.active=function(e){n.props.UpdateBuyModal({buyModal:!0,buyActive:e})},n.isNonPayment=function(){var e=n.props.promotion,t=e.activity_type,a=e.realStore;if(t){var r=n.props.promotionData[""+t],i=r.activity_sales,o=r.activity_store;if(!a)return i!==o}},Z(n,a)}return G(t,b.Component),E(t,[{key:"render",value:function(){var e=this;return this.props.mixStatus&&this.props.proStatus?S.default.createElement("div",null,this.props.choose?S.default.createElement(qe,{className:"choose-btn",onClick:function(){e.active("chooseSpec")}}):this.props.data.is_charge?null:"SHELVING"===this.props.data.status?this.isNonPayment()?S.default.createElement("div",{className:"action-btn-group c-fr"},S.default.createElement(qe,{type:"button",className:"ui-btn action-disable"},"还有机会")):this.props.promotion.realStore?S.default.createElement("div",{className:"action-btn-group c-fr"},S.default.createElement(qe,{className:"ui-btn  action-addtocart c-fl",onClick:function(){e.active("cart")}},"加入购物袋"),S.default.createElement(qe,{className:"ui-btn  action-buy-now c-fl",onClick:function(){e.active("buy")}},"立即购买")):S.default.createElement("div",{className:"action-btn-group c-fr"},S.default.createElement(qe,{type:"button",className:"ui-btn action-disable"},"已售罄")):S.default.createElement("div",{className:"action-btn-group c-fr"},S.default.createElement(qe,{type:"button",className:"ui-btn action-disable"},"已下架"))):S.default.createElement("div",{className:"action-btn-group c-fr"},S.default.createElement("span",{className:"ui-btn  action-addtocart c-fl incomplete-addtocart"},"加入购物袋"),S.default.createElement("span",{className:"ui-btn  action-buy-now c-fl incomplete-buy-now"},"立即购买"))}}]),t}(),nt=(t.createBuyAction=function(e){var t=e.Buy;return function(e){function a(){return U(this,a),Z(this,(a.__proto__||(0,p.default)(a)).apply(this,arguments))}return G(a,B.PureComponent),E(a,[{key:"render",value:function(){var e=this.props,a=e.data,n=e.data.shop.attr,r=e.mix,i=e.cartNum,o=e.cartInfoStatus,l=e.mixStatus;return S.default.createElement("div",{className:"buy-action",style:(0,O.judgeIphoneX)()?{height:"85px"}:{}},S.default.createElement("div",{className:"collect serve_kf"},S.default.createElement(x.Link,{to:"/homeIndex",className:"save"},S.default.createElement("span",{className:"details_kf"},S.default.createElement("img",{src:"/src/img/icon/home-icon.png"})),S.default.createElement("span",{className:"icon-title"},"首页"))),S.default.createElement("div",{className:"collect serve_kf"},S.default.createElement(I.CustomerService,{className:"save",shopAttr:n},S.default.createElement("span",{className:"details_kf"},S.default.createElement("img",{src:"/src/img/icon/serve-phone-icon.png"})),S.default.createElement("span",{className:"icon-title"},"客服"))),S.default.createElement(Qe,{mix:r,data:a,mixStatus:l}),o&&S.default.createElement(Xe,{cartNum:i}),S.default.createElement(t,this.props))}}]),a}()})({Buy:at}),rt=(t.createChooseSpec=function(e){var t=e.Buy;return function(e){function a(){return U(this,a),Z(this,(a.__proto__||(0,p.default)(a)).apply(this,arguments))}return G(a,B.PureComponent),E(a,[{key:"render",value:function(){var e=this.props.promotion.info.specs,a=this.props,n=a.retState,r=a.data,i=a.promotion,o=ee(n,e);return e instanceof Array?null:S.default.createElement("div",{className:"choose-col"},S.default.createElement("div",{className:"choose-spec c-fs13"},S.default.createElement("span",{className:"c-mr15"},o.length>0?"已选择 ":"选择 "),o.length>0&&ee(n,e),S.default.createElement("i",{className:"icon icon-forward vertical-middle"},S.default.createElement("img",{src:"/src/img/icon/arrow/arrow-right-icon.png"}))),"SHELVING"===r.status&&i.realStore?S.default.createElement(t,w({},this.props,{choose:!0})):null,S.default.createElement("div",{className:"gap bgf4"}))}}]),a}()})({Buy:at}),it=t.BarrageStripWrap=function(e){function t(){return U(this,t),Z(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return G(t,b.Component),E(t,[{key:"componentWillMount",value:function(){this.props.getBarrage()}},{key:"render",value:function(){return this.props.barrage?S.default.createElement(F.BarrageStrip,{data:this.props.barrage,reset:this.props.resetBarrage}):null}}]),t}(),ot=t.BarrageStripConnnect=(0,k.connect)(F.homePageState,F.homePageDispatch)(it),lt=function(e){function t(){var e,a,n;U(this,t);for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];return a=n=Z(this,(e=t.__proto__||(0,p.default)(t)).call.apply(e,[this].concat(i))),n.closeModal=function(){n.props.UpdateBuyModal({buyModal:!1})},n.isNonPayment=function(){var e=n.props.promotion,t=e.activity_type,a=e.realStore;if(t){var r=n.props.promotionData[""+t],i=r.activity_sales,o=r.activity_store;if(!a)return i!==o}},Z(n,a)}return G(t,b.Component),E(t,[{key:"componentWillUnmount",value:function(){window.sessionStorage.removeItem("dcpPageTitle")}},{key:"render",value:function(){var e=this.props,t=e.location,a=e.data,n=e.mix,r=e.rate,i=e.recommend,o=e.promotion,l=e.cartNum,s=e.isLogin,c=e.pending,u=e.mixStatus,d=e.rateStatus,p=e.recommendStatus,m=e.proStatus,f=e.cartInfoStatus,h=e.retState,g=e.areaData,v=e.UpdateBuyModal,_=e.InitState,y=e.OrderInitParams,E=e.UpdateCartInfo,b=e.buyModal,k=e.buyActive,x=e.promotionData,N=e.intervalT,C=a.item_id,A={itemId:C,location:t,retState:h,data:a,mix:n,promotion:o,promotionData:x,mixStatus:u,proStatus:m,buyModal:b,buyActive:k,UpdateBuyModal:v,InitState:_,UpdateCartInfo:E,OrderInitParams:y,areaData:g},I=w({},A,{isNonPayment:this.isNonPayment(),closeModal:this.closeModal});return S.default.createElement("div",{"data-page":"item-detail",id:"item-details",ref:"details"},S.default.createElement(ot,null),S.default.createElement(re,null),u&&m&&S.default.createElement(tt,I),S.default.createElement("div",null,S.default.createElement(ie,{data:a,ref:"scrollImage"}),S.default.createElement(oe,{data:a,proStatus:m,promotion:o,intervalT:N}),m&&S.default.createElement(me,{promotion:o,shop:a.shop,retState:h}),S.default.createElement("div",{className:"gap bgf4"}),u&&m&&S.default.createElement(rt,A),u&&S.default.createElement(xe,{mix:n,data:a,retState:h,areaData:g,isLogin:s,pending:c}),S.default.createElement("div",{className:"gap bgf4"})),S.default.createElement("div",{className:"screen-rate"},d&&S.default.createElement(Le,{rate:r,itemId:C}),S.default.createElement("div",{className:"gap bgf4"}),p&&S.default.createElement(Ue,{recommend:i.data}),S.default.createElement("div",{className:"gap bgf4"}),S.default.createElement(Ge,{shop:a.shop})),S.default.createElement("div",{className:"screen-detail"},S.default.createElement(We,{data:a})),S.default.createElement(nt,w({cartNum:l,cartInfoStatus:f},A)))}}]),t}();t.default=lt}).call(this,a("OOjC"))},Qw5b:function(e,t,a){var n,r;
/*! PhotoSwipe Default UI - 4.1.2 - 2017-04-05
* http://photoswipe.com
* Copyright (c) 2017 Dmitry Semenov; */void 0===(r="function"==typeof(n=function(){"use strict";return function(e,t){var a,n,r,i,o,l,s,c,u,d,p,m,f,h,g,v,_,y,E=this,w=!1,b=!0,S=!0,k={barsSize:{top:44,bottom:"auto"},closeElClasses:["item","caption","zoom-wrap","ui","top-bar"],timeToIdle:4e3,timeToIdleOutside:1e3,loadingIndicatorDelay:1e3,addCaptionHTMLFn:function(e,t){return e.title?(t.children[0].innerHTML=e.title,!0):(t.children[0].innerHTML="",!1)},closeEl:!0,captionEl:!0,fullscreenEl:!0,zoomEl:!0,shareEl:!0,counterEl:!0,arrowEl:!0,preloaderEl:!0,tapToClose:!1,tapToToggleControls:!0,clickToCloseNonZoomable:!0,shareButtons:[{id:"facebook",label:"Share on Facebook",url:"https://www.facebook.com/sharer/sharer.php?u={{url}}"},{id:"twitter",label:"Tweet",url:"https://twitter.com/intent/tweet?text={{text}}&url={{url}}"},{id:"pinterest",label:"Pin it",url:"http://www.pinterest.com/pin/create/button/?url={{url}}&media={{image_url}}&description={{text}}"},{id:"download",label:"Download image",url:"{{raw_image_url}}",download:!0}],getImageURLForShare:function(){return e.currItem.src||""},getPageURLForShare:function(){return window.location.href},getTextForShare:function(){return e.currItem.title||""},indexIndicatorSep:" / ",fitControlsWidth:1200},x=function(e){if(v)return!0;e=e||window.event,g.timeToIdle&&g.mouseUsed&&!u&&B();for(var a,n,r=e.target||e.srcElement,i=r.getAttribute("class")||"",o=0;o<O.length;o++)(a=O[o]).onTap&&i.indexOf("pswp__"+a.name)>-1&&(a.onTap(),n=!0);if(n){e.stopPropagation&&e.stopPropagation(),v=!0;var l=t.features.isOldAndroid?600:30;setTimeout(function(){v=!1},l)}},N=function(e,a,n){t[(n?"add":"remove")+"Class"](e,"pswp__"+a)},C=function(){var e=1===g.getNumItemsFn();e!==h&&(N(n,"ui--one-slide",e),h=e)},A=function(){N(s,"share-modal--hidden",S)},I=function(){return(S=!S)?(t.removeClass(s,"pswp__share-modal--fade-in"),setTimeout(function(){S&&A()},300)):(A(),setTimeout(function(){S||t.addClass(s,"pswp__share-modal--fade-in")},30)),S||M(),!1},T=function(t){var a=(t=t||window.event).target||t.srcElement;return e.shout("shareLinkClick",t,a),!(!a.href||!a.hasAttribute("download")&&(window.open(a.href,"pswp_share","scrollbars=yes,resizable=yes,toolbar=no,location=yes,width=550,height=420,top=100,left="+(window.screen?Math.round(screen.width/2-275):100)),S||I(),1))},M=function(){for(var e,t,a,n,r,i="",o=0;o<g.shareButtons.length;o++)e=g.shareButtons[o],a=g.getImageURLForShare(e),n=g.getPageURLForShare(e),r=g.getTextForShare(e),t=e.url.replace("{{url}}",encodeURIComponent(n)).replace("{{image_url}}",encodeURIComponent(a)).replace("{{raw_image_url}}",a).replace("{{text}}",encodeURIComponent(r)),i+='<a href="'+t+'" target="_blank" class="pswp__share--'+e.id+'"'+(e.download?"download":"")+">"+e.label+"</a>",g.parseShareButtonOut&&(i=g.parseShareButtonOut(e,i));s.children[0].innerHTML=i,s.children[0].onclick=T},D=function(e){for(var a=0;a<g.closeElClasses.length;a++)if(t.hasClass(e,"pswp__"+g.closeElClasses[a]))return!0},P=0,B=function(){clearTimeout(y),P=0,u&&E.setIdle(!1)},L=function(e){var t=(e=e||window.event).relatedTarget||e.toElement;t&&"HTML"!==t.nodeName||(clearTimeout(y),y=setTimeout(function(){E.setIdle(!0)},g.timeToIdleOutside))},R=function(e){m!==e&&(N(p,"preloader--active",!e),m=e)},F=function(a){var o=a.vGap;if(!e.likelyTouchDevice||g.mouseUsed||screen.width>g.fitControlsWidth){var l=g.barsSize;if(g.captionEl&&"auto"===l.bottom)if(i||((i=t.createEl("pswp__caption pswp__caption--fake")).appendChild(t.createEl("pswp__caption__center")),n.insertBefore(i,r),t.addClass(n,"pswp__ui--fit")),g.addCaptionHTMLFn(a,i,!0)){var s=i.clientHeight;o.bottom=parseInt(s,10)||44}else o.bottom=l.top;else o.bottom="auto"===l.bottom?0:l.bottom;o.top=l.top}else o.top=o.bottom=0},O=[{name:"caption",option:"captionEl",onInit:function(e){r=e}},{name:"share-modal",option:"shareEl",onInit:function(e){s=e},onTap:function(){I()}},{name:"button--share",option:"shareEl",onInit:function(e){l=e},onTap:function(){I()}},{name:"button--zoom",option:"zoomEl",onTap:e.toggleDesktopZoom},{name:"counter",option:"counterEl",onInit:function(e){o=e}},{name:"button--close",option:"closeEl",onTap:e.close},{name:"button--arrow--left",option:"arrowEl",onTap:e.prev},{name:"button--arrow--right",option:"arrowEl",onTap:e.next},{name:"button--fs",option:"fullscreenEl",onTap:function(){a.isFullscreen()?a.exit():a.enter()}},{name:"preloader",option:"preloaderEl",onInit:function(e){p=e}}];E.init=function(){var o;t.extend(e.options,k,!0),g=e.options,n=t.getChildByClass(e.scrollWrap,"pswp__ui"),(d=e.listen)("onVerticalDrag",function(e){b&&e<.95?E.hideControls():!b&&e>=.95&&E.showControls()}),d("onPinchClose",function(e){b&&e<.9?(E.hideControls(),o=!0):o&&!b&&e>.9&&E.showControls()}),d("zoomGestureEnded",function(){(o=!1)&&!b&&E.showControls()}),d("beforeChange",E.update),d("doubleTap",function(t){var a=e.currItem.initialZoomLevel;e.getZoomLevel()!==a?e.zoomTo(a,t,333):e.zoomTo(g.getDoubleTapZoom(!1,e.currItem),t,333)}),d("preventDragEvent",function(e,t,a){var n=e.target||e.srcElement;n&&n.getAttribute("class")&&e.type.indexOf("mouse")>-1&&(n.getAttribute("class").indexOf("__caption")>0||/(SMALL|STRONG|EM)/i.test(n.tagName))&&(a.prevent=!1)}),d("bindEvents",function(){t.bind(n,"pswpTap click",x),t.bind(e.scrollWrap,"pswpTap",E.onGlobalTap),e.likelyTouchDevice||t.bind(e.scrollWrap,"mouseover",E.onMouseOver)}),d("unbindEvents",function(){S||I(),_&&clearInterval(_),t.unbind(document,"mouseout",L),t.unbind(document,"mousemove",B),t.unbind(n,"pswpTap click",x),t.unbind(e.scrollWrap,"pswpTap",E.onGlobalTap),t.unbind(e.scrollWrap,"mouseover",E.onMouseOver),a&&(t.unbind(document,a.eventK,E.updateFullscreen),a.isFullscreen()&&(g.hideAnimationDuration=0,a.exit()),a=null)}),d("destroy",function(){g.captionEl&&(i&&n.removeChild(i),t.removeClass(r,"pswp__caption--empty")),s&&(s.children[0].onclick=null),t.removeClass(n,"pswp__ui--over-close"),t.addClass(n,"pswp__ui--hidden"),E.setIdle(!1)}),g.showAnimationDuration||t.removeClass(n,"pswp__ui--hidden"),d("initialZoomIn",function(){g.showAnimationDuration&&t.removeClass(n,"pswp__ui--hidden")}),d("initialZoomOut",function(){t.addClass(n,"pswp__ui--hidden")}),d("parseVerticalMargin",F),function(){var e,a,r,i=function(n){if(n)for(var i=n.length,o=0;o<i;o++){e=n[o],a=e.className;for(var l=0;l<O.length;l++)r=O[l],a.indexOf("pswp__"+r.name)>-1&&(g[r.option]?(t.removeClass(e,"pswp__element--disabled"),r.onInit&&r.onInit(e)):t.addClass(e,"pswp__element--disabled"))}};i(n.children);var o=t.getChildByClass(n,"pswp__top-bar");o&&i(o.children)}(),g.shareEl&&l&&s&&(S=!0),C(),g.timeToIdle&&d("mouseUsed",function(){t.bind(document,"mousemove",B),t.bind(document,"mouseout",L),_=setInterval(function(){2==++P&&E.setIdle(!0)},g.timeToIdle/2)}),g.fullscreenEl&&!t.features.isOldAndroid&&(a||(a=E.getFullscreenAPI()),a?(t.bind(document,a.eventK,E.updateFullscreen),E.updateFullscreen(),t.addClass(e.template,"pswp--supports-fs")):t.removeClass(e.template,"pswp--supports-fs")),g.preloaderEl&&(R(!0),d("beforeChange",function(){clearTimeout(f),f=setTimeout(function(){e.currItem&&e.currItem.loading?(!e.allowProgressiveImg()||e.currItem.img&&!e.currItem.img.naturalWidth)&&R(!1):R(!0)},g.loadingIndicatorDelay)}),d("imageLoadComplete",function(t,a){e.currItem===a&&R(!0)}))},E.setIdle=function(e){u=e,N(n,"ui--idle",e)},E.update=function(){b&&e.currItem?(E.updateIndexIndicator(),g.captionEl&&(g.addCaptionHTMLFn(e.currItem,r),N(r,"caption--empty",!e.currItem.title)),w=!0):w=!1,S||I(),C()},E.updateFullscreen=function(n){n&&setTimeout(function(){e.setScrollOffset(0,t.getScrollY())},50),t[(a.isFullscreen()?"add":"remove")+"Class"](e.template,"pswp--fs")},E.updateIndexIndicator=function(){g.counterEl&&(o.innerHTML=e.getCurrentIndex()+1+g.indexIndicatorSep+g.getNumItemsFn())},E.onGlobalTap=function(a){var n=(a=a||window.event).target||a.srcElement;if(!v)if(a.detail&&"mouse"===a.detail.pointerType){if(D(n))return void e.close();t.hasClass(n,"pswp__img")&&(1===e.getZoomLevel()&&e.getZoomLevel()<=e.currItem.fitRatio?g.clickToCloseNonZoomable&&e.close():e.toggleDesktopZoom(a.detail.releasePoint))}else if(g.tapToToggleControls&&(b?E.hideControls():E.showControls()),g.tapToClose&&(t.hasClass(n,"pswp__img")||D(n)))return void e.close()},E.onMouseOver=function(e){var t=(e=e||window.event).target||e.srcElement;N(n,"ui--over-close",D(t))},E.hideControls=function(){t.addClass(n,"pswp__ui--hidden"),b=!1},E.showControls=function(){b=!0,w||E.update(),t.removeClass(n,"pswp__ui--hidden")},E.supportsFullscreen=function(){var e=document;return!!(e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen)},E.getFullscreenAPI=function(){var t,a=document.documentElement,n="fullscreenchange";return a.requestFullscreen?t={enterK:"requestFullscreen",exitK:"exitFullscreen",elementK:"fullscreenElement",eventK:n}:a.mozRequestFullScreen?t={enterK:"mozRequestFullScreen",exitK:"mozCancelFullScreen",elementK:"mozFullScreenElement",eventK:"moz"+n}:a.webkitRequestFullscreen?t={enterK:"webkitRequestFullscreen",exitK:"webkitExitFullscreen",elementK:"webkitFullscreenElement",eventK:"webkit"+n}:a.msRequestFullscreen&&(t={enterK:"msRequestFullscreen",exitK:"msExitFullscreen",elementK:"msFullscreenElement",eventK:"MSFullscreenChange"}),t&&(t.enter=function(){if(c=g.closeOnScroll,g.closeOnScroll=!1,"webkitRequestFullscreen"!==this.enterK)return e.template[this.enterK]();e.template[this.enterK](Element.ALLOW_KEYBOARD_INPUT)},t.exit=function(){return g.closeOnScroll=c,document[this.exitK]()},t.isFullscreen=function(){return document[this.elementK]}),t}}})?n.call(t,a,t,e):n)||(e.exports=r)},Wkbk:function(e,t,a){"use strict";(function(e){var n=d(a("mvHQ")),r=d(a("fZjL")),i=d(a("Zx67")),o=d(a("kiBT")),l=d(a("OvRC")),s=d(a("pFYg")),c=d(a("C4MV")),u=d(a("woOf"));function d(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.createChooseSpec=t.ActiveArea=t.Buy=t.BuyModalButton=t.BuyModalTitle=t.BuyModal=void 0;var p=u.default||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},m=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,c.default)(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),f=a("U7vG"),h=x(f),g=(x(a("O27J")),a("Zfgq")),v=a("rsfq"),_=(a("d2xe"),a("6quk")),y=(a("fw66"),a("8x+B")),E=a("XKGu"),w=x(a("qAHI")),b=a("JmOZ"),S=a("f2t5");a("kjFZ");var k=a("JmOZ");function x(e){return e&&e.__esModule?e:{default:e}}function N(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,s.default)(t))&&"function"!=typeof t?e:t}function A(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,s.default)(t)));e.prototype=(0,l.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(o.default?(0,o.default)(e,t):e.__proto__=t)}var I=function(e){function t(){return N(this,t),C(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return A(t,E.PureComponent),m(t,[{key:"render",value:function(){return h.default.createElement("div",{className:"notice-group-price"},h.default.createElement(T,{item:this.props.data,proStatus:this.props.proStatus,promotion:this.props.promotion}),this.props.proStatus&&h.default.createElement(M,p({},this.props.promotion.promotion[0],{intervalT:this.props.intervalT})))}}]),t}(),T=function(e){function t(e){N(this,t);var a=C(this,(t.__proto__||(0,i.default)(t)).call(this,e));return a.state={sellPrice:parseFloat((+a.props.item.sell_price).toFixed(2)),marketPrice:parseFloat((+a.props.item.market_price).toFixed(2)),groupPerson:""},a}return A(t,f.Component),m(t,[{key:"componentWillReceiveProps",value:function(e){e.proStatus&&this.setState({sellPrice:e.promotion.promotion[0].rules.group_price,groupPerson:e.promotion.promotion[0].rules.group_person})}},{key:"componentDidMount",value:function(){this.props.proStatus&&this.setState({sellPrice:this.props.promotion.promotion[0].rules.group_price,groupPerson:this.props.promotion.promotion[0].rules.group_person})}},{key:"render",value:function(){var e=this.props.item,t=(e.is_free,e.trade_type,e.tax_rate,this.state),a=t.sellPrice,n=t.marketPrice,r=t.groupPerson;return h.default.createElement("div",{className:"c-cfff"},h.default.createElement("span",{className:"c-fs10 c-dpib c-fl group-person"},r,"人团"),h.default.createElement("span",{className:"c-fs20 c-dpib c-fl"}," ¥",a),n&&n!==a?h.default.createElement("span",{className:"c-dpib c-fl market-price"}," ¥",n):null)}}]),t}(),M=function(e){function t(e){N(this,t);var a=C(this,(t.__proto__||(0,i.default)(t)).call(this,e));return a.changeTime=function(){var e=a.props,t=e.start_time,n=e.now_time,r=e.end_time,i=a.state.intervalT;n=new Date(n.replace(/-/g,"/")).getTime()+parseInt(i),t=new Date(t.replace(/-/g,"/")).getTime(),r=new Date(r.replace(/-/g,"/")).getTime(),n<t?a.setState({time:parseInt((t-n)/1e3),startFlag:!0}):a.setState({time:parseInt((r-n)/1e3),startFlag:!1})},a.state={time:0,startFlag:!1,intervalT:a.props.intervalT},a}return A(t,f.Component),m(t,[{key:"componentDidMount",value:function(){this.changeTime(),this.intervalTime()}},{key:"componentWillReceiveProps",value:function(e){e.intervalT!==this.state.intervalT&&this.setState({intervalT:e.intervalT},function(){this.changeTime(),window.clearInterval(this.timer),this.timer=null,this.intervalTime()})}},{key:"intervalTime",value:function(){var e=this;this.timer=setInterval(function(){var t=--e.state.time;t<0?location.reload():(e.state.time=t,e.setState(e.state))},1e3)}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.timer),this.timer=null}},{key:"render",value:function(){return h.default.createElement("div",{className:"c-cfff c-fs12 c-fr group-purchase-deadLine",id:"group-purchase-deadLine"},h.default.createElement("div",null,this.state.startFlag?"距开始仅剩":"距结束仅剩"),h.default.createElement("div",null,S.timeCtrl.formatTextTime(this.state.time)))}}]),t}(),D=function(e){function t(){return N(this,t),C(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return A(t,f.Component),m(t,[{key:"render",value:function(){var e=this.props.data.vip_info;return h.default.createElement("div",{className:"price-area"},h.default.createElement(k.VipArea,{vipInfo:e}),h.default.createElement(P,this.props),h.default.createElement(k.Tag,{item:this.props.data}))}}]),t}(),P=function(e){function t(){return N(this,t),C(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return A(t,f.Component),m(t,[{key:"render",value:function(){var e=this.props.data,t=e.title,a=e.sub_title;e.shop;return h.default.createElement("div",null,h.default.createElement("p",{className:"goods-tit"},t),this.props.proStatus&&"Rookie"===this.props.promotion.promotion[0].rules.group_type?h.default.createElement("p",{className:"c-c666 sub-title"},"该商品所有用户均可开团，仅限泰然城购物的新用户参团哦！开团后邀请泰然城新朋友参团吧"):a&&h.default.createElement("p",{className:"c-c666 sub-title"},a))}}]),t}(),B=function(e){function t(){return N(this,t),C(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return A(t,f.Component),m(t,[{key:"render",value:function(){var e=this.props,t=e.promotion,a=e.location;return h.default.createElement("div",{className:"fight-group-active"},h.default.createElement("div",{className:"c-fs12 fight-group-top"},"支付开团并邀请",h.default.createElement("span",null,t.promotion[0].rules.group_person-1),"人参团，人数不足退款"),h.default.createElement(g.Link,{to:"/pintuan-rules",className:"fight-group-rules"},h.default.createElement("p",{className:"c-fs15 c-cf55 c-mb5"},"拼团玩法"),h.default.createElement("img",{src:"src/img/pintuan/group-rules.png"}),h.default.createElement("img",{className:"direction-right-icon",src:"src/img/pintuan/black-direction-right.png"})),h.default.createElement(L,{promotion:t,location:a}))}}]),t}(),L=function(e){function t(){return N(this,t),C(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return A(t,f.Component),m(t,[{key:"getDetailList",value:function(){var e=this.props.promotion.groupBuy,t=e.group_info,a=e.group_data,n=this.props.location,r=[];return t&&t.forEach(function(e,t){r.push(h.default.createElement(R,{key:t,data:e,groupData:a,location:n}))}),r}},{key:"render",value:function(){var e=this.props.promotion.groupBuy.group_info;return e?h.default.createElement("div",{className:"fight-group-detail"},e.length?h.default.createElement("h3",null,h.default.createElement("i",{className:"current-icon"},h.default.createElement("img",{src:"src/img/pintuan/red-current-icon.png",alt:""})),"以下小伙伴正在发起团购，您可以直接参与"):null,h.default.createElement("ul",{className:"participants"},this.getDetailList())):null}}]),t}(),R=function(e){function t(e){N(this,t);var a=C(this,(t.__proto__||(0,i.default)(t)).call(this,e)),n=a.props.location.query.user_id;return a.state={user_id:n},a}return A(t,f.Component),m(t,[{key:"componentWillMount",value:function(){var e=this.props.data,t=e.expire_time,a=e.now_time;t=new Date(t.replace(/-/g,"/")).getTime(),(a=new Date(a.replace(/-/g,"/")).getTime())>t&&(this.state.unUpdate=!0)}},{key:"componentDidMount",value:function(){var e=this.props.data,t=e.expire_time,a=e.now_time;t=new Date(t.replace(/-/g,"/")).getTime(),a=new Date(a.replace(/-/g,"/")).getTime(),this.unUpdate||(this.state.time=(t-a)/1e3,this.intervalTime())}},{key:"intervalTime",value:function(){var e=this;this.timer=setTimeout(function(){var t=--e.state.time;t<0?e.state.unUpdate=!0:(e.state.time=t,e.intervalTime()),e.setState(e.state)},1e3)}},{key:"componentWillUnmount",value:function(){window.clearTimeout(this.timer),this.timer=null}},{key:"getTime",value:function(){return this.state.unUpdate?"团已过期":S.timeCtrl.formatTime(this.state.time)}},{key:"getName",value:function(e,t){return e?e.length>2?e.substring(0,1)+"**"+e.substring(e.length-1):e:t&&t.replace(/(\d{3})\d{5}(\d{3})/,"$1*****$2")}},{key:"render",value:function(){var e=this.props.data,t=this.state.user_id;return h.default.createElement("li",null,h.default.createElement("div",{className:"list-detail"},h.default.createElement("div",{className:"list-left"},h.default.createElement("div",{className:"participants-name"},this.getName(e.nickname,e.name)),h.default.createElement("div",{className:"group-info"},h.default.createElement("div",{className:"group-info-residue"},"还差",e.required_person-e.current_person,"人成团"),h.default.createElement("div",{className:"group-info-time"},this.getTime()))),h.default.createElement(k.LinkChange,{className:"list-right",to:t?"/groupDetail?object_id="+e.id+"&user_id="+t+"&&itemFlag=true":"/groupDetail?object_id="+e.id+"&&itemFlag=true"},"去参团",h.default.createElement("i",{className:"group-direction-right"}))),h.default.createElement("img",{className:"participants-avatar",src:e.avatar||"/src/img/icon/avatar/default-avatar.png",alt:"头像"}))}}]),t}(),F=t.BuyModal=function(e){function t(e){N(this,t);var a=C(this,(t.__proto__||(0,i.default)(t)).call(this,e));return a.judgeSingleSku=function(){var e=a.props.promotion.info.skus,t=[],n=(0,r.default)(e);return n.map(function(a){0!==e[""+a].store&&t.push(e[""+a])}),1===n.length||1===t.length},a.changeBusinessPrice=function(){var e=a.props.retState,t=(e.num,e.nowPrice),n=e.nowSkuId,i=e.storeNum,o=e.selectArr,l=e.specKey,s=e.originalPrice,c=a.props.promotion.info.skus,u=a.props.promotion.info.specs,d=(0,r.default)(c),m=void 0;d.map(function(e){0!==c[""+e].store&&(m=e)}),m=m||d[0],t=c[m].price,s=c[m].price,n=c[m].sku_id,i=c[m].store,o=m.split("_"),l=(0,r.default)(u);var f=p({},a.props.retState,{nowPrice:t,nowSkuId:n,storeNum:i,selectArr:o,specKey:l,originalPrice:s});a.props.InitState(f)},a.addMinNum=function(e){var t=a.props.retState,n=t.num,r=t.nowPrice;t.nowSkuId,t.selectArr;n=n+e;var i=p({},a.props.retState,{num:n,nowPrice:r});a.props.InitState(i)},a.purchaseLimit=function(){var e=a.props.data.trade_type;if(a.props.retState.num>1&&a.props.retState.nowSkuId&&(0,v.PurchaseLimit)(e))return a.props.retState.num*a.props.retState.nowPrice>2e3},a.getActionData=function(e){var t=a.props,n=t.retState,r=t.promotion,i=t.areaData,o=t.data,l=o.shop_id,s=(o.shop.attr,t.itemId),c=[],u=a.props.location.query.user_id,d=a.props.mix&&a.props.mix.addrList;d&&(d.recent_addr.length>0&&d.recent_addr[0].addr_id||d.default_addr&&d.default_addr.addr_id);r.promotion&&r.promotion.map(function(e,t){c.push({promotion_id:e.id,role:"main_good",type:e.type})});var m={subscribe:[{quantity:1,cart_id:0,sku_id:n.nowSkuId,item_id:s,created_at:(new Date).getTime(),extra:{group_buy_params:{type:r.promotion[0].rules.group_type,object_id:a.props.data.object_id||0,mode:a.props.data.object_id?"join":"open"},promotion:c,commission_user_id:u}}]};return m=e?p({},m,{buyMode:"fast_buy",bizMode:"online",bizAttr:"trmall",address:i.addressData}):{item_id:s,sku_id:n.nowSkuId,quantity:n.num,shop_id:l,extra:{price:n.originalPrice,commission_user_id:u}}},a.isHasStore=function(e,t,a){return t&&t.some(function(t,n){if(t.ids[e.index]==e.spec){var r=a.slice();return r[e.index]&&delete r[e.index],!!r.every(function(e,n){return a[n]==t.ids[n]})&&t.skus.store>0}return!1})},a.specSelect=function(e,t,n){var r,i=a.props.retState,o=a.props.promotion.info.skus,l=a.props.promotion,s=l.realStore,c=(l.activity_type,i.selectArr),u=i.specKey,d=i.nowSku,m=i.storeNum,f=i.newData,h=i.nowSkuId,g=i.nowPrice,v=i.num,_=i.deductPrice,y=i.originalPrice;(c=c.slice())[t]===e?(delete c[t],delete u[t]):(c[t]=e,u[t]=n),r=c.join("_"),c.length==f[0].ids.length&&o[r]?(d=o[r],h=o[r].sku_id,g=o[r].price,m=o[r].store,y=o[r].price,v=v<m?v:m,_=o[r].deduct_price):(g=(0,k.rangePrice)(a.props.promotion,!0),m=s,h="",d="",_="",y="");var E=p({},a.props.retState,{nowSku:d,selectArr:c,specKey:u,nowSkuId:h,nowPrice:g,num:v,storeNum:m,deductPrice:_,originalPrice:y});a.props.InitState(E)},a.importNum=function(e){var t=e.target.value,n=a.props.retState,r=n.num,i=n.storeNum;if(!t){r=a.preNum||i;var o=p({},a.props.retState,{num:r});a.props.InitState(o)}},a.changeNum=function(e){var t=a.props.retState,n=t.num,r=(t.nowSku,t.storeNum),i=e.target.value;a.preNum=n,n=+(i=i.replace(/[^\d]/g,""))?+i>r?n:+i:"";var o=p({},a.props.retState,{num:n});a.props.InitState(o)},a.onClickBuy=function(e){var t=a.props,r=t.itemId,i=t.data.object_id,o=t.promotion;if(a.checkSpec())_.tip.show({msg:"请选择规格"});else{var l=!("groupBuy"!==e&&!a.props.active);if(l)w.default.request(p({},k.pageApi.CheckGroupBuy,{params:{promotion_id:o.promotion[0].id,object_id:i||0,group_type:o.promotion[0].rules.group_type}})).then(function(){var t=a.getActionData(l);sessionStorage.setItem("fast_buy",(0,n.default)(t)),a.props.UpdateBuyModal({buyModal:!a.props.active,buyActive:a.props.active?"":e}),g.browserHistory.push("/orderConfirm?item_id="+r)}).catch(function(e){console.log(e),_.tip.show({msg:e.response&&e.response.data.message||"服务器繁忙"})});else{var s=a;s.setState({toCartClick:!1}),w.default.request(p({},k.pageApi.toCart,{params:a.getActionData()})).then(function(e){s.setState({toCartClick:!0}),s.props.UpdateCartInfo(e.data.data),(0,k.flyToCart)(),s.props.closeModal();var t=a.getActionData(),n=t.item_id,r=t.quantity,i=t.sku_id,o=(0,k.setExtraInfo)(n,i,r,e.status,e.data.code,"加入购物车成功");sdk.dispatch("click",document.getElementById("add-package"),o)}).catch(function(e){var t=e.response,n=t.status,r=t.data,i=t.message,o=a.getActionData(),l=o.item_id,s=o.quantity,c=o.sku_id,u=(0,k.setExtraInfo)(l,c,s,n,r.code,i);sdk.dispatch("click",document.getElementById("add-package"),u),_.tip.show({msg:e.response.data.message||"服务器繁忙"})})}}},a.state={toCartClick:!0},a}return A(t,f.Component),m(t,[{key:"componentWillMount",value:function(){this.judgeSingleSku()&&this.changeBusinessPrice()}},{key:"checkSpec",value:function(){var e=this.props.retState,t=e.specKey,a=e.nowSkuId,n=this.props.promotion.info.specs;return!a&&((0,r.default)(n).filter(function(e,a){return+e!==t[a]}),!0)}},{key:"render",value:function(){var e=p({addMinNum:this.addMinNum,changeNum:this.changeNum,importNum:this.importNum,isHasStore:this.isHasStore,specSelect:this.specSelect,judgeSingleSku:this.judgeSingleSku,onClickBuy:this.onClickBuy,purchaseLimit:this.purchaseLimit},this.state,this.props);return h.default.createElement(y.NewModal,{isOpen:this.props.buyModal,onClose:this.props.closeModal},h.default.createElement("div",{className:"action-buy-modal",style:(0,S.judgeIphoneX)()?{paddingBottom:"34px"}:{}},h.default.createElement(O,e),h.default.createElement(q,e),h.default.createElement(U,e)))}}]),t}(),O=t.BuyModalTitle=function(t){function a(){N(this,a);var e=C(this,(a.__proto__||(0,i.default)(a)).call(this));return e.state={isLarge:!1},e}return A(a,f.Component),m(a,[{key:"componentDidUpdate",value:function(){if(this.state.isLarge){var e={newTime:0,oldTime:0,enlarge:!1,relativeX:0,relativeY:0,x1:0,x2:0,y1:0,startX:0,endX:0,wid:0,hei:0,lef:0,to:0,timerScale:null,self:this,isLarge:this.state.isLarge};(0,k.scaleImg)(".ui-table-view-large-wrapper",null,e)}}},{key:"getImg",value:function(){var e=this.props.data,t=this.props.retState,a=t.specKey,n=t.selectArr,r=this.props.promotion.info,i=void 0,o=void 0;return a&&a.some(function(e,t){return o=r.specs[e].values.filter(function(e,a){return e.spec_value_id==n[t]}),i=o[0].image}),i||e.primary_image}},{key:"render",value:function(){var t=this,a=this.props,n=(a.data,a.retState),r=a.promotion,i=a.buyActive,o=r.info.specs,l=(0,k.chooseSpec)(n,o),s=parseFloat(parseFloat(n.groupPrice).toFixed(2));return h.default.createElement("div",null,this.state.isLarge&&h.default.createElement("div",{className:"ui-table-view-large-img",style:{height:e(window).height(),top:e(".action-buy-modal").height()}},h.default.createElement("div",{className:"buy-shady",onClick:function(){t.setState({isLarge:!1})}}),h.default.createElement("div",{className:"ui-table-view-large-wrapper",style:{height:e(window).height()}},h.default.createElement("img",{src:(0,S.addImageSuffix)(this.getImg(),"_l")}))),h.default.createElement("ul",{className:"ui-table-view"},h.default.createElement("li",{className:"ui-table-view-cell"},h.default.createElement("span",{className:"posit-img"},h.default.createElement("img",{className:"ui-media-object ui-pull-left",src:this.getImg()?(0,S.addImageSuffix)(this.getImg(),"_s"):"/src/img/item/no-img.png",width:"80",height:"80",onClick:function(){t.setState({isLarge:!0})}})),h.default.createElement("div",{className:"ui-media-body window-head"},h.default.createElement("div",{className:"price-tag"},h.default.createElement("p",{className:"ui-ellipsis text-price action-update-price"},"¥","buy"===i?n.nowPrice:s)),!(o instanceof Array)&&l.length>0&&h.default.createElement("p",{className:"text-price-sel",style:{display:"block"}}," 已选 ",l," ")))))}}]),a}(),q=function(e){function t(){var e,a,n;N(this,t);for(var o=arguments.length,l=Array(o),s=0;s<o;s++)l[s]=arguments[s];return a=n=C(this,(e=t.__proto__||(0,i.default)(t)).call.apply(e,[this].concat(l))),n.initList=function(){var e=n.props.promotion.info.specs;return(0,r.default)(e).map(function(t,a){return h.default.createElement(k.Specs,p({specs:e[t],index:a},n.props,{key:a}))})},n.getLimit=function(){var e=n.props.data.activity_type,t=n.props.promotion.itemRules;return"groupBuy"==e?h.default.createElement("span",{className:"limit_buy"},"限购",t.user_buy_limit,"件 (已购",t.purchased_quantity,"件)"):null},C(n,a)}return A(t,f.Component),m(t,[{key:"render",value:function(){var e=this.props,t=e.addMinNum,a=e.changeNum,n=e.importNum,r=e.buyActive,i=(this.props.promotion.itemRules,this.props.retState),o=i.num,l=i.storeNum;return h.default.createElement("div",{className:"attr-wrap"},h.default.createElement("div",{className:"standard-area stable-standard cur"},h.default.createElement("div",{className:"standard-info"},this.initList())),h.default.createElement("div",{className:"buy-amount"},h.default.createElement("span",{className:"amount-tit"},"数量："),"buy"===r?h.default.createElement("span",{className:"number-increase-decrease"},h.default.createElement("span",{className:"btn btn-action action-decrease "+(1===o||""===o?"dis-click":""),onTouchTap:1===o||""===o?"":function(){return t(-1)}},"－"),h.default.createElement("input",{type:"number",className:"action-quantity-input",value:o,onBlur:n,onChange:a}),h.default.createElement("span",{className:"btn btn-action action-increase "+(o===l||""===o||0===l?"dis-click":""),onTouchTap:o===l||""===o||0===l?"":function(){return t(1)}},"＋")):h.default.createElement("span",{className:"number-increase-decrease"},h.default.createElement("span",{className:"btn btn-action action-decrease dis-click"},"－"),h.default.createElement("input",{type:"text",className:"action-quantity-input",readOnly:!0,value:"1"}),h.default.createElement("span",{className:"btn btn-action action-increase dis-click"},"＋")),h.default.createElement("span",{className:"store_buy"},"库存",l,"件"),this.getLimit(),h.default.createElement("div",{className:"clearfix"})),h.default.createElement(k.ExpectTax,this.props))}}]),t}(),U=t.BuyModalButton=function(e){function t(){return N(this,t),C(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return A(t,f.Component),m(t,[{key:"render",value:function(){var e=this.props,t=e.onClickBuy,a=(e.purchaseLimit,e.toCartClick),n=e.buyActive,r=(e.singleBuy,e.active),i=e.intervalT,o=e.promotion,l=0,s=0;o.promotion[0]&&(s=o.promotion[0].now_time,l=o.promotion[0].start_time,s=new Date(s.replace(/-/g,"/")).getTime()+parseInt(i),l=new Date(l.replace(/-/g,"/")).getTime());return h.default.createElement("div",{className:"buy-option-btn",style:(0,S.judgeIphoneX)()?{height:"85px"}:{}},s<l&&"groupBuy"===n?h.default.createElement("div",{className:"c-bgfc15",onClick:function(){_.tip.show({msg:"拼团还未开始，请耐心等待哦~"})}},"即将开始"):h.default.createElement("div",null,null,h.default.createElement("div",{className:"btn-tobuy btn-group",style:{width:"100%"},onTouchTap:function(){"groupBuy"===n?t(n):a&&t()}},r?"确定":"groupBuy"===n?"立即开团":"确定")))}}]),t}(),Z=t.Buy=function(e){function t(){var e,a,n;N(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=C(this,(e=t.__proto__||(0,i.default)(t)).call.apply(e,[this].concat(o))),n.active=function(e,t){t&&n.setState({singleBuy:!0}),n.props.UpdateBuyModal({buyModal:!0,buyActive:e})},C(n,a)}return A(t,f.Component),m(t,[{key:"render",value:function(){var e=this,t=this.props.proStatus&&this.props.promotion.promotion[0],a=t.rules,n=t.now_time,r=t.start_time;n=n&&new Date(n.replace(/-/g,"/")).getTime()+parseInt(this.props.intervalT),r=r&&new Date(r.replace(/-/g,"/")).getTime();var i=this.props,o=i.promotion,l=i.data,s=this.props.proStatus&&(0,k.rangePrice)(this.props.promotion,!0);return this.props.mixStatus&&this.props.proStatus?h.default.createElement("div",null,this.props.choose?h.default.createElement(k.LinkChange,{className:"choose-btn",onClick:function(){e.active("groupBuy")}}," "):"SHELVING"===l.status?o.realStore?h.default.createElement("div",{className:"pintuan-btn-group"},n<r?h.default.createElement(k.LinkChange,{className:"fight-group-start"},h.default.createElement("div",{id:"person-price"},"￥",parseFloat((+a.group_price).toFixed(2))),h.default.createElement("div",{onClick:function(){_.tip.show({msg:"拼团还未开始，请耐心等待哦~"})}},"即将开始")):h.default.createElement(k.LinkChange,{className:"fight-group-purchase",onClick:function(){return e.active("groupBuy")}},h.default.createElement("div",{id:"group-price"},"￥",parseFloat((+a.group_price).toFixed(2))),h.default.createElement("div",null,a.group_person,"人团")),h.default.createElement(k.LinkChange,{className:"buy-separately-btn",onClick:function(){return e.active("buy",!0)}},h.default.createElement("div",{id:"person-price"},"￥",s),h.default.createElement("div",null,"加入购物袋"))):h.default.createElement("div",{className:"pintuan-btn-group action-btn-group"},h.default.createElement(k.LinkChange,{type:"button",className:"ui-btn action-disable"},"已售罄")):h.default.createElement("div",{className:"pintuan-btn-group action-btn-group"},h.default.createElement(k.LinkChange,{type:"button",className:"ui-btn action-disable"},"已下架"))):h.default.createElement("div",{className:"action-btn-group c-fr"},h.default.createElement("span",{className:"ui-btn  action-addtocart c-fl incomplete-addtocart"},"加入购物袋"),h.default.createElement("span",{className:"ui-btn  action-buy-now c-fl incomplete-buy-now"},"立即购买"))}}]),t}(),G=(0,k.createBuyAction)({Buy:Z}),j=t.ActiveArea=function(e){function t(){return N(this,t),C(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return A(t,f.Component),m(t,[{key:"render",value:function(){return h.default.createElement("div",{className:"active-area"},h.default.createElement(k.CouponWrap,this.props))}}]),t}(),W=(t.createChooseSpec=function(e){var t=e.Buy;return function(e){function a(){return N(this,a),C(this,(a.__proto__||(0,i.default)(a)).apply(this,arguments))}return A(a,E.PureComponent),m(a,[{key:"render",value:function(){var e=this.props,a=e.data,n=e.promotion,r=e.retState,i=n.info.specs,o=(0,k.chooseSpec)(r,i);return i instanceof Array?null:h.default.createElement("div",{className:"choose-col"},h.default.createElement("div",{className:"choose-spec c-fs13"},h.default.createElement("span",{className:"c-mr15"},o.length>0?"已选择 ":"选择 "),o.length>0&&(0,k.chooseSpec)(r,i),h.default.createElement("i",{className:"icon icon-forward vertical-middle"},h.default.createElement("img",{src:"/src/img/icon/arrow/arrow-right-icon.png"}))),"SHELVING"===a.status&&n.realStore?h.default.createElement(t,p({},this.props,{choose:!0})):null,h.default.createElement("div",{className:"gap bgf4"}))}}]),a}()})({Buy:Z}),H=function(e){function t(e){N(this,t);var a=C(this,(t.__proto__||(0,i.default)(t)).call(this,e));return a.closeModal=function(){a.props.UpdateBuyModal({buyModal:!1})},a.state={singleBuy:!1},a}return A(t,E.PureComponent),m(t,[{key:"render",value:function(){var e=this.props,t=e.location,a=e.data,n=e.mix,r=e.rate,i=e.recommend,o=e.promotion,l=e.cartNum,s=e.isLogin,c=e.pending,u=e.mixStatus,d=e.rateStatus,m=e.recommendStatus,f=e.proStatus,g=e.cartInfoStatus,v=e.retState,_=e.areaData,y=e.UpdateBuyModal,E=e.InitState,w=e.UpdateCartInfo,S=e.buyModal,x=e.buyActive,N=e.intervalT,C=a.item_id,A={itemId:C,location:t,retState:v,data:a,mix:n,promotion:o,mixStatus:u,proStatus:f,buyModal:S,buyActive:x,UpdateBuyModal:y,InitState:E,UpdateCartInfo:w,singleBuy:this.state.singleBuy,closeModal:this.closeModal,areaData:_,intervalT:N},T=f&&o.groupBuy.group_data;return h.default.createElement("div",{"data-page":"item-detail",id:"item-details",ref:"details"},h.default.createElement(b.BarrageStripConnnect,null),h.default.createElement(k.ItemNav,null),u&&f&&h.default.createElement(F,A),h.default.createElement("div",null,h.default.createElement(k.ScrollImageState,{data:a,group_data:T,ref:"scrollImage"}),h.default.createElement(I,{data:a,proStatus:f,promotion:o,intervalT:N}),h.default.createElement(D,{data:a,proStatus:f,promotion:o}),h.default.createElement("div",{className:"gap bgf4"}),f&&h.default.createElement(B,{promotion:o,location:t}),f&&h.default.createElement(j,{promotion:o,shop:a.shop}),h.default.createElement("div",{className:"gap bgf4"}),u&&f&&h.default.createElement(W,A),u&&h.default.createElement(k.SeverArea,{mix:n,data:a,retState:v,areaData:_,isLogin:s,pending:c}),h.default.createElement("div",{className:"gap bgf4"})),h.default.createElement("div",{className:"screen-rate"},d&&h.default.createElement(k.EvaluateArea,{rate:r,itemId:C}),h.default.createElement("div",{className:"gap bgf4"}),m&&h.default.createElement(k.RecommendArea,{recommend:i.data}),m&&h.default.createElement("div",{className:"gap bgf4"}),h.default.createElement(k.ShopArea,{shop:a.shop})),h.default.createElement("div",{className:"screen-detail"},h.default.createElement(k.GoodsDetail,{data:a})),h.default.createElement(G,p({cartNum:l,cartInfoStatus:g},A)))}}]),t}();t.default=H}).call(this,a("OOjC"))},XKGu:function(e,t,a){"use strict";var n=c(a("Zx67")),r=c(a("fZjL")),i=c(a("kiBT")),o=c(a("OvRC")),l=c(a("pFYg")),s=c(a("C4MV"));function c(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.PureComponent=void 0;var u=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,s.default)(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=a("U7vG");function p(e,t){if(e===t)return!0;var a=(0,r.default)(e),n=(0,r.default)(t);return a.length===n.length&&a.every(function(a){return e[a]===t[a]})}t.PureComponent=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,l.default)(t))&&"function"!=typeof t?e:t}(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,l.default)(t)));e.prototype=(0,o.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(i.default?(0,i.default)(e,t):e.__proto__=t)}(t,d.Component),u(t,[{key:"shouldComponentUpdate",value:function(e,t){return!p(this.props,e)||!p(this.state,t)}}]),t}()},XSP4:function(e,t,a){e.exports={mask:"_2qI4xAoOjtDUtWzdkg3nQc","mask-load":"_3MB5waMloANAJkIfLleUZw"}},bhYP:function(e,t,a){e.exports={shady:"igpwK6JRam1rKPGXleStb",animationModal:"_3FpO11SqbtZesZ5VvHQaaE",active:"_2E6xE1QHpxQOoQAKfH8e2",title:"_2chFzR_tMW2iPvPv65nArl",closeBtn:"_27spKdzTKfQwobr0Cw83vH"}},"c/5C":function(e,t,a){},c9vs:function(e,t,a){var n,r;
/*! PhotoSwipe - v4.1.2 - 2017-04-05
* http://photoswipe.com
* Copyright (c) 2017 Dmitry Semenov; */void 0===(r="function"==typeof(n=function(){"use strict";return function(e,t,a,n){var r={features:null,bind:function(e,t,a,n){var r=(n?"remove":"add")+"EventListener";t=t.split(" ");for(var i=0;i<t.length;i++)t[i]&&e[r](t[i],a,!1)},isArray:function(e){return e instanceof Array},createEl:function(e,t){var a=document.createElement(t||"div");return e&&(a.className=e),a},getScrollY:function(){var e=window.pageYOffset;return void 0!==e?e:document.documentElement.scrollTop},unbind:function(e,t,a){r.bind(e,t,a,!0)},removeClass:function(e,t){var a=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(a," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")},addClass:function(e,t){r.hasClass(e,t)||(e.className+=(e.className?" ":"")+t)},hasClass:function(e,t){return e.className&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)},getChildByClass:function(e,t){for(var a=e.firstChild;a;){if(r.hasClass(a,t))return a;a=a.nextSibling}},arraySearch:function(e,t,a){for(var n=e.length;n--;)if(e[n][a]===t)return n;return-1},extend:function(e,t,a){for(var n in t)if(t.hasOwnProperty(n)){if(a&&e.hasOwnProperty(n))continue;e[n]=t[n]}},easing:{sine:{out:function(e){return Math.sin(e*(Math.PI/2))},inOut:function(e){return-(Math.cos(Math.PI*e)-1)/2}},cubic:{out:function(e){return--e*e*e+1}}},detectFeatures:function(){if(r.features)return r.features;var e=r.createEl(),t=e.style,a="",n={};if(n.oldIE=document.all&&!document.addEventListener,n.touch="ontouchstart"in window,window.requestAnimationFrame&&(n.raf=window.requestAnimationFrame,n.caf=window.cancelAnimationFrame),n.pointerEvent=navigator.pointerEnabled||navigator.msPointerEnabled,!n.pointerEvent){var i=navigator.userAgent;if(/iP(hone|od)/.test(navigator.platform)){var o=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);o&&o.length>0&&(o=parseInt(o[1],10))>=1&&o<8&&(n.isOldIOSPhone=!0)}var l=i.match(/Android\s([0-9\.]*)/),s=l?l[1]:0;(s=parseFloat(s))>=1&&(s<4.4&&(n.isOldAndroid=!0),n.androidVersion=s),n.isMobileOpera=/opera mini|opera mobi/i.test(i)}for(var c,u,d=["transform","perspective","animationName"],p=["","webkit","Moz","ms","O"],m=0;m<4;m++){a=p[m];for(var f=0;f<3;f++)c=d[f],u=a+(a?c.charAt(0).toUpperCase()+c.slice(1):c),!n[c]&&u in t&&(n[c]=u);a&&!n.raf&&(a=a.toLowerCase(),n.raf=window[a+"RequestAnimationFrame"],n.raf&&(n.caf=window[a+"CancelAnimationFrame"]||window[a+"CancelRequestAnimationFrame"]))}if(!n.raf){var h=0;n.raf=function(e){var t=(new Date).getTime(),a=Math.max(0,16-(t-h)),n=window.setTimeout(function(){e(t+a)},a);return h=t+a,n},n.caf=function(e){clearTimeout(e)}}return n.svg=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,r.features=n,n}};r.detectFeatures(),r.features.oldIE&&(r.bind=function(e,t,a,n){t=t.split(" ");for(var r,i=(n?"detach":"attach")+"Event",o=function(){a.handleEvent.call(a)},l=0;l<t.length;l++)if(r=t[l])if("object"==typeof a&&a.handleEvent){if(n){if(!a["oldIE"+r])return!1}else a["oldIE"+r]=o;e[i]("on"+r,a["oldIE"+r])}else e[i]("on"+r,a)});var i=this,o={allowPanToNext:!0,spacing:.12,bgOpacity:1,mouseUsed:!1,loop:!0,pinchToClose:!0,closeOnScroll:!0,closeOnVerticalDrag:!0,verticalDragRange:.75,hideAnimationDuration:333,showAnimationDuration:333,showHideOpacity:!1,focus:!0,escKey:!0,arrowKeys:!0,mainScrollEndFriction:.35,panEndFriction:.35,isClickableElement:function(e){return"A"===e.tagName},getDoubleTapZoom:function(e,t){return e?1:t.initialZoomLevel<.7?1:2},maxSpreadZoom:2,modal:!0,scaleMode:"fit"};r.extend(o,n);var l,s,c,u,d,p,m,f,h,g,v,_,y,E,w,b,S,k,x,N,C,A,I,T,M,D,P,B,L,R,F,O,q,U,Z,G,j,W,H,Q,Y,K,X,z,V,J,$,ee,te,ae,ne,re,ie,oe,le,se,ce={x:0,y:0},ue={x:0,y:0},de={x:0,y:0},pe={},me=0,fe={},he={x:0,y:0},ge=0,ve=!0,_e=[],ye={},Ee=!1,we=function(e,t){r.extend(i,t.publicMethods),_e.push(e)},be=function(e){var t=Zt();return e>t-1?e-t:e<0?t+e:e},Se={},ke=function(e,t){return Se[e]||(Se[e]=[]),Se[e].push(t)},xe=function(e){var t=Se[e];if(t){var a=Array.prototype.slice.call(arguments);a.shift();for(var n=0;n<t.length;n++)t[n].apply(i,a)}},Ne=function(){return(new Date).getTime()},Ce=function(e){oe=e,i.bg.style.opacity=e*o.bgOpacity},Ae=function(e,t,a,n,r){(!Ee||r&&r!==i.currItem)&&(n/=r?r.fitRatio:i.currItem.fitRatio),e[A]=_+t+"px, "+a+"px"+y+" scale("+n+")"},Ie=function(e){te&&(e&&(g>i.currItem.fitRatio?Ee||(zt(i.currItem,!1,!0),Ee=!0):Ee&&(zt(i.currItem),Ee=!1)),Ae(te,de.x,de.y,g))},Te=function(e){e.container&&Ae(e.container.style,e.initialPosition.x,e.initialPosition.y,e.initialZoomLevel,e)},Me=function(e,t){t[A]=_+e+"px, 0px"+y},De=function(e,t){if(!o.loop&&t){var a=u+(he.x*me-e)/he.x,n=Math.round(e-ut.x);(a<0&&n>0||a>=Zt()-1&&n<0)&&(e=ut.x+n*o.mainScrollEndFriction)}ut.x=e,Me(e,d)},Pe=function(e,t){var a=dt[e]-fe[e];return ue[e]+ce[e]+a-a*(t/v)},Be=function(e,t){e.x=t.x,e.y=t.y,t.id&&(e.id=t.id)},Le=function(e){e.x=Math.round(e.x),e.y=Math.round(e.y)},Re=null,Fe=function(){Re&&(r.unbind(document,"mousemove",Fe),r.addClass(e,"pswp--has_mouse"),o.mouseUsed=!0,xe("mouseUsed")),Re=setTimeout(function(){Re=null},100)},Oe=function(e,t){var a=Qt(i.currItem,pe,e);return t&&(ee=a),a},qe=function(e){return e||(e=i.currItem),e.initialZoomLevel},Ue=function(e){return e||(e=i.currItem),e.w>0?o.maxSpreadZoom:1},Ze=function(e,t,a,n){return n===i.currItem.initialZoomLevel?(a[e]=i.currItem.initialPosition[e],!0):(a[e]=Pe(e,n),a[e]>t.min[e]?(a[e]=t.min[e],!0):a[e]<t.max[e]&&(a[e]=t.max[e],!0))},Ge=function(e){var t="";o.escKey&&27===e.keyCode?t="close":o.arrowKeys&&(37===e.keyCode?t="prev":39===e.keyCode&&(t="next")),t&&(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey||(e.preventDefault?e.preventDefault():e.returnValue=!1,i[t]()))},je=function(e){e&&(K||Y||ae||j)&&(e.preventDefault(),e.stopPropagation())},We=function(){i.setScrollOffset(0,r.getScrollY())},He={},Qe=0,Ye=function(e){He[e]&&(He[e].raf&&D(He[e].raf),Qe--,delete He[e])},Ke=function(e){He[e]&&Ye(e),He[e]||(Qe++,He[e]={})},Xe=function(){for(var e in He)He.hasOwnProperty(e)&&Ye(e)},ze=function(e,t,a,n,r,i,o){var l,s=Ne();Ke(e);var c=function(){if(He[e]){if((l=Ne()-s)>=n)return Ye(e),i(a),void(o&&o());i((a-t)*r(l/n)+t),He[e].raf=M(c)}};c()},Ve={shout:xe,listen:ke,viewportSize:pe,options:o,isMainScrollAnimating:function(){return ae},getZoomLevel:function(){return g},getCurrentIndex:function(){return u},isDragging:function(){return H},isZooming:function(){return J},setScrollOffset:function(e,t){fe.x=e,R=fe.y=t,xe("updateScrollOffset",fe)},applyZoomPan:function(e,t,a,n){de.x=t,de.y=a,g=e,Ie(n)},init:function(){if(!l&&!s){var a;i.framework=r,i.template=e,i.bg=r.getChildByClass(e,"pswp__bg"),P=e.className,l=!0,F=r.detectFeatures(),M=F.raf,D=F.caf,A=F.transform,L=F.oldIE,i.scrollWrap=r.getChildByClass(e,"pswp__scroll-wrap"),i.container=r.getChildByClass(i.scrollWrap,"pswp__container"),d=i.container.style,i.itemHolders=b=[{el:i.container.children[0],wrap:0,index:-1},{el:i.container.children[1],wrap:0,index:-1},{el:i.container.children[2],wrap:0,index:-1}],b[0].el.style.display=b[2].el.style.display="none",function(){if(A){var t=F.perspective&&!T;return _="translate"+(t?"3d(":"("),void(y=F.perspective?", 0px)":")")}A="left",r.addClass(e,"pswp--ie"),Me=function(e,t){t.left=e+"px"},Te=function(e){var t=e.fitRatio>1?1:e.fitRatio,a=e.container.style,n=t*e.w,r=t*e.h;a.width=n+"px",a.height=r+"px",a.left=e.initialPosition.x+"px",a.top=e.initialPosition.y+"px"},Ie=function(){if(te){var e=te,t=i.currItem,a=t.fitRatio>1?1:t.fitRatio,n=a*t.w,r=a*t.h;e.width=n+"px",e.height=r+"px",e.left=de.x+"px",e.top=de.y+"px"}}}(),h={resize:i.updateSize,orientationchange:function(){clearTimeout(O),O=setTimeout(function(){pe.x!==i.scrollWrap.clientWidth&&i.updateSize()},500)},scroll:We,keydown:Ge,click:je};var n=F.isOldIOSPhone||F.isOldAndroid||F.isMobileOpera;for(F.animationName&&F.transform&&!n||(o.showAnimationDuration=o.hideAnimationDuration=0),a=0;a<_e.length;a++)i["init"+_e[a]]();if(t){var c=i.ui=new t(i,r);c.init()}xe("firstUpdate"),u=u||o.index||0,(isNaN(u)||u<0||u>=Zt())&&(u=0),i.currItem=Ut(u),(F.isOldIOSPhone||F.isOldAndroid)&&(ve=!1),e.setAttribute("aria-hidden","false"),o.modal&&(ve?e.style.position="fixed":(e.style.position="absolute",e.style.top=r.getScrollY()+"px")),void 0===R&&(xe("initialLayout"),R=B=r.getScrollY());var m="pswp--open ";for(o.mainClass&&(m+=o.mainClass+" "),o.showHideOpacity&&(m+="pswp--animate_opacity "),m+=T?"pswp--touch":"pswp--notouch",m+=F.animationName?" pswp--css_animation":"",m+=F.svg?" pswp--svg":"",r.addClass(e,m),i.updateSize(),p=-1,ge=null,a=0;a<3;a++)Me((a+p)*he.x,b[a].el.style);L||r.bind(i.scrollWrap,f,i),ke("initialZoomInEnd",function(){i.setContent(b[0],u-1),i.setContent(b[2],u+1),b[0].el.style.display=b[2].el.style.display="block",o.focus&&e.focus(),r.bind(document,"keydown",i),F.transform&&r.bind(i.scrollWrap,"click",i),o.mouseUsed||r.bind(document,"mousemove",Fe),r.bind(window,"resize scroll orientationchange",i),xe("bindEvents")}),i.setContent(b[1],u),i.updateCurrItem(),xe("afterInit"),ve||(E=setInterval(function(){Qe||H||J||g!==i.currItem.initialZoomLevel||i.updateSize()},1e3)),r.addClass(e,"pswp--visible")}},close:function(){l&&(l=!1,s=!0,xe("close"),r.unbind(window,"resize scroll orientationchange",i),r.unbind(window,"scroll",h.scroll),r.unbind(document,"keydown",i),r.unbind(document,"mousemove",Fe),F.transform&&r.unbind(i.scrollWrap,"click",i),H&&r.unbind(window,m,i),clearTimeout(O),xe("unbindEvents"),Gt(i.currItem,null,!0,i.destroy))},destroy:function(){xe("destroy"),Rt&&clearTimeout(Rt),e.setAttribute("aria-hidden","true"),e.className=P,E&&clearInterval(E),r.unbind(i.scrollWrap,f,i),r.unbind(window,"scroll",i),ft(),Xe(),Se=null},panTo:function(e,t,a){a||(e>ee.min.x?e=ee.min.x:e<ee.max.x&&(e=ee.max.x),t>ee.min.y?t=ee.min.y:t<ee.max.y&&(t=ee.max.y)),de.x=e,de.y=t,Ie()},handleEvent:function(e){e=e||window.event,h[e.type]&&h[e.type](e)},goTo:function(e){var t=(e=be(e))-u;ge=t,u=e,i.currItem=Ut(u),me-=t,De(he.x*me),Xe(),ae=!1,i.updateCurrItem()},next:function(){i.goTo(u+1)},prev:function(){i.goTo(u-1)},updateCurrZoomItem:function(e){if(e&&xe("beforeChange",0),b[1].el.children.length){var t=b[1].el.children[0];te=r.hasClass(t,"pswp__zoom-wrap")?t.style:null}else te=null;ee=i.currItem.bounds,v=g=i.currItem.initialZoomLevel,de.x=ee.center.x,de.y=ee.center.y,e&&xe("afterChange")},invalidateCurrItems:function(){w=!0;for(var e=0;e<3;e++)b[e].item&&(b[e].item.needsUpdate=!0)},updateCurrItem:function(e){if(0!==ge){var t,a=Math.abs(ge);if(!(e&&a<2)){i.currItem=Ut(u),Ee=!1,xe("beforeChange",ge),a>=3&&(p+=ge+(ge>0?-3:3),a=3);for(var n=0;n<a;n++)ge>0?(t=b.shift(),b[2]=t,Me((++p+2)*he.x,t.el.style),i.setContent(t,u-a+n+1+1)):(t=b.pop(),b.unshift(t),Me(--p*he.x,t.el.style),i.setContent(t,u+a-n-1-1));if(te&&1===Math.abs(ge)){var r=Ut(S);r.initialZoomLevel!==g&&(Qt(r,pe),zt(r),Te(r))}ge=0,i.updateCurrZoomItem(),S=u,xe("afterChange")}}},updateSize:function(t){if(!ve&&o.modal){var a=r.getScrollY();if(R!==a&&(e.style.top=a+"px",R=a),!t&&ye.x===window.innerWidth&&ye.y===window.innerHeight)return;ye.x=window.innerWidth,ye.y=window.innerHeight,e.style.height=ye.y+"px"}if(pe.x=i.scrollWrap.clientWidth,pe.y=i.scrollWrap.clientHeight,We(),he.x=pe.x+Math.round(pe.x*o.spacing),he.y=pe.y,De(he.x*me),xe("beforeResize"),void 0!==p){for(var n,l,s,c=0;c<3;c++)n=b[c],Me((c+p)*he.x,n.el.style),s=u+c-1,o.loop&&Zt()>2&&(s=be(s)),(l=Ut(s))&&(w||l.needsUpdate||!l.bounds)?(i.cleanSlide(l),i.setContent(n,s),1===c&&(i.currItem=l,i.updateCurrZoomItem(!0)),l.needsUpdate=!1):-1===n.index&&s>=0&&i.setContent(n,s),l&&l.container&&(Qt(l,pe),zt(l),Te(l));w=!1}v=g=i.currItem.initialZoomLevel,(ee=i.currItem.bounds)&&(de.x=ee.center.x,de.y=ee.center.y,Ie(!0)),xe("resize")},zoomTo:function(e,t,a,n,i){t&&(v=g,dt.x=Math.abs(t.x)-de.x,dt.y=Math.abs(t.y)-de.y,Be(ue,de));var o=Oe(e,!1),l={};Ze("x",o,l,e),Ze("y",o,l,e);var s=g,c={x:de.x,y:de.y};Le(l);var u=function(t){1===t?(g=e,de.x=l.x,de.y=l.y):(g=(e-s)*t+s,de.x=(l.x-c.x)*t+c.x,de.y=(l.y-c.y)*t+c.y),i&&i(t),Ie(1===t)};a?ze("customZoomTo",0,1,a,n||r.easing.sine.inOut,u):u(1)}},Je={},$e={},et={},tt={},at={},nt=[],rt={},it=[],ot={},lt=0,st={x:0,y:0},ct=0,ut={x:0,y:0},dt={x:0,y:0},pt={x:0,y:0},mt=function(e,t){return ot.x=Math.abs(e.x-t.x),ot.y=Math.abs(e.y-t.y),Math.sqrt(ot.x*ot.x+ot.y*ot.y)},ft=function(){X&&(D(X),X=null)},ht=function(){H&&(X=M(ht),It())},gt=function(e,t){return!(!e||e===document)&&!(e.getAttribute("class")&&e.getAttribute("class").indexOf("pswp__scroll-wrap")>-1)&&(t(e)?e:gt(e.parentNode,t))},vt={},_t=function(e,t){return vt.prevent=!gt(e.target,o.isClickableElement),xe("preventDragEvent",e,t,vt),vt.prevent},yt=function(e,t){return t.x=e.pageX,t.y=e.pageY,t.id=e.identifier,t},Et=function(e,t,a){a.x=.5*(e.x+t.x),a.y=.5*(e.y+t.y)},wt=function(){var e=de.y-i.currItem.initialPosition.y;return 1-Math.abs(e/(pe.y/2))},bt={},St={},kt=[],xt=function(e){for(;kt.length>0;)kt.pop();return I?(se=0,nt.forEach(function(e){0===se?kt[0]=e:1===se&&(kt[1]=e),se++})):e.type.indexOf("touch")>-1?e.touches&&e.touches.length>0&&(kt[0]=yt(e.touches[0],bt),e.touches.length>1&&(kt[1]=yt(e.touches[1],St))):(bt.x=e.pageX,bt.y=e.pageY,bt.id="",kt[0]=bt),kt},Nt=function(e,t){var a,n,r,l,s=de[e]+t[e],c=t[e]>0,u=ut.x+t.x,d=ut.x-rt.x;if(a=s>ee.min[e]||s<ee.max[e]?o.panEndFriction:1,s=de[e]+t[e]*a,(o.allowPanToNext||g===i.currItem.initialZoomLevel)&&(te?"h"!==ne||"x"!==e||Y||(c?(s>ee.min[e]&&(a=o.panEndFriction,ee.min[e],n=ee.min[e]-ue[e]),(n<=0||d<0)&&Zt()>1?(l=u,d<0&&u>rt.x&&(l=rt.x)):ee.min.x!==ee.max.x&&(r=s)):(s<ee.max[e]&&(a=o.panEndFriction,ee.max[e],n=ue[e]-ee.max[e]),(n<=0||d>0)&&Zt()>1?(l=u,d>0&&u<rt.x&&(l=rt.x)):ee.min.x!==ee.max.x&&(r=s))):l=u,"x"===e))return void 0!==l&&(De(l,!0),z=l!==rt.x),ee.min.x!==ee.max.x&&(void 0!==r?de.x=r:z||(de.x+=t.x*a)),void 0!==l;ae||z||g>i.currItem.fitRatio&&(de[e]+=t[e]*a)},Ct=function(e){if(!("mousedown"===e.type&&e.button>0))if(qt)e.preventDefault();else if(!W||"mousedown"!==e.type){if(_t(e,!0)&&e.preventDefault(),xe("pointerDown"),I){var t=r.arraySearch(nt,e.pointerId,"id");t<0&&(t=nt.length),nt[t]={x:e.pageX,y:e.pageY,id:e.pointerId}}var a=xt(e),n=a.length;V=null,Xe(),H&&1!==n||(H=re=!0,r.bind(window,m,i),G=le=ie=j=z=K=Q=Y=!1,ne=null,xe("firstTouchStart",a),Be(ue,de),ce.x=ce.y=0,Be(tt,a[0]),Be(at,tt),rt.x=he.x*me,it=[{x:tt.x,y:tt.y}],U=q=Ne(),Oe(g,!0),ft(),ht()),!J&&n>1&&!ae&&!z&&(v=g,Y=!1,J=Q=!0,ce.y=ce.x=0,Be(ue,de),Be(Je,a[0]),Be($e,a[1]),Et(Je,$e,pt),dt.x=Math.abs(pt.x)-de.x,dt.y=Math.abs(pt.y)-de.y,$=mt(Je,$e))}},At=function(e){if(e.preventDefault(),I){var t=r.arraySearch(nt,e.pointerId,"id");if(t>-1){var a=nt[t];a.x=e.pageX,a.y=e.pageY}}if(H){var n=xt(e);if(ne||K||J)V=n;else if(ut.x!==he.x*me)ne="h";else{var i=Math.abs(n[0].x-tt.x)-Math.abs(n[0].y-tt.y);Math.abs(i)>=10&&(ne=i>0?"h":"v",V=n)}}},It=function(){if(V){var e=V.length;if(0!==e)if(Be(Je,V[0]),et.x=Je.x-tt.x,et.y=Je.y-tt.y,J&&e>1){if(tt.x=Je.x,tt.y=Je.y,!et.x&&!et.y&&function(e,t){return e.x===t.x&&e.y===t.y}(V[1],$e))return;Be($e,V[1]),Y||(Y=!0,xe("zoomGestureStarted"));var t=mt(Je,$e),a=Bt(t);a>i.currItem.initialZoomLevel+i.currItem.initialZoomLevel/15&&(le=!0);var n=1,r=qe(),l=Ue();if(a<r)if(o.pinchToClose&&!le&&v<=i.currItem.initialZoomLevel){var s=r-a,c=1-s/(r/1.2);Ce(c),xe("onPinchClose",c),ie=!0}else(n=(r-a)/r)>1&&(n=1),a=r-n*(r/3);else a>l&&((n=(a-l)/(6*r))>1&&(n=1),a=l+n*r);n<0&&(n=0),Et(Je,$e,st),ce.x+=st.x-pt.x,ce.y+=st.y-pt.y,Be(pt,st),de.x=Pe("x",a),de.y=Pe("y",a),G=a>g,g=a,Ie()}else{if(!ne)return;if(re&&(re=!1,Math.abs(et.x)>=10&&(et.x-=V[0].x-at.x),Math.abs(et.y)>=10&&(et.y-=V[0].y-at.y)),tt.x=Je.x,tt.y=Je.y,0===et.x&&0===et.y)return;if("v"===ne&&o.closeOnVerticalDrag&&"fit"===o.scaleMode&&g===i.currItem.initialZoomLevel){ce.y+=et.y,de.y+=et.y;var u=wt();return j=!0,xe("onVerticalDrag",u),Ce(u),void Ie()}!function(e,t,a){if(e-U>50){var n=it.length>2?it.shift():{};n.x=t,n.y=a,it.push(n),U=e}}(Ne(),Je.x,Je.y),K=!0,ee=i.currItem.bounds;var d=Nt("x",et);d||(Nt("y",et),Le(de),Ie())}}},Tt=function(e){if(F.isOldAndroid){if(W&&"mouseup"===e.type)return;e.type.indexOf("touch")>-1&&(clearTimeout(W),W=setTimeout(function(){W=0},600))}var t;if(xe("pointerUp"),_t(e,!1)&&e.preventDefault(),I){var a=r.arraySearch(nt,e.pointerId,"id");a>-1&&(t=nt.splice(a,1)[0],navigator.pointerEnabled?t.type=e.pointerType||"mouse":(t.type={4:"mouse",2:"touch",3:"pen"}[e.pointerType],t.type||(t.type=e.pointerType||"mouse")))}var n,l=xt(e),s=l.length;if("mouseup"===e.type&&(s=0),2===s)return V=null,!0;1===s&&Be(at,l[0]),0!==s||ne||ae||(t||("mouseup"===e.type?t={x:e.pageX,y:e.pageY,type:"mouse"}:e.changedTouches&&e.changedTouches[0]&&(t={x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY,type:"touch"})),xe("touchRelease",e,t));var c=-1;if(0===s&&(H=!1,r.unbind(window,m,i),ft(),J?c=0:-1!==ct&&(c=Ne()-ct)),ct=1===s?Ne():-1,n=-1!==c&&c<150?"zoom":"swipe",J&&s<2&&(J=!1,1===s&&(n="zoomPointerUp"),xe("zoomGestureEnded")),V=null,K||Y||ae||j)if(Xe(),Z||(Z=Mt()),Z.calculateSwipeSpeed("x"),j){var u=wt();if(u<o.verticalDragRange)i.close();else{var d=de.y,p=oe;ze("verticalDrag",0,1,300,r.easing.cubic.out,function(e){de.y=(i.currItem.initialPosition.y-d)*e+d,Ce((1-p)*e+p),Ie()}),xe("onVerticalDrag",1)}}else{if((z||ae)&&0===s){var f=Pt(n,Z);if(f)return;n="zoomPointerUp"}ae||("swipe"===n?!z&&g>i.currItem.fitRatio&&Dt(Z):Lt())}},Mt=function(){var e,t,a={lastFlickOffset:{},lastFlickDist:{},lastFlickSpeed:{},slowDownRatio:{},slowDownRatioReverse:{},speedDecelerationRatio:{},speedDecelerationRatioAbs:{},distanceOffset:{},backAnimDestination:{},backAnimStarted:{},calculateSwipeSpeed:function(n){it.length>1?(e=Ne()-U+50,t=it[it.length-2][n]):(e=Ne()-q,t=at[n]),a.lastFlickOffset[n]=tt[n]-t,a.lastFlickDist[n]=Math.abs(a.lastFlickOffset[n]),a.lastFlickDist[n]>20?a.lastFlickSpeed[n]=a.lastFlickOffset[n]/e:a.lastFlickSpeed[n]=0,Math.abs(a.lastFlickSpeed[n])<.1&&(a.lastFlickSpeed[n]=0),a.slowDownRatio[n]=.95,a.slowDownRatioReverse[n]=1-a.slowDownRatio[n],a.speedDecelerationRatio[n]=1},calculateOverBoundsAnimOffset:function(e,t){a.backAnimStarted[e]||(de[e]>ee.min[e]?a.backAnimDestination[e]=ee.min[e]:de[e]<ee.max[e]&&(a.backAnimDestination[e]=ee.max[e]),void 0!==a.backAnimDestination[e]&&(a.slowDownRatio[e]=.7,a.slowDownRatioReverse[e]=1-a.slowDownRatio[e],a.speedDecelerationRatioAbs[e]<.05&&(a.lastFlickSpeed[e]=0,a.backAnimStarted[e]=!0,ze("bounceZoomPan"+e,de[e],a.backAnimDestination[e],t||300,r.easing.sine.out,function(t){de[e]=t,Ie()}))))},calculateAnimOffset:function(e){a.backAnimStarted[e]||(a.speedDecelerationRatio[e]=a.speedDecelerationRatio[e]*(a.slowDownRatio[e]+a.slowDownRatioReverse[e]-a.slowDownRatioReverse[e]*a.timeDiff/10),a.speedDecelerationRatioAbs[e]=Math.abs(a.lastFlickSpeed[e]*a.speedDecelerationRatio[e]),a.distanceOffset[e]=a.lastFlickSpeed[e]*a.speedDecelerationRatio[e]*a.timeDiff,de[e]+=a.distanceOffset[e])},panAnimLoop:function(){if(He.zoomPan&&(He.zoomPan.raf=M(a.panAnimLoop),a.now=Ne(),a.timeDiff=a.now-a.lastNow,a.lastNow=a.now,a.calculateAnimOffset("x"),a.calculateAnimOffset("y"),Ie(),a.calculateOverBoundsAnimOffset("x"),a.calculateOverBoundsAnimOffset("y"),a.speedDecelerationRatioAbs.x<.05&&a.speedDecelerationRatioAbs.y<.05))return de.x=Math.round(de.x),de.y=Math.round(de.y),Ie(),void Ye("zoomPan")}};return a},Dt=function(e){if(e.calculateSwipeSpeed("y"),ee=i.currItem.bounds,e.backAnimDestination={},e.backAnimStarted={},Math.abs(e.lastFlickSpeed.x)<=.05&&Math.abs(e.lastFlickSpeed.y)<=.05)return e.speedDecelerationRatioAbs.x=e.speedDecelerationRatioAbs.y=0,e.calculateOverBoundsAnimOffset("x"),e.calculateOverBoundsAnimOffset("y"),!0;Ke("zoomPan"),e.lastNow=Ne(),e.panAnimLoop()},Pt=function(e,t){var a,n,l;if(ae||(lt=u),"swipe"===e){var s=tt.x-at.x,c=t.lastFlickDist.x<10;s>30&&(c||t.lastFlickOffset.x>20)?n=-1:s<-30&&(c||t.lastFlickOffset.x<-20)&&(n=1)}n&&((u+=n)<0?(u=o.loop?Zt()-1:0,l=!0):u>=Zt()&&(u=o.loop?0:Zt()-1,l=!0),l&&!o.loop||(ge+=n,me-=n,a=!0));var d,p=he.x*me,m=Math.abs(p-ut.x);return a||p>ut.x==t.lastFlickSpeed.x>0?(d=Math.abs(t.lastFlickSpeed.x)>0?m/Math.abs(t.lastFlickSpeed.x):333,d=Math.min(d,400),d=Math.max(d,250)):d=333,lt===u&&(a=!1),ae=!0,xe("mainScrollAnimStart"),ze("mainScroll",ut.x,p,d,r.easing.cubic.out,De,function(){Xe(),ae=!1,lt=-1,(a||lt!==u)&&i.updateCurrItem(),xe("mainScrollAnimComplete")}),a&&i.updateCurrItem(!0),a},Bt=function(e){return 1/$*e*v},Lt=function(){var e=g,t=qe(),a=Ue();g<t?e=t:g>a&&(e=a);var n,o=oe;return ie&&!G&&!le&&g<t?(i.close(),!0):(ie&&(n=function(e){Ce((1-o)*e+o)}),i.zoomTo(e,0,200,r.easing.cubic.out,n),!0)};we("Gestures",{publicMethods:{initGestures:function(){var e=function(e,t,a,n,r){k=e+t,x=e+a,N=e+n,C=r?e+r:""};(I=F.pointerEvent)&&F.touch&&(F.touch=!1),I?navigator.pointerEnabled?e("pointer","down","move","up","cancel"):e("MSPointer","Down","Move","Up","Cancel"):F.touch?(e("touch","start","move","end","cancel"),T=!0):e("mouse","down","move","up"),m=x+" "+N+" "+C,f=k,I&&!T&&(T=navigator.maxTouchPoints>1||navigator.msMaxTouchPoints>1),i.likelyTouchDevice=T,h[k]=Ct,h[x]=At,h[N]=Tt,C&&(h[C]=h[N]),F.touch&&(f+=" mousedown",m+=" mousemove mouseup",h.mousedown=h[k],h.mousemove=h[x],h.mouseup=h[N]),T||(o.allowPanToNext=!1)}}});var Rt,Ft,Ot,qt,Ut,Zt,Gt=function(t,a,n,l){var s;Rt&&clearTimeout(Rt),qt=!0,Ot=!0,t.initialLayout?(s=t.initialLayout,t.initialLayout=null):s=o.getThumbBoundsFn&&o.getThumbBoundsFn(u);var d,p,m=n?o.hideAnimationDuration:o.showAnimationDuration,f=function(){Ye("initialZoom"),n?(i.template.removeAttribute("style"),i.bg.removeAttribute("style")):(Ce(1),a&&(a.style.display="block"),r.addClass(e,"pswp--animated-in"),xe("initialZoom"+(n?"OutEnd":"InEnd"))),l&&l(),qt=!1};if(!m||!s||void 0===s.x)return xe("initialZoom"+(n?"Out":"In")),g=t.initialZoomLevel,Be(de,t.initialPosition),Ie(),e.style.opacity=n?0:1,Ce(1),void(m?setTimeout(function(){f()},m):f());d=c,p=!i.currItem.src||i.currItem.loadError||o.showHideOpacity,t.miniImg&&(t.miniImg.style.webkitBackfaceVisibility="hidden"),n||(g=s.w/t.w,de.x=s.x,de.y=s.y-B,i[p?"template":"bg"].style.opacity=.001,Ie()),Ke("initialZoom"),n&&!d&&r.removeClass(e,"pswp--animated-in"),p&&(n?r[(d?"remove":"add")+"Class"](e,"pswp--animate_opacity"):setTimeout(function(){r.addClass(e,"pswp--animate_opacity")},30)),Rt=setTimeout(function(){if(xe("initialZoom"+(n?"Out":"In")),n){var a=s.w/t.w,i={x:de.x,y:de.y},o=g,l=oe,c=function(t){1===t?(g=a,de.x=s.x,de.y=s.y-R):(g=(a-o)*t+o,de.x=(s.x-i.x)*t+i.x,de.y=(s.y-R-i.y)*t+i.y),Ie(),p?e.style.opacity=1-t:Ce(l-t*l)};d?ze("initialZoom",0,1,m,r.easing.cubic.out,c,f):(c(1),Rt=setTimeout(f,m+20))}else g=t.initialZoomLevel,Be(de,t.initialPosition),Ie(),Ce(1),p?e.style.opacity=1:Ce(1),Rt=setTimeout(f,m+20)},n?25:90)},jt={},Wt=[],Ht={index:0,errorMsg:'<div class="pswp__error-msg"><a href="%url%" target="_blank">The image</a> could not be loaded.</div>',forceProgressiveLoading:!1,preload:[1,1],getNumItemsFn:function(){return Ft.length}},Qt=function(e,t,a){if(e.src&&!e.loadError){var n=!a;if(n&&(e.vGap||(e.vGap={top:0,bottom:0}),xe("parseVerticalMargin",e)),jt.x=t.x,jt.y=t.y-e.vGap.top-e.vGap.bottom,n){var r=jt.x/e.w,i=jt.y/e.h;e.fitRatio=r<i?r:i;var l=o.scaleMode;"orig"===l?a=1:"fit"===l&&(a=e.fitRatio),a>1&&(a=1),e.initialZoomLevel=a,e.bounds||(e.bounds={center:{x:0,y:0},max:{x:0,y:0},min:{x:0,y:0}})}if(!a)return;return function(e,t,a){var n=e.bounds;n.center.x=Math.round((jt.x-t)/2),n.center.y=Math.round((jt.y-a)/2)+e.vGap.top,n.max.x=t>jt.x?Math.round(jt.x-t):n.center.x,n.max.y=a>jt.y?Math.round(jt.y-a)+e.vGap.top:n.center.y,n.min.x=t>jt.x?0:n.center.x,n.min.y=a>jt.y?e.vGap.top:n.center.y}(e,e.w*a,e.h*a),n&&a===e.initialZoomLevel&&(e.initialPosition=e.bounds.center),e.bounds}return e.w=e.h=0,e.initialZoomLevel=e.fitRatio=1,e.bounds={center:{x:0,y:0},max:{x:0,y:0},min:{x:0,y:0}},e.initialPosition=e.bounds.center,e.bounds},Yt=function(e,t,a,n,r,o){t.loadError||n&&(t.imageAppended=!0,zt(t,n,t===i.currItem&&Ee),a.appendChild(n),o&&setTimeout(function(){t&&t.loaded&&t.placeholder&&(t.placeholder.style.display="none",t.placeholder=null)},500))},Kt=function(e){e.loading=!0,e.loaded=!1;var t=e.img=r.createEl("pswp__img","img"),a=function(){e.loading=!1,e.loaded=!0,e.loadComplete?e.loadComplete(e):e.img=null,t.onload=t.onerror=null,t=null};return t.onload=a,t.onerror=function(){e.loadError=!0,a()},t.src=e.src,t},Xt=function(e,t){if(e.src&&e.loadError&&e.container)return t&&(e.container.innerHTML=""),e.container.innerHTML=o.errorMsg.replace("%url%",e.src),!0},zt=function(e,t,a){if(e.src){t||(t=e.container.lastChild);var n=a?e.w:Math.round(e.w*e.fitRatio),r=a?e.h:Math.round(e.h*e.fitRatio);e.placeholder&&!e.loaded&&(e.placeholder.style.width=n+"px",e.placeholder.style.height=r+"px"),t.style.width=n+"px",t.style.height=r+"px"}},Vt=function(){if(Wt.length){for(var e,t=0;t<Wt.length;t++)(e=Wt[t]).holder.index===e.index&&Yt(e.index,e.item,e.baseDiv,e.img,0,e.clearPlaceholder);Wt=[]}};we("Controller",{publicMethods:{lazyLoadItem:function(e){e=be(e);var t=Ut(e);t&&(!t.loaded&&!t.loading||w)&&(xe("gettingData",e,t),t.src&&Kt(t))},initController:function(){r.extend(o,Ht,!0),i.items=Ft=a,Ut=i.getItemAt,Zt=o.getNumItemsFn,o.loop,Zt()<3&&(o.loop=!1),ke("beforeChange",function(e){var t,a=o.preload,n=null===e||e>=0,r=Math.min(a[0],Zt()),l=Math.min(a[1],Zt());for(t=1;t<=(n?l:r);t++)i.lazyLoadItem(u+t);for(t=1;t<=(n?r:l);t++)i.lazyLoadItem(u-t)}),ke("initialLayout",function(){i.currItem.initialLayout=o.getThumbBoundsFn&&o.getThumbBoundsFn(u)}),ke("mainScrollAnimComplete",Vt),ke("initialZoomInEnd",Vt),ke("destroy",function(){for(var e,t=0;t<Ft.length;t++)(e=Ft[t]).container&&(e.container=null),e.placeholder&&(e.placeholder=null),e.img&&(e.img=null),e.preloader&&(e.preloader=null),e.loadError&&(e.loaded=e.loadError=!1);Wt=null})},getItemAt:function(e){return e>=0&&void 0!==Ft[e]&&Ft[e]},allowProgressiveImg:function(){return o.forceProgressiveLoading||!T||o.mouseUsed||screen.width>1200},setContent:function(e,t){o.loop&&(t=be(t));var a=i.getItemAt(e.index);a&&(a.container=null);var n,s=i.getItemAt(t);if(s){xe("gettingData",t,s),e.index=t,e.item=s;var c=s.container=r.createEl("pswp__zoom-wrap");if(!s.src&&s.html&&(s.html.tagName?c.appendChild(s.html):c.innerHTML=s.html),Xt(s),Qt(s,pe),!s.src||s.loadError||s.loaded)s.src&&!s.loadError&&((n=r.createEl("pswp__img","img")).style.opacity=1,n.src=s.src,zt(s,n),Yt(0,s,c,n));else{if(s.loadComplete=function(a){if(l){if(e&&e.index===t){if(Xt(a,!0))return a.loadComplete=a.img=null,Qt(a,pe),Te(a),void(e.index===u&&i.updateCurrZoomItem());a.imageAppended?!qt&&a.placeholder&&(a.placeholder.style.display="none",a.placeholder=null):F.transform&&(ae||qt)?Wt.push({item:a,baseDiv:c,img:a.img,index:t,holder:e,clearPlaceholder:!0}):Yt(0,a,c,a.img,0,!0)}a.loadComplete=null,a.img=null,xe("imageLoadComplete",t,a)}},r.features.transform){var d="pswp__img pswp__img--placeholder";d+=s.msrc?"":" pswp__img--placeholder--blank";var p=r.createEl(d,s.msrc?"img":"");s.msrc&&(p.src=s.msrc),zt(s,p),c.appendChild(p),s.placeholder=p}s.loading||Kt(s),i.allowProgressiveImg()&&(!Ot&&F.transform?Wt.push({item:s,baseDiv:c,img:s.img,index:t,holder:e}):Yt(0,s,c,s.img,0,!0))}Ot||t!==u?Te(s):(te=c.style,Gt(s,n||s.img)),e.el.innerHTML="",e.el.appendChild(c)}else e.el.innerHTML=""},cleanSlide:function(e){e.img&&(e.img.onload=e.img.onerror=null),e.loaded=e.loading=e.img=e.imageAppended=!1}}});var Jt,$t,ea={},ta=function(e,t,a){var n=document.createEvent("CustomEvent"),r={origEvent:e,target:e.target,releasePoint:t,pointerType:a||"touch"};n.initCustomEvent("pswpTap",!0,!0,r),e.target.dispatchEvent(n)};we("Tap",{publicMethods:{initTap:function(){ke("firstTouchStart",i.onTapStart),ke("touchRelease",i.onTapRelease),ke("destroy",function(){ea={},Jt=null})},onTapStart:function(e){e.length>1&&(clearTimeout(Jt),Jt=null)},onTapRelease:function(e,t){var a,n;if(t&&!K&&!Q&&!Qe){var i=t;if(Jt&&(clearTimeout(Jt),Jt=null,a=i,n=ea,Math.abs(a.x-n.x)<25&&Math.abs(a.y-n.y)<25))return void xe("doubleTap",i);if("mouse"===t.type)return void ta(e,t,"mouse");var o=e.target.tagName.toUpperCase();if("BUTTON"===o||r.hasClass(e.target,"pswp__single-tap"))return void ta(e,t);Be(ea,i),Jt=setTimeout(function(){ta(e,t),Jt=null},300)}}}}),we("DesktopZoom",{publicMethods:{initDesktopZoom:function(){L||(T?ke("mouseUsed",function(){i.setupDesktopZoom()}):i.setupDesktopZoom(!0))},setupDesktopZoom:function(t){$t={};var a="wheel mousewheel DOMMouseScroll";ke("bindEvents",function(){r.bind(e,a,i.handleMouseWheel)}),ke("unbindEvents",function(){$t&&r.unbind(e,a,i.handleMouseWheel)}),i.mouseZoomedIn=!1;var n,o=function(){i.mouseZoomedIn&&(r.removeClass(e,"pswp--zoomed-in"),i.mouseZoomedIn=!1),g<1?r.addClass(e,"pswp--zoom-allowed"):r.removeClass(e,"pswp--zoom-allowed"),l()},l=function(){n&&(r.removeClass(e,"pswp--dragging"),n=!1)};ke("resize",o),ke("afterChange",o),ke("pointerDown",function(){i.mouseZoomedIn&&(n=!0,r.addClass(e,"pswp--dragging"))}),ke("pointerUp",l),t||o()},handleMouseWheel:function(e){if(g<=i.currItem.fitRatio)return o.modal&&(!o.closeOnScroll||Qe||H?e.preventDefault():A&&Math.abs(e.deltaY)>2&&(c=!0,i.close())),!0;if(e.stopPropagation(),$t.x=0,"deltaX"in e)1===e.deltaMode?($t.x=18*e.deltaX,$t.y=18*e.deltaY):($t.x=e.deltaX,$t.y=e.deltaY);else if("wheelDelta"in e)e.wheelDeltaX&&($t.x=-.16*e.wheelDeltaX),e.wheelDeltaY?$t.y=-.16*e.wheelDeltaY:$t.y=-.16*e.wheelDelta;else{if(!("detail"in e))return;$t.y=e.detail}Oe(g,!0);var t=de.x-$t.x,a=de.y-$t.y;(o.modal||t<=ee.min.x&&t>=ee.max.x&&a<=ee.min.y&&a>=ee.max.y)&&e.preventDefault(),i.panTo(t,a)},toggleDesktopZoom:function(t){t=t||{x:pe.x/2+fe.x,y:pe.y/2+fe.y};var a=o.getDoubleTapZoom(!0,i.currItem),n=g===a;i.mouseZoomedIn=!n,i.zoomTo(n?i.currItem.initialZoomLevel:a,t,333),r[(n?"remove":"add")+"Class"](e,"pswp--zoomed-in")}}});var aa,na,ra,ia,oa,la,sa,ca,ua,da,pa,ma,fa={history:!0,galleryUID:1},ha=function(){return pa.hash.substring(1)},ga=function(){aa&&clearTimeout(aa),ra&&clearTimeout(ra)},va=function(){var e=ha(),t={};if(e.length<5)return t;var a,n=e.split("&");for(a=0;a<n.length;a++)if(n[a]){var r=n[a].split("=");r.length<2||(t[r[0]]=r[1])}if(o.galleryPIDs){var i=t.pid;for(t.pid=0,a=0;a<Ft.length;a++)if(Ft[a].pid===i){t.pid=a;break}}else t.pid=parseInt(t.pid,10)-1;return t.pid<0&&(t.pid=0),t},_a=function(){if(ra&&clearTimeout(ra),Qe||H)ra=setTimeout(_a,500);else{ia?clearTimeout(na):ia=!0;var e=u+1,t=Ut(u);t.hasOwnProperty("pid")&&(e=t.pid);var a=sa+"&gid="+o.galleryUID+"&pid="+e;ca||-1===pa.hash.indexOf(a)&&(da=!0);var n=pa.href.split("#")[0]+"#"+a;ma?"#"+a!==window.location.hash&&history[ca?"replaceState":"pushState"]("",document.title,n):ca?pa.replace(n):pa.hash=a,ca=!0,na=setTimeout(function(){ia=!1},60)}};we("History",{publicMethods:{initHistory:function(){if(r.extend(o,fa,!0),o.history){pa=window.location,da=!1,ua=!1,ca=!1,sa=ha(),ma="pushState"in history,sa.indexOf("gid=")>-1&&(sa=(sa=sa.split("&gid=")[0]).split("?gid=")[0]),ke("afterChange",i.updateURL),ke("unbindEvents",function(){r.unbind(window,"hashchange",i.onHashChange)});var e=function(){la=!0,ua||(da?history.back():sa?pa.hash=sa:ma?history.pushState("",document.title,pa.pathname+pa.search):pa.hash=""),ga()};ke("unbindEvents",function(){c&&e()}),ke("destroy",function(){la||e()}),ke("firstUpdate",function(){u=va().pid});var t=sa.indexOf("pid=");t>-1&&"&"===(sa=sa.substring(0,t)).slice(-1)&&(sa=sa.slice(0,-1)),setTimeout(function(){l&&r.bind(window,"hashchange",i.onHashChange)},40)}},onHashChange:function(){if(ha()===sa)return ua=!0,void i.close();ia||(oa=!0,i.goTo(va().pid),oa=!1)},updateURL:function(){ga(),oa||(ca?aa=setTimeout(_a,800):_a())}}}),r.extend(i,Ve)}})?n.call(t,a,t,e):n)||(e.exports=r)},kjFZ:function(e,t,a){},"m9/l":function(module,exports,__webpack_require__){"use strict";(function($){var _stringify=__webpack_require__("mvHQ"),_stringify2=_interopRequireDefault2(_stringify),_keys=__webpack_require__("fZjL"),_keys2=_interopRequireDefault2(_keys),_getPrototypeOf=__webpack_require__("Zx67"),_getPrototypeOf2=_interopRequireDefault2(_getPrototypeOf),_setPrototypeOf=__webpack_require__("kiBT"),_setPrototypeOf2=_interopRequireDefault2(_setPrototypeOf),_create=__webpack_require__("OvRC"),_create2=_interopRequireDefault2(_create),_typeof2=__webpack_require__("pFYg"),_typeof3=_interopRequireDefault2(_typeof2),_defineProperty=__webpack_require__("C4MV"),_defineProperty2=_interopRequireDefault2(_defineProperty),_assign=__webpack_require__("woOf"),_assign2=_interopRequireDefault2(_assign);function _interopRequireDefault2(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.PriceArea=exports.createChooseSpec=exports.Buy=void 0;var _extends=_assign2.default||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,_defineProperty2.default)(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),_react=__webpack_require__("U7vG"),_react2=_interopRequireDefault(_react),_reactDom=__webpack_require__("O27J"),_reactDom2=_interopRequireDefault(_reactDom),_reactRouter=__webpack_require__("Zfgq"),_reactRedux=__webpack_require__("4n+p"),_actions=__webpack_require__("f2Hk"),_index=__webpack_require__("rsfq"),_index2=__webpack_require__("H+oF"),_modal=__webpack_require__("8x+B"),_tip=__webpack_require__("6quk"),_PureComponent6=__webpack_require__("XKGu"),_axios=__webpack_require__("qAHI"),_axios2=_interopRequireDefault(_axios),_detail=__webpack_require__("JmOZ"),_index3=__webpack_require__("f2t5"),_index4=__webpack_require__("5qLU");__webpack_require__("kjFZ");var _detail2=__webpack_require__("JmOZ");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,_typeof3.default)(t))&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,_typeof3.default)(t)));e.prototype=(0,_create2.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(_setPrototypeOf2.default?(0,_setPrototypeOf2.default)(e,t):e.__proto__=t)}var pageApi={getRandCaptcha:{url:_index4.WXAPI+"/promotion/getRandCaptcha",method:"get"},checkSeckill:{url:_index4.WXAPI+"/promotion/SecKill/check",method:"post"}},createActions=(0,_actions.concatPageAndType)("seckill"),axiosActions=(0,_actions.actionAxios)("seckill"),BuyModalInfo=function(e){function t(){var e,a,n;_classCallCheck(this,t);for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];return a=n=_possibleConstructorReturn(this,(e=t.__proto__||(0,_getPrototypeOf2.default)(t)).call.apply(e,[this].concat(i))),n.initList=function(){var e=n.props.promotion.info.specs;return(0,_keys2.default)(e).map(function(t,a){return _react2.default.createElement(_detail2.Specs,_extends({specs:e[t],index:a},n.props,{key:a}))})},n.getLimit=function(){var e=n.props,t=e.promotion.activity_type,a=e.promotionData;return"SecKill"===t?_react2.default.createElement("span",{className:"limit_buy"},"限购",a[t].rules.user_buy_limit,"件 (已购",a[t].purchased_quantity||0,"件)"):null},_possibleConstructorReturn(n,a)}return _inherits(t,_react.Component),_createClass(t,[{key:"render",value:function(){var e=this.props.retState,t=e.num;e.storeNum;return _react2.default.createElement("div",{className:"attr-wrap"},_react2.default.createElement("div",{className:"standard-area stable-standard cur"},_react2.default.createElement("div",{className:"standard-info"},this.initList())),_react2.default.createElement("div",{className:"buy-amount"},_react2.default.createElement("span",{className:"amount-tit"},"购买数量："),_react2.default.createElement("span",{className:"number-increase-decrease"},_react2.default.createElement("span",{className:"btn btn-action action-decrease dis-click"},"－"),_react2.default.createElement("input",{type:"number",readOnly:!0,className:"action-quantity-input",value:t}),_react2.default.createElement("span",{className:"btn btn-action action-increase dis-click"},"＋")),this.getLimit(),_react2.default.createElement("div",{className:"clearfix"})),_react2.default.createElement(_detail2.ExpectTax,this.props))}}]),t}(),BuyModalButton=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return _inherits(t,_react.Component),_createClass(t,[{key:"render",value:function(){var e=this.props,t=e.onClickBuy,a=(e.purchaseLimit,e.toBuyClick),n=e.isNonPayment,r=e.isLimit,i=e.popTips,o=e.state,l=e.buyActive;return _react2.default.createElement("div",{className:"buy-option-btn",style:(0,_index3.judgeIphoneX)()?{height:"85px"}:{}},null,n?_react2.default.createElement("div",{type:"button",className:"btn-tobuy-disable"},"还有机会"):_react2.default.createElement("div",null,2==o?r()?_react2.default.createElement("div",{className:"btn-tobuy ",onTouchTap:a?function(){t(l)}:""},"确定"):_react2.default.createElement("div",{className:"btn-tobuy-disable"},"确定"):_react2.default.createElement("div",{className:"action-notify",onTouchTap:function(){return i("秒杀还未开始，请耐心等待哦~")}},"即将开始")))}}]),t}(),BuyModal=function(_PureComponent){function BuyModal(props){_classCallCheck(this,BuyModal);var _this3=_possibleConstructorReturn(this,(BuyModal.__proto__||(0,_getPrototypeOf2.default)(BuyModal)).call(this,props));return _this3.changeBusinessPrice=function(){var e=_this3.props.retState,t=e.nowPrice,a=e.nowSkuId,n=e.storeNum,r=e.selectArr,i=e.specKey,o=_this3.props.promotion.info.skus,l=_this3.props.promotion.info.specs,s=(0,_keys2.default)(o),c=void 0;s.map(function(e){0!==o[""+e].store&&(c=e)}),c=c||s[0],t=o[c].price,a=o[c].sku_id,n=o[c].store,r=c.split("_"),i=(0,_keys2.default)(l);var u=_extends({},_this3.props.retState,{nowPrice:t,nowSkuId:a,storeNum:n,selectArr:r,specKey:i});_this3.props.InitState(u)},_this3.purchaseLimit=function(){var e=_this3.props.data.trade_type;if(_this3.props.retState.num>1&&_this3.props.retState.nowSkuId&&(0,_index.PurchaseLimit)(e))return _this3.props.retState.num*_this3.props.retState.nowPrice>2e3},_this3.getActionData=function(e){var t=_this3.props,a=t.retState,n=t.promotion,r=t.areaData,i=[],o=_this3.props.location.query.user_id,l=_this3.props.mix&&_this3.props.mix.addrList;l&&(l.recent_addr.length>0&&l.recent_addr[0].addr_id||l.default_addr&&l.default_addr.addr_id);n.promotion&&n.promotion.map(function(e,t){i.push({promotion_id:e.id,role:"main_good",type:e.type})});var s={subscribe:[{quantity:a.num,cart_id:0,sku_id:a.nowSkuId,item_id:a.itemId,created_at:(new Date).getTime(),extra:{promotion:i,commission_user_id:o}}]};return s=e?{sku_record:{quantity:a.num,price:a.nowPrice,sku_id:a.nowSkuId,item_id:a.itemId},extra:{promotion:i},captcha_data:{geetest_challenge:e.geetest_challenge,geetest_validate:e.geetest_validate,geetest_seccode:e.geetest_seccode}}:_extends({},s,{buyMode:"fast_buy",bizMode:"online",bizAttr:"trmall",address:r.addressData})},_this3.onClickBuy=function(e){var t=_this3.state.captchaObj,a=_this3.checkSpec();a?_tip.tip.show({msg:"请选择"+a}):(_this3.state.captchaFlag&&_this3.loadCaptchas(),t&&t.verify())},_this3.toCart=function(e){var t=_this3.props.itemId,a=!1,n=_this3.getActionData(),r=_this3.getActionData(e);a||_axios2.default.request(_extends({},pageApi.checkSeckill,{data:r})).then(function(){a=!0,sessionStorage.setItem("fast_buy",(0,_stringify2.default)(n)),_reactRouter.browserHistory.push("/orderConfirm?item_id="+t)}).catch(function(e){_tip.tip.show({msg:e.response&&e.response.data.message||"服务器繁忙"})})},_this3.loadCaptchas=function(){var self=_this3;_this3.setState({captchaFlag:!1}),_axios2.default.request(_extends({},pageApi.getRandCaptcha)).then(function(res){var data=eval("("+res.data.data+")");initGeetest({gt:data.gt,challenge:data.challenge,new_captcha:data.new_captcha,offline:!data.success,product:"bind"},self.handlerEmbed),self.setState({captchaFlag:!0})}).catch(function(e){console.log(e),_tip.tip.show({msg:e.response&&e.response.data.message||"服务器繁忙"})})},_this3.handlerEmbed=function(e){var t=_this3;e.onError(function(){_tip.tip.show({msg:"验证错误"})}).onSuccess(function(){var a=e.getValidate();a||_tip.tip.show({msg:"请完成验证"}),$("input[name='mode']").val("fast_buy"),t.toCart(a)}),e&&_this3.setState({captchaObj:e,seckillSure:!0})},_this3.isHasStore=function(e,t,a){return t&&t.some(function(t,n){if(t.ids[e.index]==e.spec){var r=a.slice();return r[e.index]&&delete r[e.index],!!r.every(function(e,n){return a[n]==t.ids[n]})&&t.skus.store>0}return!1})},_this3.specSelect=function(e,t,a){var n,r=_this3.props.retState,i=_this3.props.promotion.info.skus,o=_this3.props.promotion.realStore,l=r.selectArr,s=r.specKey,c=r.nowSku,u=r.storeNum,d=r.newData,p=r.nowSkuId,m=r.nowPrice,f=r.num;(l=l.slice())[t]===e?(delete l[t],delete s[t]):(l[t]=e,s[t]=a),n=l.join("_"),l.length==d[0].ids.length&&i[n]?(c=i[n],p=i[n].sku_id,m=i[n].price,f=f<(u=i[n].store)?f:u):(m=(0,_detail2.rangePrice)(_this3.props.promotion,!0),u=o,p="",c="");var h=_extends({},_this3.props.retState,{nowSku:c,selectArr:l,specKey:s,nowSkuId:p,nowPrice:m,num:f,storeNum:u});_this3.props.InitState(h)},_this3.judgeSingleSku=function(){var e=_this3.props.promotion.info.skus,t=[],a=(0,_keys2.default)(e);return a.map(function(a){0!==e[""+a].store&&t.push(e[""+a])}),1===a.length||1===t.length},_this3.state={toBuyClick:!0,seckillSure:!1,captchaFlag:!0},_this3}return _inherits(BuyModal,_PureComponent),_createClass(BuyModal,[{key:"componentWillMount",value:function(){this.judgeSingleSku()&&this.changeBusinessPrice(),console.log(this.props),this.props.isLogin&&this.state.captchaFlag&&this.loadCaptchas()}},{key:"checkSpec",value:function(){var e=this.props.retState,t=e.specKey,a=e.nowSkuId,n=this.props.promotion.info.specs;return!a&&n[(0,_keys2.default)(n).filter(function(e,a){return+e!==t[a]})[0]].name}},{key:"render",value:function(){var e=_extends({isHasStore:this.isHasStore,onClickBuy:this.onClickBuy,specSelect:this.specSelect,judgeSingleSku:this.judgeSingleSku,purchaseLimit:this.purchaseLimit},this.props,this.state);return _react2.default.createElement(_modal.NewModal,{isOpen:this.props.buyModal,onClose:this.props.closeModal},_react2.default.createElement("div",{className:"action-buy-modal",style:(0,_index3.judgeIphoneX)()?{paddingBottom:"34px"}:{}},_react2.default.createElement(_detail2.BuyModalTitle,e),_react2.default.createElement(BuyModalInfo,e),_react2.default.createElement(BuyModalButton,e)))}}]),BuyModal}(_PureComponent6.PureComponent),Buy=exports.Buy=function(e){function t(){var e,a,n;_classCallCheck(this,t);for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];return a=n=_possibleConstructorReturn(this,(e=t.__proto__||(0,_getPrototypeOf2.default)(t)).call.apply(e,[this].concat(i))),n.active=function(e){n.props.UpdateBuyModal({buyModal:!0,buyActive:e})},n.isNonPayment=function(){var e=n.props.promotion,t=e.activity_type,a=e.realStore;if(n.props.promotion.activity_type){var r=n.props.promotionData[""+t],i=r.activity_sales,o=r.activity_store;if(!a)return i!==o}},n.isLimit=function(){var e=n.props,t=e.promotion.activity_type,a=e.promotionData;return!e.isLogin||(a[t].rules.user_buy_limit>a[t].purchased_quantity||0)},_possibleConstructorReturn(n,a)}return _inherits(t,_react.Component),_createClass(t,[{key:"componentWillReceiveProps",value:function(e){e.mixStatus&&e.proStatus&&this.setState({mixStatus:e.mixStatus,proStatus:e.proStatus})}},{key:"popTips",value:function(e){_tip.tip.show({msg:e})}},{key:"render",value:function(){var e=this;return this.props.mixStatus&&this.props.proStatus?_react2.default.createElement("div",null,this.props.choose?_react2.default.createElement("div",null,_react2.default.createElement(_detail2.LinkChange,{className:"choose-btn",onClick:function(){e.active("chooseSpec")}}," ")):this.props.data.is_charge?null:"SHELVING"===this.props.data.status?this.isNonPayment()?_react2.default.createElement("div",{className:"action-btn-group c-fr"},_react2.default.createElement(_detail2.LinkChange,{type:"button",className:"ui-btn action-btn-seckill-disable"},"还有机会")):this.props.promotion.realStore?_react2.default.createElement("div",{className:"action-btn-group  c-fr seckill-btn"},2==this.props.state?this.isLimit()?_react2.default.createElement("div",null,_react2.default.createElement(_detail2.LinkChange,{className:"ui-btn  action-addtocart  action-btn-seckill-in c-fl",onClick:function(t){e.active("buy")}},"立即秒杀")):_react2.default.createElement(_detail2.LinkChange,{className:"ui-btn  action-addtocart  action-btn-seckill-disable c-fl"},"立即秒杀"):1==this.props.state?_react2.default.createElement(_detail2.LinkChange,{className:"ui-btn  action-notify"},"秒杀结束"):_react2.default.createElement(_detail2.LinkChange,{className:"ui-btn  action-notify",onTouchTap:function(){return e.popTips("秒杀还未开始，请耐心等待哦~")}},"即将开始")):_react2.default.createElement("div",{className:"action-btn-group c-fr"},_react2.default.createElement(_detail2.LinkChange,{type:"button",className:"ui-btn action-btn-seckill-disable"},"已秒完")):_react2.default.createElement("div",{className:"action-btn-group c-fr"},_react2.default.createElement(_detail2.LinkChange,{type:"button",className:"ui-btn action-btn-seckill-disable"},"已下架"))):_react2.default.createElement("div",{className:"action-btn-group c-fr"},_react2.default.createElement("span",{className:"ui-btn  action-buy-now c-fl incomplete-buy-now",style:{width:"100%"}},"立即秒杀"))}}]),t}(),BuyAction=(0,_detail2.createBuyAction)({Buy:Buy}),createChooseSpec=exports.createChooseSpec=function(e){var t=e.Buy;return function(e){function a(){return _classCallCheck(this,a),_possibleConstructorReturn(this,(a.__proto__||(0,_getPrototypeOf2.default)(a)).apply(this,arguments))}return _inherits(a,_PureComponent6.PureComponent),_createClass(a,[{key:"render",value:function(){var e=this.props.promotion.info.specs,a=this.props,n=a.retState,r=a.data,i=a.promotion,o=(0,_detail2.chooseSpec)(n,e);return e instanceof Array?null:_react2.default.createElement("div",{className:"choose-col"},_react2.default.createElement("div",{className:"choose-spec c-fs13"},_react2.default.createElement("span",{className:"c-mr15"},o.length>0?"已选择 ":"选择 "),o.length>0&&(0,_detail2.chooseSpec)(n,e),_react2.default.createElement("i",{className:"icon icon-forward vertical-middle"},_react2.default.createElement("img",{src:"/src/img/icon/arrow/arrow-right-icon.png"}))),"SHELVING"===r.status&&i.realStore?_react2.default.createElement(t,_extends({},this.props,{choose:!0})):null,_react2.default.createElement("div",{className:"gap bgf4"}))}}]),a}()},ChooseSpec=createChooseSpec({Buy:Buy}),PriceArea=exports.PriceArea=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return _inherits(t,_PureComponent6.PureComponent),_createClass(t,[{key:"render",value:function(){var e=this.props,t=e.data,a=e.proStatus,n=e.promotion,r=e.state;return _react2.default.createElement("div",{className:"price-area"},!r&&_react2.default.createElement(_detail2.Price,{item:t,proStatus:a,promotion:n}),_react2.default.createElement(_detail2.GoodsTit,{item:t,promotion:n}),_react2.default.createElement(_detail2.Tag,{item:t}))}}]),t}(),Notice=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).call(this,e));return a.changeTime=function(){var e=a.props.promotion.promotion[0],t=e.now_time,n=e.end_time,r=e.start_time,i=a.state.intervalT;t=new Date(new Date(t.replace(/-/g,"/")).getTime()+parseInt(i)).getTime(),n=new Date(n.replace(/-/g,"/")).getTime(),r=new Date(r.replace(/-/g,"/")).getTime(),t=parseInt(t/1e3),n=parseInt(n/1e3),r=parseInt(r/1e3),a.props.initData({now_time:t,end_time:n,start_time:r})},a.intervalTime=function(){a.timer=setInterval(function(){a.props.observeState()},1e3)},a.state={intervalT:a.props.intervalT},a}return _inherits(t,_PureComponent6.PureComponent),_createClass(t,[{key:"componentDidMount",value:function(){this.changeTime(),this.intervalTime()}},{key:"componentWillReceiveProps",value:function(e){1==e.state&&location.reload(),this.state.intervalT!==e.intervalT&&this.setState({intervalT:e.intervalT},function(){clearInterval(this.timer),this.changeTime(),this.intervalTime()})}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer),this.props.clearData()}},{key:"render",value:function(){var e=this.props,t=e.state,a=e.toend,n=e.data,r=e.proStatus,i=e.promotion,o=e.start_time;return 1==t?null:_react2.default.createElement("div",{className:"detail-seckil-state-area"},_react2.default.createElement("div",{className:"seckil-state-area-l c-fl"},2==t&&_react2.default.createElement(_detail2.Price,{item:n,proStatus:r,promotion:i}),2==t?_react2.default.createElement("span",{className:"in-seckil c-tc c-dpib"},"秒杀中"):_react2.default.createElement("span",{className:"former-seckil c-tc c-dpib"},"秒杀")),t?_react2.default.createElement("div",{className:"seckil-state-area-r-in c-fr"},_react2.default.createElement("div",null,_react2.default.createElement("div",{className:"c-dpb c-tc"},"离结束还剩"),_react2.default.createElement("div",{className:"time-remain c-tc"},_react2.default.createElement("div",{className:"c-dpib"},_react2.default.createElement("font",null,_index3.dateUtil.formatNum(parseInt(a/3600))),":",_react2.default.createElement("font",null,_index3.dateUtil.formatNum(parseInt(a%3600/60))),":",_react2.default.createElement("font",null,_index3.dateUtil.formatNum(parseInt(a%60))))))):_react2.default.createElement("div",{className:"seckil-state-area-r-no c-fr"},"预计",o&&_index3.dateUtil.format(new Date(1e3*o).getTime(),"M月D日H:F:S"),"开始"))}}]),t}(),ActiveArea=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return _inherits(t,_PureComponent6.PureComponent),_createClass(t,[{key:"render",value:function(){return _react2.default.createElement("div",{className:"active-area"},_react2.default.createElement(_detail2.PromotionWrap,this.props))}}]),t}(),Seckill=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).call(this,e));return a.closeModal=function(){a.props.UpdateBuyModal({buyModal:!1})},a.isNonPayment=function(){var e=a.props.promotion,t=e.activity_type,n=e.realStore;if(a.props.promotion.activity_type){var r=a.props.promotionData[""+t],i=r.activity_sales,o=r.activity_store;if(!n)return i!==o}},a.isLimit=function(){var e=a.props,t=e.promotion.activity_type,n=e.promotionData;return!e.isLogin||(n[t].rules.user_buy_limit>n[t].purchased_quantity||0)},a.state={index:0},a}return _inherits(t,_react.Component),_createClass(t,[{key:"popTips",value:function(e){_tip.tip.show({msg:e})}},{key:"render",value:function(){var e=this.props,t=e.location,a=e.data,n=e.mix,r=e.rate,i=e.recommend,o=e.promotion,l=e.cartNum,s=e.isLogin,c=e.pending,u=e.mixStatus,d=e.rateStatus,p=e.recommendStatus,m=e.proStatus,f=e.cartInfoStatus,h=e.retState,g=e.areaData,v=e.UpdateBuyModal,_=e.InitState,y=e.UpdateCartInfo,E=e.buyModal,w=e.buyActive,b=e.promotionData,S=e.intervalT,k=a.item_id,x=this.props,N=x.initData,C=x.observeState,A=x.clearData,I=x.state,T=x.toend,M=x.start_time,D={itemId:k,location:t,retState:h,data:a,mix:n,promotion:o,promotionData:b,mixStatus:u,proStatus:m,UpdateBuyModal:v,InitState:_,UpdateCartInfo:y,buyModal:E,buyActive:w,loadCaptcha:x.loadCaptcha,state:I,areaData:g,isLogin:s},P={promotion:o,initData:N,observeState:C,clearData:A,state:I,toend:T,start_time:M},B=u&&m&&_extends({},D,{isNonPayment:this.isNonPayment(),isLimit:this.isLimit,popTips:this.popTips,closeModal:this.closeModal});return _react2.default.createElement("div",{"data-page":"item-detail",id:"item-details",ref:"details"},_react2.default.createElement(_detail.BarrageStripConnnect,null),_react2.default.createElement(_detail2.ItemNav,null),u&&m&&_react2.default.createElement(BuyModal,B),_react2.default.createElement("div",null,_react2.default.createElement(_detail2.ScrollImageState,{data:a,ref:"scrollImage"}),m&&_react2.default.createElement(Notice,_extends({},P,{data:a,proStatus:m,promotion:o,intervalT:S})),_react2.default.createElement(PriceArea,{data:a,proStatus:m,promotion:o,state:I}),m&&_react2.default.createElement(ActiveArea,{promotion:o,shop:a.shop}),_react2.default.createElement("div",{className:"gap bgf4"}),u&&m&&_react2.default.createElement(ChooseSpec,D),u&&_react2.default.createElement(_detail2.SeverArea,{mix:n,data:a,retState:h,areaData:g,isLogin:s,pending:c}),_react2.default.createElement("div",{className:"gap bgf4"})),_react2.default.createElement("div",{className:"screen-rate"},d&&_react2.default.createElement(_detail2.EvaluateArea,{rate:r,itemId:k}),_react2.default.createElement("div",{className:"gap bgf4"}),p&&_react2.default.createElement(_detail2.RecommendArea,{recommend:i.data}),p&&_react2.default.createElement("div",{className:"gap bgf4"}),_react2.default.createElement(_detail2.ShopArea,{shop:a.shop})),_react2.default.createElement("div",{className:"screen-detail"},_react2.default.createElement(_detail2.GoodsDetail,{data:a})),_react2.default.createElement(BuyAction,_extends({cartNum:l,cartInfoStatus:f},D)))}}]),t}();function seckillState(e){return _extends({},e.seckill)}function seckillDispatch(e){return{clearData:function(){e(createActions("clearData",{}))},initData:function(t){e(createActions("initData",t))},observeState:function(){e(createActions("observeState",{}))}}}exports.default=(0,_reactRedux.connect)(seckillState,seckillDispatch)(Seckill)}).call(this,__webpack_require__("OOjC"))},rgEM:function(e,t){e.exports="data:image/gif;base64,R0lGODlhMAAwAPUAAORGTOyepOzKzPTi5OR2fPTu7OReZPTq7PTW3Pzi5OyKjORSXOyytPzu7PTe3OyGjPTy9ORqbPzm7Oy6vORKVPTS1PTm5Ox6hPTu9Pzq7PTa3Pzi7ORWXOy2vPze5PTO1ORqdOR+hORSVOyutPTW1Ox6fOzGxOR6fPTm7ORudOy2tORibOyanORiZOyipAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQJBQAfACwAAAAAMAAwAAAF/+AnjmQ5QlhzYOIUTNVhznR9ZtKWeFsjKgAAhXNhDGzIGUSS2PCevg8wSF0oNMnk0vPsbjI/qjj4cGSVDZ5zs16DpeMxhwE5n3JPp9cTVVCEcVQKLHZLO1xdiHxhVH+OYg91WiJLbGtqbIsfD3+BgAZYWhKSW3mITlEPnlQGCJSSShk8pBKKbRmSAgEEC51irZQWozRpa7SZPRCwJwMdEb7AHxAHPG8lEJdsx7hJGAy9HK7SB3obyyJ45QmEynYfAw+h02o8Etem5eeFlNSXPITodmRzMswdiXnZ6p0QaGqWwWsJ84nIEJFNlIckZEX08KZWQocYD3rEZw9bQ4shTf+QwzcLAz5jKSGy7NFgY8GYlGqxxKARnzWcEzdm4JmhqFFuQEcQLSrBKMCkUKPaIXqgaFWkUKlaLcpTqNSeXjIU2ENQX8hSp7g0qEmvjVmMJi3lwRC34UWc1PY4HDnwrTu0ae19oDjzbkhylpBxpLRRh98sJhXlgZWu4c2HW8ohEkxpprmzOdv+K8EEX5R2hQpm5rKB84m+OTcUeEypgEBap8wW43G6NJvZ+pTVzHbsC41Kn6XxVdOUUAEcmifnvHxNtU7JiKJcT5v7FRLcieWiQtdmII8EtKsnSjv+g87omqnbMPRRkXbsehBhPQNhd/lM2oWXh0XpHVdZWvfZwpoefJgdWA06JzGYEgTQuUHegvtJJU0DPBHCE4cFlhACACH5BAkFAAIALAAAAAAwADAAAAb/QIFwSCwOIZjGASNUNjAQo3RKPWYkm4Rn0xBKtltJI1otGyGSxAa87gpQ6806TDZX0R6wfpPxxrd/EnV2RBANgIhyW30CWHt5cgkZg3Zof3OYHm5fcZ2QG4KEQmhaeXqmmn5sbJihZmSWip2Km5dgWnGUU2iwX6uQqY22l1xCBQVUEBlbvaidk0IYV8NbTAIHJwq6TWy9smO6EMqcgG4HIQAADFIQxN7QZYa5xifpABwDRo6YCdbiogJ4CbFQwl66B0UgrMK0rZIQbAbTUSBBJM3CNa4ADilQUCIACukUHMH1a0NDQhY4RLQnIp+ADMPkuNFYhMHHmwZHeFkI6aQo/wggVqYjENBWOZpTOgilwAEFhovMkEoZoHIlhQ8NqGWUeoQATnsUGCwbxohrkQBCAQSQlqGtW3hmiXwIQLcuXRNx8+rNy/ZAW79w9fb921YatbJ6xwJbVOARRp8A8TjL0yBrIkCQf85iA4VasLwHFjNsxFNO5le+JksQArP0TK4H5Mj+w6hd6QSnk82ZbHLIvl9bNeLJlGf1kdK9kTaTVa2IxUtu/v10NRyS8ULuRmEpkBlCAVzNeko5FCf68w3cw8m75I3PLizJq3eSkMFagWmiowaUELwQ9dSomLJJgKfoJ10y2gEy2x+1KMjKFrhFRk6ADO70yCP9JZOGUagMSDZhgIFVQh4rsgUDX4mzjCGVJQW2YaEpreR2x2+QMEJOjHuNMk0cNrYSYo4BPVFfNBk8IeMQQQAAIfkECQUAAgAsAAAAADAAMAAABv9AgXBILA4hmMYBI1Q2MBCjdEo9ZiSbhGfTEEq2W0kjWi0bIZLEBrzuClDrzTpMNlfRHrB+k/HGt38SdXZEEA2AiHJbfQJYe3lyCRmDdmh/c5gebl9xnZAbgoRCaFp5eqaafmxsmKFmZJaKnYqbl2BacZRTaLBfq5CpjbaXXKO6Vlu9qJ2TQhhXw1tMAmiuRoe5o1hxY7oQEFesbqR8UhDEvXzHRYbZ1GmAuo6YCdPfou/KgeyrmOuv2vrVIwKPmAdr+LThWiXhyMI/yRKyU9MvC5kMw+S4kUgkQz9TjDj92vBPFB5ioKjZArSRI5EDK5NhqBjRJTuUWxo0iIbQ5rv/kR6efSzns4jHYRmeZVjKtFlRIkqbLp32tKpVjkoPLNXq1GqFAGDDgjWB8SMjqwEAqF2rNkCBR2t62oRAgC1bBjsTxbNqgYNdtRQ+nPsY7GmHv2oXoGg0lORTDCkQAyAgpOywli4ZSAYwYlQ0iz77Sl4wYMi8X3JFFTgh+UGhxiXvCDnA+m+FIgXZjIvNzhUKAhTYur7JKl0B3hAK4CKDoW7i0td0KwR03Fu7S2RQ1O6wa5s+VhKSCikADRib7AQe/OMVEJX7Te5P1cRAdVdAOfhlBZunX1YC3oWI5N4f8D3ySGrdUQQRKgUu415XhBhSEX775YfSGC5ZIl8bXgwIIAmC+Gg4xyIdQgQKgCZBE0dIrUB41ShPiCfAM0+gSEQQACH5BAkFAAQALAAAAAAwADAAAAb/QIJwSCwOIZjGASNUNjAQo3RKPWYkm4Rn0xBKtltJI1otGyGSxAa87hIObE+YbK6i5WvwNuNlr/8SdHVEEA1bf4h7Qhl4jWxjg0dYcXptXn9+bIGRBGhacnqgHm6TmKZzdWRoG6x+raSnsYJUaKpflGCwcaYJbhCzhIwbtqKIGWQYV7FbTJ0Sm1KGf7atXL9nEFd+vmkbfGemw0Krx2aF0+Ol4kWleAnN15G16WBaEkUQu3jAg8ThBUTS7FoDjZMkLafujUNIaZ3BI2oGJiCTIRYrNw+JCMP17cupLfwM3gm34R6EjxczSjnwESSGgSBVgnO1pUGDZQVl0sMEJpk+/286jWw0lSFZhqNIywUlYjTp0WZLo0rNaPTAUatKpVa9+rSivm9SN1bKUKASmJw67xSTYzMRopAPTx4yBWXZKKlwzMb0OBCuvFtrFXqNhVEmS1aIwXyTG2ti2jxrHbbjiZbTSEceFI776VDkTrrsGP7x5deIBQUaduLRfCQctQKlCWBQwQGAgdTOQHUeIq1mOoQbYAODYKEDCADIbeNeBVQKc39+JBQVIiDAiQXJs69Y/gzuvNyiwrt5kL088tvjSvtDnNgSAfLmy6P/G0p3LiHwy1Mo/yD2wZagjKeffg9A1U9viCQmYHzILcCAgZa1Y9+C8T2AW1oSKvKeeQtYOB1VJ8r88Q18FCxwAgMDfIjPE9MR0EEAHQgAYR1BAAAh+QQJBQACACwAAAAAMAAwAAAG/0CBcEgsDiGYxgEjVDYwEKN0Sj1mJJuNZ9MQSrZbSSNaLRshWK3a0xUcwNow2VxFe8D4TcYLX28kc3REEA1baodbewIZd3GOW2OCR1hwjZZtlH5+gJICaHGWd6KYfpVqnGZkn1l9rKSmpoFUaKpflZdepZptELKDjBu1on0ZZBhXulsFQmioRoVqtaxcvWcQV328aYpFEJrSxakN0cyZwUaZjRvLnr51qHZrEt2wW+50wprsuaZazp3lks1jlswewG7TWpHJoCtLm4NEgN3yoOhLKYMQB1lsNc/bLYcZjRy4aA9DP4whj2hS02AcrH8p4+XxUECiH24ph9iEk+FYhv+fQMPlJOIz6E8mQ5MqzejzwE+nQpU2fXqUISycQyXmyVBgpr97B+0Mi9MS0SGwAD1m8QOl4MOcb2Ya3PhtqNixHgZa1fU248i1CRWp7Yc2FShR5PhdhNlJJp68g2BlKTyrnCE4SIekYykEg4XG8DaGOVPXzQkOHfbNKpD47rlncNocOAGgNogOFnz1Yu1Hmp4pq8gUoF27OIcTLDR0RhaqtQTGk8gcKFG8enEGfEINw1itjpDZ1sNjF5Cm1bTXggpQt07B+nhbj/BCn1LgQfvw1cfHfRxq/iwGHOB3HR8JnRcVQA6EcJ943zXXiH+SaPDAAgySd5gcSwkwAAMnLHAUn35wiEFZSAdU0EEAFXx31IhFBAEAIfkECQUAAgAsAAAAADAAMAAABv9AgXBILA4hmEYBI1RmMBCjdEo9ZiSbhMfTEEo8m6ykEa2ajRBJYgMGbzJCFLsNlpTP1fR2zocLsG1hbXZ4UhANbomCb15sfHtZGXeFaY50j11/gY58G4SFAmlaW3SkXI2Bm3ufZmWVi26CmYCWtWCTVGmuX6l7p3+2tRuZELhEEBm3QnqknJJCGFfBYEyhEqxFiI67i2TGxVebxGqMaMLcz60N28tqbsa0ewnVxaDWu6kSRRCpfMaU7frNI+JOmAds9qxpsaVv2cJeG/6BgrCmX5YyGYKFyZSwSDJbW/x8ARmxI5qRmzyFIjnMpBQM/fYgsajM5T6NXNbFRGhTT7D/aDHL2fQY9EmGo0iPSnQZLSnSakOjSp1qIoDVq1YrTB1S4GjXDF8xBABAtizZAFuFFDBlKoMKs2YJLE0I4ZGlBh8owCXLwcLWukExWOCwl2yHrWtN+RNwojAAEFB7kgQjZARcvYalrp3mZ4AIxxxQDAXsK9CdB4X1KpjbCqWvMEQqODaAwCU+W5EFoIZLexnrfShurzIygHDZ3qHkFPgNoQA7a77+jcCMHAKKQcu/HYJVErrQfQ8oVJdT2lO6roAu1UzDcwiGB7WTDyg15xcvtopdsXZ1fZGtWZyEIaAjCfx2TH9BgSFSafix0d4UlZTHFoAN0vFgLtpYxMYsKW2SJU5HPkG0YCmrGNiaevbV58iFJiFDSzkomWdiiw1EU000Nc44RBAAIfkECQUAAgAsAAAAADAAMAAABv9AgXBILA4hmMYBI1Q2MBCjdEo9ZiSbhGfTEEq2W0kjWi0bIZLEBrzuCg5sT5hsrqLla/A242Wv/xJ0dUQQDVt/iHtCGXiNbGODR1hxem1ef35sgZECaFpyeqAebpOYpnN1ZGgbrH6tpKexglQFDxpCd5RgsHGmCW4Qs4QKAAa3nV+giBlkGFexW0zIm1IMANfGuFh/Y8LBV37AaRt8RgMc19ctx6vMZoV/qqUbwg/p6dmdwnbUd2taEoqQuAeAArZjnHBp67WhABFi6Qyme7BvkKdeHgIKGbCAYDoOAxIWgZCFYQIyIzxeo8BApBE4p+SUI6ASAAhpLiUx3BDwADr/lR1yvsS4BcIHiQQXWBA6MlabDjUJVBTprxeGADUDMH0JLYOJAGDDgv2wtYizDGjTZsBZtq1bkWcPoJXr7m3cuWiddX0rgFGevxkKVAJDrWwuZXIaNEiEaGpCkodMQYE2yi2cwUUFfHHq2GIyUWs0ZoDGpewBVqgxlYMc6yRTyKLY0ClFqTDVzY4yEsLIqjMVeYfYsNWsxRQw34T64Q5zxhQ9bQ19QyhQHDiefYa4aSse3Rs8U/JYlTuzDbhzCWuFFHjmKJ422yOVx45Nan6e67g6m0/dypJmRM5t4VokVcWGSX2Y/ZURctvFJAqCoMVWF4HZufLKJam5AolLq4SyJEsfEaKyVYf3kdMHJiK6BcEzf5QzSRgT8oXLE+kJ4MwTDBIRBAAh+QQJBQABACwAAAAAMAAwAAAG/8CAcEgsDg+ViesjLGQwGIhxSq0OB4wShwIAjISSjSexkTSk1rRRo1h0315wwiOuS9Bqq+MB738DYXSCdnh5RBAMHH1+YHUegoNnhkMFCouLfxZ1m4Med5MBBSeXjICOYp0bCZ9qaAejAFyLFJmnqXSFVRCsBwSkXX+BtnUJDUIQuYcZuEIYvn0LBCwazRnCqRjHEqxGDYOusBQRHQPJyNaDG8YBu6oZUxCnG2gWBBwj2WkQGHVou3Mb5hm5RidBPgwWQO3yJ6GThCIQbjEDNYRhKoNEJABM5ynZpH+3Hh7b6GgixYpkUqlCk2FYwHUniSyz9egdIIkCYx5qKK8MO/+aL3UaOUATFwaVJoUe60mnQYNhHZXu7CQIw8xUNqUOuXrqSYavYL96FGo1LNh8WtOqjVn2wFe3GcbqbPv2q1WoWdNehbQhQwG+grhJ3fWoMCqnnDbJpRiPTsBBUaB6gCn1wCNUmKXwVLnYEOHClz0JaXlLnVaiAVMLstl4WILO+lCB7jfkWknBjDdDEl2xdM6TFh/XQSsn1TpkClkRxizykDyGGwrAhlAAoMXLHr3VOa7RsXRzEJ6egt6XSrucy9NJeNLEGubQ6LfJXagNtP3JYO7LnojcSvDUqomxjjDCOVYQbFPtBx9+NwEGGG7+aVRUYQPqZ19cjGmXjmoDAtgpkyQxtbObIBXOdhmEwBFEh02bMYfgR+7VwSJzGK4FUQNWHZQBji8SEQQAOw=="},rsfq:function(e,t,a){"use strict";var n,r=a("woOf"),i=(n=r)&&n.__esModule?n:{default:n};Object.defineProperty(t,"__esModule",{value:!0}),t.createAction=t.PurchaseLimit=t.FilterTradeClass=t.FilterTradeType=t.TradeFade=t.FilterTrade=t.createMSG=void 0;var o=a("f2t5"),l=function(e){return e&&e.__esModule?e:{default:e}}(a("4GUf"));var s=t.createMSG=(0,o.wrap)((0,o.filter)({ACTIONERROR:"请求错误",NOTAREA:"不在配送区域",CARTSUCCESS:"加入购物车成功",SELECTSPEC:"请选择所有规格",MINNUM:"此商品最少购买1件",MAXNUM:"此商品最多只能购买{0}件",STRATEGY:"请先选择分期策略"}),function(e,t){var a=e(t),n=[].concat(Array.prototype.slice.call(arguments));return a.replace(/\{(\d+)\}/g,function(e,t){return n[+t+2]})}),c={Domestic:"国内贸易",Overseas:"海淘",Bonded:"跨境保税",Direct:"海外直邮"};t.FilterTrade=function(e){if("BONDED"==e||"DIRECT"==e)return c[e]},t.TradeFade=function(e){return"DOMESTIC"!==e.trade_type&&0!=e.tax_rate},t.FilterTradeType=function(e){return"OVERSEAS"===e||"DIRECT"===e?"海外直邮":"BONDED"===e?"跨境保税":""},t.FilterTradeClass=function(e){return("BONDED"===e?"blue-label":"yellow-label")+" label"},t.PurchaseLimit=function(e){return"DIRECT"===e||"BONDED"===e},t.createAction=function(e,t){return(0,o.wrap)((0,o.filter)(e),function(e,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e(a);if(!r)return null;var o=n.success,c=n.error;return(0,i.default)({},r,n,t?{error:function(e){l.default.MsgTip({msg:s("ACTIONERROR")}),c&&c(e)},success:function(e){(e.msg||e.message)&&l.default.MsgTip({msg:e.msg||e.message}),o&&o(e)}}:{})})}},"t/Wd":function(e,t){var a;(a=Zepto).fly=function(e,t){var n={version:"1.0.0",autoPlay:!0,vertex_Rtop:20,speed:1.2,start:{},end:{},onEnd:a.noop},r=this,i=a(e);r.init=function(e){this.setOptions(e),this.settings.autoPlay&&this.play()},r.setOptions=function(e){this.settings=a.extend(!0,{},n,e);var t=this.settings,r=t.start,o=t.end;i.css({marginTop:"0px",marginLeft:"0px",position:"fixed"}).appendTo("body"),null!=o.width&&null!=o.height&&a.extend(!0,r,{width:i.width(),height:i.height()});var l=Math.min(r.top,o.top)-Math.abs(r.left-o.left)/3;l<t.vertex_Rtop&&(l=Math.min(t.vertex_Rtop,Math.min(r.top,o.top)));var s=Math.sqrt(Math.pow(r.top-o.top,2)+Math.pow(r.left-o.left,2)),c=Math.ceil(Math.min(Math.max(Math.log(s)/.05-75,30),100)/t.speed),u=r.top==l?0:-Math.sqrt((o.top-l)/(r.top-l)),d=(u*r.left-o.left)/(u-1),p=o.left==d?0:(o.top-l)/Math.pow(o.left-d,2);a.extend(!0,t,{count:-1,steps:c,vertex_left:d,vertex_top:l,curvature:p})},r.play=function(){this.move()},r.move=function(){var e=this.settings,t=e.start,n=e.count,r=e.steps,o=e.end,l=t.left+(o.left-t.left)*n/r,s=0==e.curvature?t.top+(o.top-t.top)*n/r:e.curvature*Math.pow(l-e.vertex_left,2)+e.vertex_top;if(null!=o.width&&null!=o.height){var c=r/2,u=o.width-(o.width-t.width)*Math.cos(c>n?0:(n-c)/(r-c)*Math.PI/2),d=o.height-(o.height-t.height)*Math.cos(c>n?0:(n-c)/(r-c)*Math.PI/2);i.css({width:u+"px",height:d+"px","font-size":Math.min(u,d)+"px"})}i.css({left:l+"px",top:s+"px"}),e.count++;var p=window.requestAnimationFrame(a.proxy(this.move,this));n==r&&(window.cancelAnimationFrame(p),e.onEnd.apply(this))},r.destory=function(){i.remove()},r.init(t)},a.fn.fly=function(e){return this.each(function(){void 0==a(this).data("fly")&&a(this).data("fly",new a.fly(this,e))})}}}]);
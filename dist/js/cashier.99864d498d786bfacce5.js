(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{fpgd:function(e,t,o){"use strict";var n=l(o("Zx67")),r=l(o("kiBT")),i=l(o("OvRC")),a=l(o("pFYg")),u=l(o("C4MV")),s=l(o("woOf"));function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=s.default||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},d=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,u.default)(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),p=o("U7vG"),f=v(p),m=o("Zfgq"),h=o("fw66"),y=v(o("4GUf")),w=o("d2xe"),g=(o("nztU"),v(o("qAHI"))),_=o("5qLU");function v(e){return e&&e.__esModule?e:{default:e}}var b={GroupBuy:{url:_.WXAPI+"/promotion/checkGroupBuy",method:"post"},cashier:{url:_.WXAPI+"/payment/intentions",method:"get"}},I=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,a.default)(t))&&"function"!=typeof t?e:t}(this,(t.__proto__||(0,n.default)(t)).call(this,e));return o.promptClose=function(){o.setState({prompt:{show:!1,msg:""}})},o.cashierFun=function(){g.default.request(c({},b.cashier,{params:{order_no:o.tid}})).then(function(e){var t=e.data.data,n=t.business,r=t.payment_no,i="list"===o.from&&n&&3===n.pay_mode;window.location.replace(_.PAYURL+"/checkstand_wx/#/"+(i?"successByOffline":"loading")+"?payId="+n.pay_id+"&orgId="+n.org_id+"&wechatPlatform=MEDIA_PLATFORM&successUrl="+encodeURIComponent(o.host+"/payResult?tid="+o.tid+"&paymentId="+r)+"&errorUrl="+encodeURIComponent(o.host+"/tradeList/0"))}).catch(function(){y.default.MsgTip({msg:error.response.data.message||"服务器繁忙"}),setTimeout(function(){m.browserHistory.replace("/tradeList/0")},2e3)})},o.state={prompt:{show:!1,msg:""}},o.promotionId=e.location.query.promotionId,o.isGroupBuy="true"===e.location.query.isGroupBuy,o.tid=e.location.query.tid,o.from=e.location.query.from,o.host=window.location.origin,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,a.default)(t)));e.prototype=(0,i.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(r.default?(0,r.default)(e,t):e.__proto__=t)}(t,p.Component),d(t,[{key:"componentWillMount",value:function(){var e=this;console.log(this.isGroupBuy),this.isGroupBuy?this.promotionId?g.default.request(c({},b.GroupBuy,{data:{promotion_id:this.promotionId,object_id:0,order_no:this.tid}})).then(function(t){t.data.data.status&&e.cashierFun()}).catch(function(e){y.default.MsgTip({msg:e.response.data.message}),setTimeout(function(){m.browserHistory.replace("/tradeList/0")},2e3)}):(y.default.MsgTip({msg:"活动已结束"}),setTimeout(function(){m.browserHistory.replace("/tradeList/0")},2e3)):this.cashierFun()}},{key:"render",value:function(){return f.default.createElement("div",null,f.default.createElement(w.LoadingRound,null),f.default.createElement(h.PopupTip,{active:this.state.prompt.show,msg:this.state.prompt.msg,onClose:this.promptClose}))}}]),t}();t.default=I}}]);
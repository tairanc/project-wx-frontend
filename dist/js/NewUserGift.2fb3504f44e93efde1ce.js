(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{"9DMt":function(e,t,n){"use strict";(function(e){var a,r,o=f(n("mvHQ")),l=f(n("Zx67")),i=f(n("kiBT")),s=f(n("OvRC")),u=f(n("pFYg")),c=f(n("C4MV"));function f(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var d=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),(0,c.default)(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),p=n("U7vG"),m=y(p),h=(y(n("O27J")),n("Zfgq")),g=n("d2xe"),w=y(n("4GUf"));function y(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,u.default)(t))&&"function"!=typeof t?e:t}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,u.default)(t)));e.prototype=(0,s.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(i.default?(0,i.default)(e,t):e.__proto__=t)}n("KPyK");var E=function(t){function n(){var t,a,r;v(this,n);for(var i=arguments.length,s=Array(i),u=0;u<i;u++)s[u]=arguments[u];return a=r=_(this,(t=n.__proto__||(0,l.default)(n)).call.apply(t,[this].concat(s))),r.getJSApi=function(t){var n=r;e.ajax({url:"/wxapi/getJSApi?url="+encodeURIComponent(t),type:"GET",dataType:"json",contentType:"application/json;chartset=utf-8",success:function(e){wx.config({debug:!1,appId:e.appId,timestamp:e.timestamp,nonceStr:e.nonceStr,signature:e.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone"]}),n.setState({config:!0}),wx.error(function(e){console.log((0,o.default)(e))})},error:function(e){n.showMsg="绑定域名不正确！",n.setState({showStatus:!0})}})},r.changeShow=function(){r.setState({showRule:!r.state.showRule})},_(r,a)}return b(n,p.Component),d(n,[{key:"componentWillMount",value:function(){this.setState({showRule:!1,update:!1,data:""}),document.title="新人专享大礼包";var t=location.href.split("#")[0];this.getJSApi(t);var n=this;e.ajax({url:"/wxapi/getFreshGift.api?t="+ +new Date,type:"get",success:function(t){if(t.data.deploy.banner){!0===t.status&&n.setState({update:!0,data:t.data}),e("[data-page='new-gift']").css({minHeight:e(window).height()});var a={title:"你的好友邀请你领取泰然城1000元新人专享礼",desc:"泰然城·一站式品质生活综合服务平台，百万用户的安心选择！",link:location.protocol+"//"+location.host+"/newUserGift",imgUrl:location.protocol+"//"+location.host+"/src/img/newUserGift/share.png",type:"",dataUrl:"",success:function(){},cancel:function(){}};wx.ready(function(){wx.onMenuShareTimeline(a),wx.onMenuShareAppMessage(a),wx.onMenuShareQQ(a),wx.onMenuShareQZone(a)})}else h.browserHistory.push("/")},error:function(e){w.default.MsgTip({msg:e.msg?e.msg:"服务器繁忙"})}})}},{key:"render",value:function(){var e=this.state,t=e.showRule,n=e.update,a=e.data;return n?m.default.createElement("section",{"data-page":"new-gift"},m.default.createElement("div",{id:"new-gift"},m.default.createElement("div",{className:"banner"},m.default.createElement("a",{href:a.deploy.wx_head_link?a.deploy.wx_head_link:"javascript:void(0);"},m.default.createElement("img",{src:a.deploy.head_image?a.deploy.head_image:"./src/img/newUserGift/banner.png"})),a.deploy.fresh_rule?m.default.createElement("button",{onClick:this.changeShow},"活动规则"):""),m.default.createElement(N,{image:a.deploy.promotion_image,data:a}),m.default.createElement(x,{data:a.deploy.banner}),t?m.default.createElement(S,{fn:this.changeShow,data:a.deploy.fresh_rule}):"")):m.default.createElement(g.LoadingRound,null)}}]),n}();t.default=E;var S=function(e){function t(){return v(this,t),_(this,(t.__proto__||(0,l.default)(t)).apply(this,arguments))}return b(t,p.Component),d(t,[{key:"render",value:function(){return m.default.createElement("div",{className:"rule-box"},m.default.createElement("div",{className:"rule"},m.default.createElement("h2",{className:"c-fs18 c-tc"},"活 动 规 则"),m.default.createElement("p",{className:"c-fs10"},this.props.data),m.default.createElement("button",{className:"btn c-fs18",onClick:this.props.fn},"知道了"),m.default.createElement("div",{className:"line"},m.default.createElement("div",{className:"close",onClick:this.props.fn}))))}}]),t}(),N=(r=a=function(t){function n(t){v(this,n);var a=_(this,(n.__proto__||(0,l.default)(n)).call(this,t));return a.getCoupon=function(){var t=a.props.data;if(t.isLogin)if(t.coupon.length){if(!a.state.sending){a.setState({sending:!0});var n=a;e.ajax({url:"/wxapi/drawFreshGift.api",type:"POST",success:function(e){w.default.MsgTip({msg:e.msg}),n.setState({sending:!1})},error:function(e){w.default.MsgTip({msg:"服务器繁忙"}),n.setState({sending:!1})}})}}else h.browserHistory.push("/");else h.browserHistory.push("/login?redirect_uri=%2FnewUserGift")},a.state={sending:!1},a}return b(n,p.Component),d(n,[{key:"render",value:function(){var e=this.props,t=e.data,n=e.image,a=t.coupon.map(function(e,t){return m.default.createElement(k,{key:t,data:e,image:n})});return m.default.createElement("div",{className:"shopping"},m.default.createElement("div",{className:"title c-pr"},t.coupon.length?m.default.createElement("p",null,"新人优惠券礼包等你来领！"):""),m.default.createElement("div",{className:"coupon-box c-mb20"},t.coupon.length?m.default.createElement("ul",{className:"coupon"},a):m.default.createElement("img",{style:{width:"60%"},src:"./src/img/newUserGift/no-coupon.png"})),m.default.createElement("div",{className:"get-coupon"},m.default.createElement("div",{className:"btn "+(t.isNew?"":"btn2")},m.default.createElement("button",{className:"c-fs20 c-cfff",onClick:this.getCoupon},t.coupon.length?"一键领取":"先随便逛逛"))))}}]),n}(),a.contextTypes={store:m.default.PropTypes.object,isLogin:m.default.PropTypes.bool},r),k=function(e){function t(){return v(this,t),_(this,(t.__proto__||(0,l.default)(t)).apply(this,arguments))}return b(t,p.Component),d(t,[{key:"render",value:function(){var e=this.props,t=e.data,n=e.image,a=n?{backgroundImage:"url("+n+")"}:{};return m.default.createElement("li",{className:"each-coupon c-tc c-pr",style:a},m.default.createElement("p",{className:"c-fs13",style:{color:"#dc4316"}},"¥ ",m.default.createElement("span",{className:"c-fs35 c-fb"},t.deduct_money)),m.default.createElement("p",{className:"c-fs10 c-c666 require"},"指定商品",t.limit_money?"满"+t.limit_money+"元可用":"无门槛"))}}]),t}(),x=function(e){function t(){return v(this,t),_(this,(t.__proto__||(0,l.default)(t)).apply(this,arguments))}return b(t,p.Component),d(t,[{key:"componentDidMount",value:function(){if(this.props.data.length>1)new Swiper(".swiper-container",{autoplay:2e3,autoplayDisableOnInteraction:!1,loop:!0})}},{key:"render",value:function(){var e=this.props.data.map(function(e,t){return m.default.createElement("li",{key:t,className:"swiper-slide"},m.default.createElement("a",{href:e.wx_banner_link?e.wx_banner_link:"javascript:void(0);"},m.default.createElement("img",{src:e.banner_image})))});return m.default.createElement("div",{className:"banner","data-plugin":"swiper"},m.default.createElement("div",{className:"swiper-container",style:{width:"100%"}},m.default.createElement("ul",{className:"swiper-wrapper"},e)))}}]),t}()}).call(this,n("OOjC"))},KPyK:function(e,t,n){}}]);
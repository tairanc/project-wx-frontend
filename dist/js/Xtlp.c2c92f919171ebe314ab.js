(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{Ycjk:function(e,t,n){},"khv/":function(e,t,n){"use strict";(function(e){var a=c(n("Zx67")),i=c(n("kiBT")),o=c(n("OvRC")),r=c(n("pFYg")),l=c(n("C4MV")),s=c(n("woOf"));function c(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var u,p,d=s.default||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),(0,l.default)(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();t.xtlpState=N,t.xtlpDispatch=T;var m=n("U7vG"),h=b(m),g=n("4n+p"),v=n("f2Hk"),_=b(n("qAHI")),y=n("5qLU"),E=n("l5ln"),w=n("6quk");function b(e){return e&&e.__esModule?e:{default:e}}var k=(0,v.actionAxios)("channel"),x=(0,v.concatPageAndType)("channel"),C={xtlpBanner:{url:y.WXAPI+"/getBanner",method:"get"},xtlpChannel:{url:y.WXAPI+"/getChannel",method:"get"},getCartCount:{url:y.WXAPI+"/cart/count",method:"get"}},I=(p=u=function(t){function n(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,r.default)(t))&&"function"!=typeof t?e:t}(this,(n.__proto__||(0,a.default)(n)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,r.default)(t)));e.prototype=(0,o.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(i.default?(0,i.default)(e,t):e.__proto__=t)}(n,m.Component),f(n,[{key:"componentWillMount",value:function(){this.props.getDiscriminationByChannelType("xtlp")}},{key:"componentDidMount",value:function(){e(window).scrollTop(this.props.disTop)}},{key:"componentWillReceiveProps",value:function(e){this.props.isLogin!==e.isLogin&&this.props.getCartCount()}},{key:"render",value:function(){return h.default.createElement(E.Channels,d({config:{title:"小泰良品",type:"xtlp"}},this.props))}}]),n}(),u.contextTypes={router:h.default.PropTypes.object},p);function N(e,t){return d({},e.channel,e.global)}function T(t,n){return{getPageData:function(){_.default.request(d({},C.xtlpBanner,{params:{display_path:20}})).then(function(e){t(x("initSuccess",{result:e.data}));var n=e.data.data.list.list.length?e.data.data.list.list[0].id:"";n&&t(k("getEachList",d({},C.xtlpChannel,{params:{nav_id:n,page:1}})))}).catch(function(e){console.log(e),w.tip.show({msg:e.response.data.message||"服务器繁忙"})})},saveDistanceTop:function(){t(x("saveTop",{value:e(window).scrollTop()}))},changeReturn:function(e){t(x("changeReturn",{value:e}))},changeGettingList:function(e){t(x("changeGettingList",{value:e}))},getDefaultIndex:function(e){t(x("getDefaultIndex",{value:e}))},getDefaultId:function(e){t(x("getDefaultId",{value:e}))},getEachList:function(e){_.default.request(d({},C.xtlpChannel,{params:{nav_id:e,page:1}})).then(function(e){t(x("getEachListSuccess",{result:e.data}))}).catch(function(e){console.error(e),w.tip.show({msg:e.response.data.message||"服务器繁忙"})})},getCartCount:function(){_.default.request(C.getCartCount).then(function(e){t(x("getCartCountSuccess",{result:e.data}))}).catch(function(e){console.log(e),w.tip.show({msg:e.response.data.message||"服务器繁忙"})})},addEachList:function(e,n){t(x("changeGettingMore",{value:!0})),_.default.request(d({},C.xtlpChannel,{params:{nav_id:e,page:n}})).then(function(e){t(x("addEachListSuccess",{result:e.data}))}).catch(function(e){t(x("changeGettingMore",{value:!1}))})},getDiscriminationByChannelType:function(e){t(x("discrimination",{channelType:e}))}}}t.default=(0,g.connect)(N,T)(I)}).call(this,n("OOjC"))},l5ln:function(e,t,n){"use strict";(function(e){var a=c(n("Zx67")),i=c(n("kiBT")),o=c(n("OvRC")),r=c(n("pFYg")),l=c(n("C4MV")),s=c(n("woOf"));function c(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.TotopAndCart=t.Channels=void 0;var u,p,d,f=s.default||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},m=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),(0,l.default)(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),h=n("U7vG"),g=(d=h)&&d.__esModule?d:{default:d},v=n("Zfgq"),_=n("d2xe"),y=n("f2t5");function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,r.default)(t))&&"function"!=typeof t?e:t}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,r.default)(t)));e.prototype=(0,o.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(i.default?(0,i.default)(e,t):e.__proto__=t)}n("Ycjk");t.Channels=(p=u=function(e){function t(e){return E(this,t),w(this,(t.__proto__||(0,a.default)(t)).call(this,e))}return b(t,h.Component),m(t,[{key:"componentWillMount",value:function(){var e=this.props.config;document.title=e.title?e.title:"",this.props.load&&this.props.getPageData()}},{key:"componentDidMount",value:function(){this.props.config}},{key:"componentWillUnmount",value:function(){this.props.saveDistanceTop(),this.props.changeReturn(!0)}},{key:"render",value:function(){var e=this.props,t=e.banner,n=e.list,a=e.discrimination;return g.default.createElement("div",{"data-page":"channels-modal"},this.props.load?g.default.createElement(_.LoadingRound,null):t.length+n.length>0?g.default.createElement("section",{"data-plugin":"swiper"},this.props.discrimination.inputShowState?g.default.createElement(k,{type:this.props.discrimination.type}):"","top"==a.bannerPosition?this.props.defaultIndex?"":g.default.createElement(x,{data:t}):"",g.default.createElement(C,f({data:n},this.props)),g.default.createElement(P,{countCart:this.props.countCart,discrimination:this.props.discrimination})):g.default.createElement(M,null))}}]),t}(),u.contextTypes={router:g.default.PropTypes.object},p);var k=function(e){function t(){return E(this,t),w(this,(t.__proto__||(0,a.default)(t)).apply(this,arguments))}return b(t,h.Component),m(t,[{key:"jumpSearch",value:function(e){"qyg"==e?v.browserHistory.push("/qygSearch"):v.browserHistory.push("/search")}},{key:"render",value:function(){var e=this.props.type;return g.default.createElement("div",{className:"search-input",onClick:this.jumpSearch.bind(this,e)},g.default.createElement("input",{placeholder:"请输入要搜索的商品"}),g.default.createElement("i",{className:"search-icon"}))}}]),t}(),x=function(e){function t(){return E(this,t),w(this,(t.__proto__||(0,a.default)(t)).apply(this,arguments))}return b(t,h.Component),m(t,[{key:"componentWillMount",value:function(){this.setState({activeIndex:1})}},{key:"componentDidMount",value:function(){if(this.props.data.length>1)new Swiper(".banner",{autoplay:2e3,autoplayDisableOnInteraction:!1,loop:!0,pagination:".swiper-pagination",paginationType:"fraction"})}},{key:"render",value:function(){this.state.activeIndex;var e=this.props.data,t=e.map(function(e,t){return g.default.createElement("div",{className:"swiper-slide",key:t},g.default.createElement("a",{href:e.link},g.default.createElement("img",{src:e.banner_image})))});return g.default.createElement("div",{className:"swiper-container banner"},g.default.createElement("div",{className:"swiper-wrapper"},t),e.length>1?g.default.createElement("div",{className:"swiper-pagination"}):"")}}]),t}(),C=function(t){function n(){return E(this,n),w(this,(n.__proto__||(0,a.default)(n)).apply(this,arguments))}return b(n,h.Component),m(n,[{key:"componentWillMount",value:function(){this.setState({index:this.props.defaultIndex})}},{key:"componentDidMount",value:function(){var t=this.props.discrimination,n=t.inputShowState,a=t.bannerPosition,i=n?e(".search-input").height():0,o="top"==a?e(".banner").height():0;e(".control").css({minHeight:e(window).height()-i,background:"#f4f4f4"}),0===this.state.index?e(".nav1").css({top:o+i}):e(".nav1").css({top:i}),e(".nav1 span").removeClass("active-one").eq(this.props.defaultIndex).addClass("active-one");var r=this,l=new Swiper(".nav1",{height:50,slidesPerView:"auto",initialSlide:r.props.defaultIndex,normalizeSlideIndex:!1,onClick:function(t){0===t.clickedIndex?e(".nav1").css({top:o+i}):e(".nav1").css({top:i}),r.props.changeReturn(!1),s.slideTo(t.clickedIndex),r.setState({index:t.clickedIndex}),e(".nav1 span").removeClass("active-one").eq(t.clickedIndex).addClass("active-one")}}),s=this.listsSwiper=new Swiper(".lists",{observer:!0,initialSlide:r.props.defaultIndex,onSlideChangeStart:function(t){0===t.activeIndex?e(".nav1").css({top:o+i}):e(".nav1").css({top:i});var n=t.activeIndex-2>0?t.activeIndex-2:0;l.slideTo(n);var a=e(".nav1 .nav").eq(t.activeIndex).attr("id");r.props.isReturn||(r.props.getDefaultIndex(t.activeIndex),r.props.getEachList(a),r.props.getDefaultId(a),r.props.changeGettingList(!0),r.setState({index:t.activeIndex})),r.props.changeReturn(!1),e(".nav1 span").removeClass("active-one").eq(t.activeIndex).addClass("active-one")},onSlideChangeEnd:function(e){l.update()}})}},{key:"render",value:function(){var e=this,t=this.props,n=t.data,a=t.defaultIndex,i=t.eachList,o=t.gettingList,r=t.hasMore,l=t.gettingMore,s=t.page,c=t.addEachList,u=t.saveDistanceTop,p=(t.config,t.discrimination),d=t.banner,f=n.map(function(e,t){return g.default.createElement("div",{key:t,id:e.id,className:"swiper-slide nav"},g.default.createElement("span",null,e.nav_name))}),m=n.map(function(t,f){var m=0;return f%5==1?m=1:f%5==2?m=2:f%5==3?m=3:f%5==4&&(m=4),g.default.createElement("div",{key:f,className:"swiper-slide"},"bottom"==p.bannerPosition?a?"":g.default.createElement(x,{data:d}):"",a!==f||o?g.default.createElement(_.LoadingRound,null):g.default.createElement(I,{defaultIndex:a,saveDistanceTop:u,addEachList:c,page:s,hasMore:r,gettingMore:l,channelData:n,data:t,eachList:i,bgType:m,listsSwiper:e.listsSwiper,discrimination:p}))});return n.length?g.default.createElement("div",{className:"control "+(n.length>1?"":"control-no-nav")},g.default.createElement("div",{className:"swiper-container nav1 "+(n.length>1?"":"hidden")},g.default.createElement("div",{className:"swiper-wrapper"},f)),g.default.createElement("div",{className:"swiper-container lists"},g.default.createElement("div",{className:"swiper-wrapper"},m))):g.default.createElement("div",null,"bottom"==p.bannerPosition?g.default.createElement(x,{data:d}):"",g.default.createElement(S,null))}}]),n}(),I=function(t){function n(){return E(this,n),w(this,(n.__proto__||(0,a.default)(n)).apply(this,arguments))}return b(n,h.Component),m(n,[{key:"componentWillUnmount",value:function(){e(window).unbind("scroll.loadmore")}},{key:"componentDidMount",value:function(){var t=this.props.discrimination,n=t.inputShowState,a=t.bannerPosition,i=n?e(".search-input").height():0,o="top"==a?e(".banner").height():0;e(".list").css({minHeight:e(window).height()-40});var r=this.props.addEachList;e(window).scrollTop(0),this.props.saveDistanceTop(),this.props.defaultIndex?e(".nav1").css({top:i,opacity:1}):e(".nav1").css({top:o+i,opacity:1});var l=this;e(window).bind("scroll.loadmore",function(){if(e(this).scrollTop()>e(".list").height()-e(window).height()+o-10&&l.props.hasMore&&!1===l.props.gettingMore){var t=e(".nav1 .active-one").parent().attr("id"),n=l.props.page.current_page+1;r(t,n)}})}},{key:"render",value:function(){var e=this.props,t=e.data,n=e.bgType,a=e.eachList,i=e.hasMore,o=e.gettingMore,r=e.defaultIndex,l=e.page,s=e.listsSwiper,c=e.channelData,u=e.discrimination,p={10:"goods3",20:"goods1",30:"goods2"}[t.style],d=a.map(function(e,t){return g.default.createElement(D,{key:t,data:e,type:p})});return g.default.createElement("div",{className:"list c-clrfix c-pr c-pb40"},g.default.createElement("div",{style:{width:"100%",position:"relative"}},g.default.createElement("img",{className:"listImg",src:t.channel_image&&!t.show_default_img?t.channel_image:["src/img/channels/bg1.png","src/img/channels/bg2.png","src/img/channels/bg3.png","src/img/channels/bg4.png","src/img/channels/bg5.png"][n]}),t.channel_image&&!t.show_default_img?"":g.default.createElement("p",{className:"listName"},t.nav_name)),d,0==u.oneMoreItemType?a.length?g.default.createElement("div",{className:"c-fs13 c-c999 c-tc c-lh40 add c-fl c-lh40 c-pa "+(i&&o?"adding":""),style:{height:"40px",width:"100%",left:"0",bottom:"0"}},i?o?"加载中...":"下拉加载更多":"别拉了，我是有底线的~"):g.default.createElement(T,null):"",1==u.oneMoreItemType?a.length?"":g.default.createElement(T,null):"",1==u.oneMoreItemType?g.default.createElement(N,{activeIndex:r,data:c,page:l,listsSwiper:s,isSending:!0,show:!0}):"")}}]),n}(),N=function(e){function t(){return E(this,t),w(this,(t.__proto__||(0,a.default)(t)).apply(this,arguments))}return b(t,h.Component),m(t,[{key:"render",value:function(){var e=this.props.page,t=e.current_page,n=e.total_page,a=this.props,i=a.data,o=a.activeIndex,r=a.listsSwiper,l=this.props.data.length,s=void 0,c=void 0;return 1===l?s="":o>=l-1?(s=i[0].nav_name,c=0):(s=i[o+1].nav_name,c=o+1),g.default.createElement("div",{className:"add"},this.props.show?t<n?this.props.isSending?g.default.createElement("span",{className:"loading"},"加载中..."):g.default.createElement("span",{style:{height:"30px",lineHeight:"50px"}},"下拉加载更多"):g.default.createElement("span",{className:"go-next",onClick:function(){r.slideTo(c)}},1===l?"别拉了，我是有底线的~":"继续浏览 "+s," ",g.default.createElement("i",{className:"arrow-right-black-icon"}," ")):g.default.createElement("div",null))}}]),t}(),T=function(t){function n(){return E(this,n),w(this,(n.__proto__||(0,a.default)(n)).apply(this,arguments))}return b(n,h.Component),m(n,[{key:"componentDidMount",value:function(){e(".no-goods").css({height:e(".list").height()-e(".listImg").height()})}},{key:"render",value:function(){return g.default.createElement("div",{className:"no-goods"},g.default.createElement("img",{src:"/src/img/logistics/no-goods.png"}))}}]),n}(),S=function(e){function t(){return E(this,t),w(this,(t.__proto__||(0,a.default)(t)).apply(this,arguments))}return b(t,h.Component),m(t,[{key:"render",value:function(){return g.default.createElement("div",{className:"no-goods2"},g.default.createElement("img",{src:"/src/img/logistics/no-goods2.png"}))}}]),t}(),M=function(e){function t(){return E(this,t),w(this,(t.__proto__||(0,a.default)(t)).apply(this,arguments))}return b(t,h.Component),m(t,[{key:"render",value:function(){return g.default.createElement("div",{className:"shop-close"},g.default.createElement("img",{src:"/src/img/logistics/shop-close.png"}))}}]),t}(),D=function(e){function t(){var e,n,i;E(this,t);for(var o=arguments.length,r=Array(o),l=0;l<o;l++)r[l]=arguments[l];return n=i=w(this,(e=t.__proto__||(0,a.default)(t)).call.apply(e,[this].concat(r))),i.formatPrice=function(e,t){var n=(e=parseFloat(e)).toString().split(".");return 1==n.length?e=g.default.createElement("span",null,"¥",g.default.createElement("span",{className:t?"c-fs19":""},n[0])):n.length>1?e=(n[1].length,g.default.createElement("span",null,"¥",g.default.createElement("span",{className:t?"c-fs19":""},n[0]),".",n[1])):void 0},w(i,n)}return b(t,h.Component),m(t,[{key:"getPrice",value:function(e,t){return t?e.is_group?e.group_data.group_price:e.promotion_detail.promotion_price?e.promotion_detail.promotion_price:e.sell_price:e.is_group?e.sell_price:e.market_price}},{key:"getTagByPromotionDetail",value:function(e){var t=[];if(e&&e.length>0)for(var n=0;n<e.length;n++){var a=e[n].promotion_type;"FullMinus"==a||"FullDiscount"==a||"OptionBuy"==a?e[n].name&&e[n].name.split(";")[0]&&t.push(e[n].name.split(";")[0]):e[n].promotion_tag&&t.push(e[n].promotion_tag)}return t.map(function(e,t){return g.default.createElement("li",{key:t,className:"maizeng"},e)})}},{key:"render",value:function(){var e=this.props,t=e.type,n=e.data;return g.default.createElement("div",{className:t},g.default.createElement("div",{className:"goods-img c-pr"},0===n.store?g.default.createElement("img",{id:"sold-out",src:"src/img/channels/soldOut.png"}):"",g.default.createElement(v.Link,{to:"item?item_id="+n.id},g.default.createElement("img",{src:n.primary_image?(0,y.addImageSuffix)(n.primary_image,"_m"):"/src/img/evaluate/goodsbg.png"}))),g.default.createElement("div",{className:"goods-msg"},g.default.createElement("div",{className:"goods2-titles"},g.default.createElement("ul",{className:"label c-clrfix"},n.is_group&&"goods2"===t?g.default.createElement("li",null,"拼团"):n.promotion_detail.promotion_tags&&g.default.createElement("span",{className:"promotion_area"},n.promotion_detail.promotion_tags.join()),""),g.default.createElement(v.Link,{to:"item?item_id="+n.id},g.default.createElement("div",{className:"title"},n.title)),g.default.createElement("div",{className:"title-add"},n.sub_title)),g.default.createElement("div",{className:"price"},g.default.createElement("div",{className:"now c-fs12"},n.is_group?g.default.createElement("i",{className:"group"},n.group_data.group_person,"人团 "):"",this.formatPrice(this.getPrice(n,!0),!0)),g.default.createElement("span",{className:"old"},"goods2"===t?"":n.is_group?"单买":"原价"," ",this.formatPrice(this.getPrice(n,!1),!1)),g.default.createElement(v.Link,{to:"item?item_id="+n.id},g.default.createElement("button",null,"去抢购","goods3"===t?g.default.createElement("i",{className:"arrow-right-white-icon"}):"")))))}}]),t}(),P=t.TotopAndCart=function(t){function n(){return E(this,n),w(this,(n.__proto__||(0,a.default)(n)).apply(this,arguments))}return b(n,h.Component),m(n,[{key:"componentWillUnmount",value:function(){e(window).unbind("scroll.top")}},{key:"componentDidMount",value:function(){var t=this.props.discrimination,n=t.inputShowState,a=t.bannerPosition,i=e(window),o=(i.height(),e(".toTop")),r=n?e(".search-input").height():0,l=void 0;o.on("click",function(){clearInterval(l);var e=i.scrollTop();l=setInterval(function(){e-=10,i.scrollTop(e),e<=0&&clearInterval(l)},1)}),e(window).bind("scroll.top",function(){var t="top"==a?e(".banner").height():0,n=e(this).scrollTop(),i=e(window).scrollTop()-t-r;n>35?o.show():o.hide(),i>=0?e(".nav1").css({top:0}):e(".nav1").css({top:-i})})}},{key:"render",value:function(){var e=this.props.countCart;return g.default.createElement("div",{className:"cart-toTop"},g.default.createElement("ul",null,g.default.createElement(v.Link,{to:"/shopCart"},g.default.createElement("li",{className:"cart"},e?g.default.createElement("span",{className:"cart-count"},e):"")),g.default.createElement("li",{className:"toTop"})))}}]),n}()}).call(this,n("OOjC"))}}]);
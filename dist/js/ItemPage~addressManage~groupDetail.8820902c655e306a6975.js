(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{ZdiO:function(e,t,a){"use strict";(function(e){var s=c(a("mvHQ")),n=c(a("Zx67")),d=c(a("kiBT")),r=c(a("OvRC")),i=c(a("pFYg")),o=c(a("C4MV")),l=c(a("woOf"));function c(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ChooseAddress=t.default=void 0;var u,f,m,p=l.default||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},h=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),(0,o.default)(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}(),v=a("U7vG"),g=N(v),y=(N(a("O27J")),a("Zfgq")),C=a("6quk"),A=a("4n+p"),E=a("d2xe"),k=a("fw66"),_=a("f2Hk"),b=N(a("qAHI")),w=a("5qLU");function N(e){return e&&e.__esModule?e:{default:e}}function I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,i.default)(t))&&"function"!=typeof t?e:t}function S(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,i.default)(t)));e.prototype=(0,r.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(d.default?(0,d.default)(e,t):e.__proto__=t)}a("6RO1");var x={addressList:{url:w.WXAPI+"/user/getAddressList",method:"get"},getAddressDetail:{url:w.WXAPI+"/user/getAddressDetail",method:"get"},setDefaultAddress:{url:w.WXAPI+"/user/setDefaultAddress",method:"get"},removeAddress:{url:w.WXAPI+"/user/removeAddress",method:"get"},modifyAddress:{url:w.WXAPI+"/user/modifyAddress",method:"post"},addAddress:{url:w.WXAPI+"/user/addAddress",method:"post"}},T=void 0,M=e(window).height(),P=(0,_.concatPageAndType)("orderConfirm"),L=(0,A.connect)(null,W)((f=function(e){function t(e){I(this,t);var a=D(this,(t.__proto__||(0,n.default)(t)).call(this,e));m.call(a);var s=e.location.query,d=s.id,r=s.from;s.name;return a.state={addrId:d,update:!1,addressData:[],isAdd:"",editorData:"",from:r},a.showMsg="",a}return S(t,v.Component),h(t,[{key:"componentWillMount",value:function(){var e=this,t=e.state.addrId;t?b.default.request(p({},x.getAddressDetail,{params:{address_id:t}})).then(function(t){var a=t.data;e.handleEditorPage(!1,a.data)}).catch(function(e){console.log(e),C.tip.show({msg:e.response.data.message||"服务器繁忙"})}):this.getAddressList()}},{key:"render",value:function(){var e=this.state,t=e.update,a=e.addressData,s=e.isAdd,n=e.editorData,d=e.addrId,r=e.from,i=(this.props.location.query||"").name;return document.title=r?"2"===r?"添加收货地址":s&&"1"===r?"选择收货地址":"编辑收货地址":"地址管理",t?g.default.createElement("div",{"data-page":"address-manage"},g.default.createElement("section",{id:"address-manage",ref:"address-manage"},("2"===r?s=!1:s)?g.default.createElement("div",null,g.default.createElement(q,{addressData:a,fn:this.handleEditorPage,getList:this.getAddressList,from:r,name:i}),g.default.createElement("button",{className:"add-address",onClick:this.addAddress},"添加收货地址")):g.default.createElement(X,{editorData:n,addrId:d,fn:this.getAddressList,changeFrom:this.changeFrom,from:r,addressData:a}))):g.default.createElement(E.LoadingRound,null)}}]),t}(),m=function(){var t=this;this.getAddressList=function(){var a=t,s=t.props.location,n=s.pathname,d=s.search,r=s.query.name;b.default.request(p({},x.addressList)).then(function(t){var s=t.data;1===s.data.data.length&&"1"===a.state.from&&a.state.goFlag&&a.props.listSelect(s.data.data[0],a.state.from,!1,r),a.setState({update:!0,addressData:s.data,isAdd:!0}),e("#address-manage").css({minHeight:e(window).height()})}).catch(function(e){console.log(e),401!==e.response.status?C.tip.show({msg:e.response.data.message||"服务器繁忙"}):y.browserHistory.replace("/login?redirect_uri="+encodeURIComponent(n+d))})},this.addAddress=function(){var e=t.state.addressData;e.count<e.limitCount?t.setState({isAdd:!1,editorData:""}):C.tip.show({msg:"亲~地址不能超过20条哦！"})},this.handleEditorPage=function(e,a){t.setState({update:!0,isAdd:e,editorData:a})},this.changeFrom=function(){t.setState({from:"1",isAdd:!0,goFlag:!0})}},u=f))||u;t.default=L;var q=function(e){function t(){return I(this,t),D(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return S(t,v.Component),h(t,[{key:"render",value:function(){var e=this.props,t=e.addressData,a=e.fn,s=e.getList,n=e.from,d=e.name,r=t.data.map(function(e,t){return g.default.createElement("div",{key:e.address_id},g.default.createElement(H,{item:e,fn:a,key:t,getList:s,from:n,name:d}))});return t.count?g.default.createElement("div",{className:"goods-address"},g.default.createElement("img",{src:"../src/img/addressAndIdentityInfo/trBgStriae.png"}),r):g.default.createElement("div",{className:"goods-addressImg"},g.default.createElement("img",{src:"../src/img/addressAndIdentityInfo/trGoodsAddress.png"}))}}]),t}(),O=function(e){function t(e){I(this,t);var a=D(this,(t.__proto__||(0,n.default)(t)).call(this,e));return a.delateAddress=function(e){a.setState({showModal:!0})},a.handleDefaultAddress=function(e){e.currentTarget;var t=a.props,s=t.item,n=t.getList;b.default.request(p({},x.setDefaultAddress,{params:{address_id:s.address_id}})).then(function(e){e.data;n()}).catch(function(e){console.log(e),C.tip.show({msg:e.response.data.message||"服务器繁忙"})})},a.editorAddress=function(e){var t=a.props,s=t.item,n=t.fn;e.stopPropagation(),b.default.request(p({},x.getAddressDetail,{params:{address_id:s.address_id}})).then(function(e){var t=e.data;n(!1,t.data)}).catch(function(e){console.log(e),C.tip.show({msg:e.response.data.message||"服务器繁忙"})})},a.closeModal=function(){a.setState({showModal:!1})},a.sureCloseModal=function(){var e=a,t=e.props,s=t.item,n=t.getList;b.default.request(p({},x.removeAddress,{params:{address_id:s.address_id}})).then(function(t){t.data;e.setState({showModal:!1}),n()}).catch(function(e){console.log(e),C.tip.show({msg:e.response.data.message||"服务器繁忙"})})},a.state={showModal:!1,defaultC:!0},a.showMsg="",a}return S(t,v.Component),h(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.item,s=t.from,n=t.listSelect,d=t.name,r=this.state,i=r.showModal,o=r.defaultC;return g.default.createElement("div",null,s?g.default.createElement(F,{data:a,from:s,listSelect:n,editorAddress:this.editorAddress,name:d}):g.default.createElement("div",{className:"wrapper"},g.default.createElement("div",{className:"c-fs14 c-c35 address-info"},g.default.createElement("span",{className:"name"},a.name),g.default.createElement("span",{className:"phone-number"},a.mobile),g.default.createElement("p",{className:"c-mb15 detail-address"},a.detail_address)),g.default.createElement("div",{style:{position:"relative"}},g.default.createElement("div",{className:a.is_default?"ctrl-btn bg1":"ctrl-btn bg2",onClick:function(t){t.stopPropagation(),o&&e.handleDefaultAddress(t)}},g.default.createElement("span",{className:"c-fs12 c-c666 default-address"},"默认地址")),g.default.createElement("span",{className:"btn"},g.default.createElement("button",{onClick:this.editorAddress},"编辑"),g.default.createElement("button",{className:"delate-btn",onClick:function(t){t.stopPropagation(),e.delateAddress(t)}},"删除"))),g.default.createElement(k.PopupModal,{active:i,msg:"确认删除地址？",onClose:this.closeModal,onSure:this.sureCloseModal})))}}]),t}(),F=function(e){function t(){return I(this,t),D(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return S(t,v.Component),h(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.data,s=t.from,n=t.name;return g.default.createElement("div",{className:"one-list"},g.default.createElement("div",{className:"list-info",onClick:function(){e.props.listSelect(a,s,!1,n)}},g.default.createElement("div",{className:"top"},g.default.createElement("span",null,a.name)," ",a.mobile),g.default.createElement("div",{className:"text"},a.is_default?g.default.createElement("span",null,"默认"):""," ",a.detail_address)),g.default.createElement("button",{className:"edit",onClick:this.props.editorAddress},g.default.createElement("i",{className:"edit-icon"}," ")))}}]),t}();function W(e,t){return{listSelect:function(t,a,s,n){"1"!==a&&"2"!==a||(e(P("selectAddress",{data:t,from:"address",name:n})),!s&&y.browserHistory.goBack())}}}var H=(0,A.connect)(null,W)(O),X=function(t){function a(t){I(this,a);var d=D(this,(a.__proto__||(0,n.default)(a)).call(this,t));return d.chooseAddress=function(){d.setState({animalStatus:!0,slideIn:!0})},d.handleDefaultAddress=function(){console.log(d.props),d.setState({isDefaultAddress:!d.state.isDefaultAddress})},d.confirmAnimal=function(e,t,a,s,n,r){a?d.setState({chooseedAddress:e+" "+t+" "+a,provinceId:s,cityId:n,countyId:r}):d.setState({chooseedAddress:e+" "+t,provinceId:s,cityId:n}),d.setState({animalStatus:!1,slideIn:!1})},d.saveNewAddress=function(){var t=d,a=e(".people").val(),n=e(".phone").val(),r=e(".address").val(),i=t.state,o=i.chooseedAddress,l=i.provinceId,c=i.cityId,u=i.countyId,f=i.isDefaultAddress,m=i.isEditor,h=i.address_id,v=(i.rightName,i.rightNumber,i.rightaddress,t.props.addrId),g=o.split(" "),y={};y=u?{province:{code:l,text:g[0]},city:{code:c,text:g[1]},district:{code:u,text:g[2]}}:{province:{code:l,text:g[0]},city:{code:c,text:g[1]}};var A=void 0;A=f?1:0,!/^[\u4E00-\u9FA5]+(·[\u4E00-\u9FA5]+)*$/.test(a)||a.length<2?C.tip.show({msg:"请输入正确的名字"}):/\d{11}/.test(n)?0===o.length?C.tip.show({msg:"请选择所在区域"}):r.length<5||r.length>60?C.tip.show({msg:"详细地址最少5个字，最多不能超多60个字"}):b.default.request(m?p({},x.modifyAddress,{data:{address_id:h,name:a,mobile:n,area:(0,s.default)(y),address:r,is_default:A}}):p({},x.addAddress,{data:{address_id:"",name:a,mobile:n,area:(0,s.default)(y),address:r,is_default:A}})).then(function(e){e.data;v?setTimeout(function(){window.history.go(-1)},1e3):setTimeout(function(){t.props.fn()},1e3),t.props.from&&t.props.changeFrom()}).catch(function(e){console.log(e),C.tip.show({msg:e.response.data.message||"服务器繁忙"})}):C.tip.show({msg:"您输入的手机号有误"})},d.handleEditorData=function(){var t=d.props.editorData,a=t.area,s=a.province,n=a.city,r=a.district;d.setState({address_id:t.address_id,chooseedAddress:s.text+" "+n.text+" "+r.text,isDefaultAddress:t.is_default,provinceId:s.code,cityId:n.code,countyId:r.code,isEditor:!0}),e(".phone").val(t.mobile),e(".address").val(t.address),e(".people").val(t.name)},d.clearCoutryId=function(){d.setState({countyId:""})},d.state={isDefaultAddress:!0,animalStatus:!1,slideIn:!1,chooseedAddress:"",addSucMsg:"",isEditor:!1,rightName:!1,rightNumber:!1,rightaddress:!1},d.showMsg="",d}return S(a,v.Component),h(a,[{key:"componentDidMount",value:function(){var t=this;t.props.editorData&&t.handleEditorData(),e(".shady").click(function(e){t.setState({animalStatus:!1,slideIn:!1})})}},{key:"render",value:function(){var t=this.state,a=t.isDefaultAddress,s=t.animalStatus,n=t.slideIn,d=t.chooseedAddress,r=this.props,i=r.editorData,o=r.addressData;return g.default.createElement("div",{id:"address-editor",ref:"address-editor",style:{overflow:"hidden",position:"relative",height:M}},g.default.createElement("div",{className:"shady",style:{display:n?"block":"none",height:e(window).height()}}),g.default.createElement(R,{animalStatus:s,slideIn:n,confirm:this.confirmAnimal,clearCoutryId:this.clearCoutryId}),g.default.createElement("div",null,g.default.createElement("div",{className:"editor-info c-fs14"},g.default.createElement("span",{className:"title"},"收货人"),g.default.createElement("input",{type:"text",maxLength:"12",className:"people"})),g.default.createElement("div",{className:"editor-info c-fs14"},g.default.createElement("span",{className:"title"},"联系电话"),g.default.createElement("input",{type:"text",className:"phone",maxLength:"11"})),g.default.createElement("div",{className:"editor-info c-fs14",onClick:this.chooseAddress},g.default.createElement("span",{className:"title"},"所在地区"),g.default.createElement("img",{src:"../src/img/addressAndIdentityInfo/trArror.png",className:"chooseImg"}),g.default.createElement("p",{className:"choose-addressA"},d)),g.default.createElement("div",{className:"editor-info c-fs14"},g.default.createElement("textarea",{placeholder:"如街道、小区、楼栋号、单元室等",className:"address"})),i.is_default?"":g.default.createElement("div",{className:"default-choose"},g.default.createElement("img",{src:a?"../src/img/addressAndIdentityInfo/trChoose.png":"../src/img/addressAndIdentityInfo/trUnChoose.png",onClick:!!o.count&&this.handleDefaultAddress}),g.default.createElement("span",{className:"c-fs14 c-c666 c-ml30"},"设为默认地址")),g.default.createElement("button",{className:"address-save",onClick:this.saveNewAddress},"保存")))}}]),a}(),R=t.ChooseAddress=function(t){function a(t){I(this,a);var s=D(this,(a.__proto__||(0,n.default)(a)).call(this,t));return s.handleCoutryId=function(){var e=s.props.clearCoutryId;"function"==typeof e&&e()},s.clickNavProvince=function(t){var a=e(t.target).attr("id");e(t.target).hasClass("active-one")||(T.slideTo(a,300),e(t.target).addClass("active-one").siblings().removeClass("active-one"))},s.clickNavCity=function(t){var a=e(t.target).attr("id");s.state.cityClickAble&&(e(t.target).hasClass("active-one")||(T.slideTo(a,300),e(t.target).addClass("active-one").siblings().removeClass("active-one")))},s.clickNavCounty=function(t){var a=e(t.target).attr("id");s.state.countyClickAble&&(e(t.target).hasClass("active-one")||(T.slideTo(a,300),e(t.target).addClass("active-one").siblings().removeClass("active-one")))},s.handleActiveClass=function(t){e("#"+t).hasClass("active-one")||e("#"+t).addClass("active-one").siblings().removeClass("active-one")},s.getCity=function(e){for(var t=0;t<addressData.length;t++)if(addressData[t].value==e)return addressData[t].children},s.getCounty=function(e){var t=s.state.cityData;if(t[0].children){for(var a=0;a<t.length;a++)if(t[a].value==e)return t[a].children}else s.setState({countyTxt:""})},s.clickCity=function(t){var a=s.state.cityData[0].parentId,n=t.target.innerText,d=e(t.target).attr("id");e(t.target).addClass("active-one").siblings().removeClass("active-one");var r=s.getCounty(n);r?s.setState({isCounty:!0},function(){T.update(),T.slideTo(2,300)}):s.setState({confirmClickAble:!0,isCounty:!1},function(){this.confirm()}),s.setState({cityTxt:n,cityId:d,countyData:r,countyClickAble:!0,countyTxt:"",parentId:a}),e(".each-countyaddress").removeClass("active-one")},s.clickCounty=function(t){var a=t.target.innerText,n=e(t.target).attr("id");e(t.target).addClass("active-one").siblings().removeClass("active-one"),s.setState({countyTxt:a,countyId:n},function(){this.confirm()})},s.confirm=function(){var e=s.state,t=e.provincetxt,a=e.cityTxt,n=e.countyTxt,d=e.provinceId,r=e.cityId,i=e.countyId;(e.confirmClickAble||n)&&s.props.confirm(t,a,n,d,r,i)},s.state={provincetxt:"",cityData:[],cityTxt:"",countyData:[],countyTxt:"",cityClickAble:!1,countyClickAble:!1,confirmClickAble:!1,isCounty:!0},s}return S(a,v.Component),h(a,[{key:"componentWillMount",value:function(){var e=this.getCity("北京市");this.setState({provincetxt:"北京市",cityData:e,cityClickAble:"true",isCounty:!1})}},{key:"componentDidMount",value:function(){var t=this;e("#110100").addClass("active-one").siblings().removeClass("active-one"),T=new Swiper(".swiper-container-address",{preventClicks:!0,onSlideChangeStart:function(e){t.handleActiveClass(e.activeIndex)}}),e(".each-address").click(function(a){var s=this.innerText,n=e(this).attr("id");e(this).addClass("active-one").siblings().removeClass("active-one"),T.slideTo(1,300);var d=t.getCity(s);t.setState({isCounty:!1,countyData:[]}),T.update(),"北京市"===s||"天津市"===s||"上海市"===s||"重庆市"===s||"澳门"===s?(t.setState({isCounty:!1}),t.handleCoutryId(),T.update()):t.setState({isCounty:!0}),t.setState({provincetxt:s,provinceId:n,cityData:d,cityClickAble:!0,countyClickAble:!1,cityTxt:"",countyTxt:"",confirmClickAble:!1}),e(".each-cityaddress").removeClass("active-one"),e(".each-countyaddress").removeClass("active-one")})}},{key:"render",value:function(){var e=this.props,t=e.animalStatus,a=e.slideIn,s=this.state,n=s.provincetxt,d=s.cityData,r=s.cityTxt,i=s.countyTxt,o=s.countyData,l=s.cityClickAble,c=s.countyClickAble,u=s.confirmClickAble,f=s.isCounty,m=addressData.map(function(e,t){return g.default.createElement("p",{key:t,className:"each-address",id:e.id},e.value)});return g.default.createElement("div",{className:"animal-address"},g.default.createElement("div",{className:"choose-address "+(t?a?"animal1":"animal2":"")},g.default.createElement("ul",{className:"nav"},g.default.createElement("li",{className:"active-one",id:"0",onClick:this.clickNavProvince},n||"省份"),g.default.createElement("li",{id:"1",onClick:this.clickNavCity,style:{color:l?"":"#c9c9c9"}},r||"城市"),f?g.default.createElement("li",{id:"2",onClick:this.clickNavCounty,style:{color:c?"":"#c9c9c9"}},i||"区县"):"",g.default.createElement("li",{className:"confirm",onClick:this.confirm,style:{color:u||i?"":"#c9c9c9"}},"完成")),g.default.createElement("div",{className:"address-content","data-plugin":"swiper"},g.default.createElement("div",{className:"swiper-container swiper-container-address"},g.default.createElement("div",{className:"swiper-wrapper "},g.default.createElement("div",{className:"swiper-slide each-list"},m),g.default.createElement("div",{className:"swiper-slide each-list"},g.default.createElement(j,{data:d,fn:this.clickCity})),f?g.default.createElement("div",{className:"swiper-slide each-list"},g.default.createElement(U,{data:o||[],fn:this.clickCounty})):"")))))}}]),a}(),j=function(e){function t(){return I(this,t),D(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return S(t,v.Component),h(t,[{key:"render",value:function(){var e=this,t=this.props.data.map(function(t,a){return g.default.createElement("p",{key:a,className:"each-cityaddress",onClick:e.props.fn,id:t.id},t.value)});return g.default.createElement("div",null,t)}}]),t}(),U=function(e){function t(){return I(this,t),D(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return S(t,v.Component),h(t,[{key:"render",value:function(){var e=this,t=this.props.data.map(function(t,a){return g.default.createElement("p",{key:a,className:"each-countyaddress",onClick:e.props.fn,id:t.id},t.value)});return g.default.createElement("div",null,t)}}]),t}()}).call(this,a("OOjC"))}}]);
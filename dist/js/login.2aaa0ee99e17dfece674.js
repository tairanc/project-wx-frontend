(window.webpackJsonp=window.webpackJsonp||[]).push([[18,19],{"404C":function(e,t,n){"use strict";(function(e){var a=s(n("Zx67")),o=s(n("kiBT")),l=s(n("OvRC")),r=s(n("pFYg")),i=s(n("C4MV")),c=s(n("woOf"));function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.WapLogin=void 0;var u=c.default||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},d=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),(0,i.default)(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();t.setExtraInfo=I,t.wapLoginState=L,t.wapLoginDispatch=U;var p=n("U7vG"),f=y(p),g=n("Zfgq"),m=y(n("4GUf")),h=n("f2Hk"),v=n("4n+p"),_=n("5qLU"),w=n("nztU"),C=y(n("mtWM"));function y(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,r.default)(t))&&"function"!=typeof t?e:t}function k(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,r.default)(t)));e.prototype=(0,l.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(o.default?(0,o.default)(e,t):e.__proto__=t)}n("cQc5");(0,h.actionAxios)("wapLoginIndex");var N=(0,h.concatPageAndType)("global"),T={uc_loginOrReg:function(e){return{url:_.UCENTER+"/login/quick_login_register?spm="+e,method:"post"}},uc_phoneExist:function(e){return{url:_.UCENTER+"/user/phone_"+e+"/exists"}},uc_sendCode:{url:_.UCENTER+"/mock/send_code",method:"post"},uc_loginByPwd:{url:_.UCENTER+"/login/phone",method:"post"},uc_geeInit:function(e){return{url:_.UCGEE+"/gee/getChallenge?addressIp="+e+"&appId="+_.UCAPPID+"&t="+(new Date).getTime()}},uc_geeVerify:{url:_.UCGEE+"/gee/verifyLogin",method:"post"}};function I(e,t,n){return{type:"ds-zc",httpcode:e,serviceCode:t,message:n}}var M=t.WapLogin=function(t){function n(e){b(this,n);var t=E(this,(n.__proto__||(0,a.default)(n)).call(this,e));return t.codeHandle=function(){t.setState({selCode:!0})},t.pwdHandle=function(){t.setState({selCode:!1})},t.state={selCode:!0,redirect_uri:t.props.redirect_uri,params:t.props,secretCode:""},t}return k(n,p.Component),d(n,[{key:"render",value:function(){var t=this.state,n=t.selCode,a=t.redirect_uri,o=t.params;return f.default.createElement("div",{"data-page":"wap-login",style:{minHeight:e(window).height()}},f.default.createElement("div",{className:"page-logo"},f.default.createElement("img",{src:"/src/img/user/trc-logo.png"})),f.default.createElement("div",{className:"c-tc"},f.default.createElement("div",{className:"login-method",onClick:this.codeHandle},f.default.createElement("span",null,"验证码登录"),f.default.createElement("div",{className:"split-line code",style:n?{background:"#e60a30"}:{}})),f.default.createElement("div",{className:"login-method",onClick:this.pwdHandle},f.default.createElement("span",null,"密码登录"),f.default.createElement("div",{className:"split-line pwd",style:n?{}:{background:"#e60a30"}}))),n?f.default.createElement(S,{changeLogin:this.props.changeLogin,params:o}):f.default.createElement(x,{changeLogin:this.props.changeLogin,redirect_uri:a}))}}]),n}(),S=function(t){function n(t){b(this,n);var o=E(this,(n.__proto__||(0,a.default)(n)).call(this,t));return o.checkTel=function(e){return/^1\d{10}$/.test(e)?(o.setState({telCorrect:!0}),!0):(m.default.MsgTip({msg:"请输入正确的手机号码"}),!1)},o.checkCode=function(e){return!!/^\d{4}$/.test(e)||(m.default.MsgTip({msg:"验证码不正确"}),!1)},o.loadCaptchas=function(e){C.default.request(T.uc_geeInit(e)).then(function(e){if(200===e.status){var t=e.data;initGeetest({gt:t.gt,challenge:t.challenge,offline:!t.success,new_captcha:t.serverStatus,product:"bind"},o.handlerEmbed),o.setState({serverStatus:t.serverStatus})}}).catch(function(e){console.log(e),m.default.MsgTip({msg:"服务器繁忙"})})},o.handlerEmbed=function(t){t.onError(function(){m.default.MsgTip({msg:"验证错误"})}).onSuccess(function(){var n=t.getValidate(),a=o.state.serverStatus,l=e("#tel").val().replace(/\s+/g,"");n||m.default.MsgTip({msg:"请完成验证"}),C.default.request(u({},T.uc_geeVerify,{data:{addressIp:l,appId:_.UCAPPID,challenge:n.geetest_challenge,validate:n.geetest_validate,seccode:n.geetest_seccode,serverStatus:a}})).then(function(e){e.data.body&&"success"===e.data.body.status?(o.setState({secretCode:e.data.body.secretCode}),o.nextHandle()):t.reset()}).catch(function(e){console.log(e),m.default.MsgTip({msg:"服务器繁忙"})})}),t&&o.setState({captchaObj:t})},o.nextHandle=function(){var t=e("#tel").val().replace(/\s+/g,""),n=o.state,a=n.count,l=n.codeSend;if(!l){e(".get-code").addClass("countdown").removeClass("send-code"),o.setState({codeSend:!0}),o.timer=setInterval(function(){l=!0,0===--a&&(a=60,l=!1,clearInterval(this.timer),e(".get-code").addClass("send-code").removeClass("countdown")),this.setState({count:a,codeSend:l})}.bind(o),1e3);var r=o;C.default.request(u({},T.uc_sendCode,{data:{appId:_.UCAPPID,phone:t,usage:"QUICK_LOGIN_REGISTER"}})).then(function(e){var t=e.data;"200"===t.code?m.default.MsgTip({msg:"验证码已发送"}):m.default.MsgTip({msg:t.message})}).catch(function(e){console.log(e),m.default.MsgTip({msg:"服务器繁忙"})}),C.default.request(u({},T.uc_phoneExist(t),{params:{appId:_.UCAPPID}})).then(function(e){var t=e.data;"200"===t.code&&r.setState({isNew:!t.body})}).catch(function(){m.default.MsgTip({msg:"服务器繁忙"})})}},o.getCode=function(){var t=e("#tel").val().replace(/\s+/g,"");o.checkTel(t)&&(o.loadCaptchas(t),o.getCatcha())},o.getCatcha=function(){var e=o.state.captchaObj;e?e.verify():setTimeout(o.getCatcha,1e3)},o.changeHandle=function(){var t=e("#tel").val().replace(/\s+/g,""),n=e("#code").val().replace(/\s+/g,"");11===t.length&&n?o.setState({inputComp:!0}):o.setState({inputComp:!1})},o.loginHandle=function(){var t=e("#tel").val().replace(/\s+/g,""),n=e("#code").val().replace(/\s+/g,"");if(o.checkTel(t)&&o.checkCode(n)){var a=o.state,l=a.isNew,r=a.secretCode,i=o.props.params,c=i.redirect_uri,s=i.invite,d=i.from;"ecard_red_jr"===d&&l&&/^TRC_/gi.test(s)&&(s=""+parseInt(s.substring(4))/7),C.default.request(u({},T.uc_loginOrReg(r),{headers:{"X-Platform-Info":"H5"},data:{appId:_.UCAPPID,phone:t,phoneCode:n}})).then(function(e){var t=e.data,n=e.status;if(t.body.isNew){var a=I(n,t.code,t.message);sdk.storeUserId(t.body.userId),sdk.dispatch("click",document.getElementById("submit"),a)}"200"===t.code?(m.default.MsgTip({msg:"成功"}),(0,w.setCookie)("token",t.body.token),o.props.changeLogin(!0),c&&"ecard_red_jr"===d||!/\?/.test(c)?window.location.replace(c):/\?/.test(c)?window.location.replace(c+"&user="+(l?"new":"old")):g.browserHistory.goBack()):m.default.MsgTip({msg:t.message})}).catch(function(e){console.log(e),o.props.changeLogin(!1)})}},o.delHandle=function(t){e(t.target).prev().val("").focus(),o.setState({inputComp:!1})},o.onlyNum=function(){e("#tel").val(e("#tel").val().replace(/\D/g,"")),e("#code").val(e("#code").val().replace(/\D/g,""))},o.state={count:60,codeSend:!1,telCorrect:!1,inputComp:!1,isNew:!1},o}return k(n,p.Component),d(n,[{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"render",value:function(){var t=this.state,n=t.count,a=t.codeSend,o=t.inputComp,l=t.telCorrect,r=a?n+"s后重发":"获取验证码",i=e("#tel").val();return f.default.createElement("div",{className:"input-area"},f.default.createElement("div",{className:"input-info c-pr"},f.default.createElement("input",{type:"text",id:"tel",placeholder:"泰然城账号/手机号码",maxLength:"11",onChange:this.changeHandle,onKeyUp:this.onlyNum,onPaste:this.onlyNum}),f.default.createElement("img",{className:"del-icon "+(i?"":"c-dpno"),src:"/src/img/user/delete.png",onClick:this.delHandle})),f.default.createElement("div",{className:"input-info c-pr"},f.default.createElement("input",{type:"text",id:"code",placeholder:"请输入验证码",maxLength:"4",onChange:this.changeHandle,onKeyUp:this.onlyNum,onPaste:this.onlyNum}),f.default.createElement("span",{className:"get-code c-tc send-code",onClick:this.getCode,disabled:!(l&&a)},r)),f.default.createElement("input",{type:"button",className:"submit-btn c-tc",id:"submit",style:{background:o?"#353535":"#c9c9c9"},disabled:!o,value:"登录",onClick:this.loginHandle}))}}]),n}(),x=function(t){function n(t){b(this,n);var o=E(this,(n.__proto__||(0,a.default)(n)).call(this,t));return o.pwdToggle=function(){o.setState({showPwd:!o.state.showPwd})},o.checkTel=function(e){return/^1\d{10}$/.test(e.trim())?(o.setState({telCorrect:!0}),!0):(m.default.MsgTip({msg:"请输入正确的手机号码"}),!1)},o.checkPwd=function(e){return!0},o.changeHandle=function(){var t=e("#tel").val().replace(/\s+/g,""),n=e("#pwd").val().replace(/\s+/g,"");t?o.setState({tel:t}):o.setState({tel:""}),11===t.length&&n.length>=6?o.setState({inputComp:!0}):o.setState({inputComp:!1})},o.loginHandle=function(){var t=e("#tel").val().replace(/\s+/g,""),n=e("#pwd").val().replace(/\s+/g,"");if(o.checkTel(t)&&o.checkPwd(n)){var a=o.props.redirect_uri,l=o;C.default.request(u({},T.uc_loginByPwd,{data:{appId:_.UCAPPID,encryptFlag:!1,password:n,phone:t}})).then(function(e){var t=e.data;"200"===t.code?(m.default.MsgTip({msg:"登录成功"}),(0,w.setCookie)("token",t.body.token),l.props.changeLogin(!0),a?window.location.replace(a):window.history.go(-1)):m.default.MsgTip({msg:t.message})}).catch(function(e){var t=e.error;console.log(t),m.default.MsgTip({msg:"服务器繁忙"}),l.props.changeLogin(!1)})}},o.delHandle=function(t){e(t.target).prev().val("").focus(),o.setState({inputComp:!1})},o.onlyNum=function(){e("#tel").val(e("#tel").val().replace(/\D/g,""))},o.state={tel:"",showPwd:!1,inputComp:!1},o}return k(n,p.Component),d(n,[{key:"render",value:function(){var e=this.state,t=e.tel,n=e.showPwd,a=e.inputComp;return f.default.createElement("div",{className:"input-area"},f.default.createElement("div",{className:"input-info c-pr"},f.default.createElement("input",{type:"text",id:"tel",placeholder:"请输入手机号码/泰然城账号",maxLength:"11",onChange:this.changeHandle,onKeyUp:this.onlyNum,onPaste:this.onlyNum}),f.default.createElement("img",{className:"del-icon "+(t?"":"c-dpno"),src:"/src/img/user/delete.png",onClick:this.delHandle})),f.default.createElement("div",{className:"input-info c-pr"},f.default.createElement("input",{type:n?"text":"password",id:"pwd",placeholder:"请输入密码",maxLength:"20",onChange:this.changeHandle}),n?f.default.createElement("img",{className:"eye-open",src:"/src/img/user/eye-open.png",onClick:this.pwdToggle}):f.default.createElement("img",{className:"eye-close",src:"/src/img/user/eye-close.png",onClick:this.pwdToggle})),f.default.createElement("input",{type:"button",className:"submit-btn c-tc",style:{background:a?"#353535":"#c9c9c9"},disabled:!a,value:"登录",onClick:this.loginHandle}),f.default.createElement(g.Link,{to:"/forgetPwd"},f.default.createElement("div",{className:"forget-btn"},"忘记密码")))}}]),n}();function L(e,t){return u({},e.wapLoginIndex)}function U(e,t){return{changeLogin:function(t){e(N("changeLogin",{login:t}))}}}t.default=(0,v.connect)(L,U)(M)}).call(this,n("OOjC"))},"8Uy0":function(e,t,n){e.exports={loginModeGrid:"_1fGAab8G3zLUtdczBRYC_D",loginModeTop:"_3eNMdheM75P-RHWnh0sYsG",greyLine:"_2Vcf409Ytu-_ffEFWhIpNM",titleText:"_3LjJnyXLyR0WLSfkesxUBf",btnGrid:"_1dOBYm2-79QSBizKgBY4n4",loginBtn:"_2cZGft-a8_DGh7VZbENUQ7",loginIcon:"hZqifh2UMMrLDoHZoig85",weixinBtn:"_11XczvQIwQ3UlW-RPy2kRG",weixinIcon:"_2F2JmioxiLjzYANrosnCBJ",qqBtn:"_2cKGc_nlPS9wl5QTKGo_ns",qqIcon:"_3wD_i2G8vgNyhJaIelpzcB"}},Vifw:function(e,t,n){"use strict";(function(e){var a=c(n("Zx67")),o=c(n("kiBT")),l=c(n("OvRC")),r=c(n("pFYg")),i=c(n("C4MV"));function c(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),(0,i.default)(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n("U7vG"),d=m(u),p=(n("Zfgq"),m(n("8Uy0"))),f=n("qeJi"),g=m(n("404C"));function m(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,r.default)(t))&&"function"!=typeof t?e:t}function _(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,r.default)(t)));e.prototype=(0,l.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(o.default?(0,o.default)(e,t):e.__proto__=t)}var w=function(t){function n(){var e,t,o;h(this,n);for(var l=arguments.length,r=Array(l),i=0;i<l;i++)r[i]=arguments[i];return t=o=v(this,(e=n.__proto__||(0,a.default)(n)).call.apply(e,[this].concat(r))),o.getRedirect=function(){var e=o.props.location.query,t=e.redirect_uri,n=e.from,a=e.invite;n=n||"";try{/^TRC_/gi.test(a)&&(a=Math.round(Number(a.slice(4))/7))}catch(e){console.log(e),a=""}var l=encodeURIComponent(t||"/homeIndex"),r=window.location.origin;return encodeURIComponent(r+"/loginTransfer?redirect_uri="+l+"&from="+n+"&invite="+a)},v(o,t)}return _(n,u.Component),s(n,[{key:"componentWillMount",value:function(){f.browser.versions.weixin&&window.location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx5c9c135a8f312e74&redirect_uri="+this.getRedirect()+"&response_type=code&scope=snsapi_userinfo&state=123#wechat_redirect")}},{key:"componentDidMount",value:function(){e(this.refs.userLogin).css({minHeight:e(window).height()})}},{key:"render",value:function(){var e=this.props.location.query,t=e.redirect_uri,n=e.invite,a=e.from;return f.browser.versions.weixin?null:d.default.createElement(g.default,{redirect_uri:t,invite:n,from:a})}}]),n}();t.default=w;!function(e){function t(){return h(this,t),v(this,(t.__proto__||(0,a.default)(t)).apply(this,arguments))}_(t,u.Component),s(t,[{key:"render",value:function(){var e=this.props.config;return d.default.createElement("div",{className:p.default.loginModeGrid},d.default.createElement("div",{className:p.default.loginModeTop},d.default.createElement("div",{className:p.default.greyLine}," "),d.default.createElement("div",{className:p.default.titleText},e.title)),d.default.createElement("div",{className:p.default.btnGrid},d.default.createElement("a",{href:e.btnUrl,className:p.default.loginBtn+" "+e.btnClass}," ",d.default.createElement("i",{className:p.default.loginIcon+" "+e.iconClass}," "),e.btnText)))}}])}()}).call(this,n("OOjC"))},cQc5:function(e,t,n){}}]);
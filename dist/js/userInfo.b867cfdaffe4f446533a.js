(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{NgTW:function(e,t,a){},reLy:function(e,t,a){"use strict";(function(e){var n=u(a("Xxa5")),r=u(a("Zx67")),i=u(a("kiBT")),l=u(a("OvRC")),s=u(a("pFYg")),c=u(a("//Fk")),o=u(a("C4MV")),d=u(a("woOf"));function u(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var m=d.default||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},f=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,o.default)(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),p=a("U7vG"),h=C(p),g=a("Zfgq"),v=C(a("4GUf")),w=a("d2xe"),E=a("qeJi"),y=a("f2t5"),S=a("mskG"),N=a("5qLU"),k=a("nztU"),x=C(a("mtWM"));function C(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,s.default)(t))&&"function"!=typeof t?e:t}function I(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,s.default)(t)));e.prototype=(0,l.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(i.default?(0,i.default)(e,t):e.__proto__=t)}a("NgTW");var M={uc_getUserInfo:{url:N.UCENTER+"/user"},uc_setUserInfo:{url:N.UCENTER+"/user",method:"put"},uc_unBindWx:{url:N.UCENTER+"/user/unbind",method:"put"},uc_logout:{url:N.UCENTER+"/user/logout",method:"post"},unbind:{url:N.WXAPI+"/unBindUser"},compressImg:{url:N.WXAPI+"/uploadImage",method:"post"}},T=function(t){function a(t){var i=this;b(this,a);var l,s,o=_(this,(a.__proto__||(0,r.default)(a)).call(this,t));return o.changeState=function(e){o.setState(e)},o.showAvatar=function(){o.setState({showStart:!0,showAvatar:!0})},o.chooseSex=function(){o.setState({sexStart:!0,shadySlide:!0,sexSlideIn:!0})},o.chooseBirth=function(){o.setState({birthStart:!0,shadySlide:!0,birthSlideIn:!0})},o.upLoadImg=(l=n.default.mark(function t(a){var r,l;return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e(".avatar-form")[0].firstChild.files[0]){t.next=5;break}return t.abrupt("return");case 5:if(/^image\/(jpg|png|jpeg|bmp)$/.test(r.type)){t.next=8;break}return v.default.MsgTip({msg:"亲，请上传jpg/png/jpeg/bmp格式的图片哦~"}),t.abrupt("return");case 8:return t.next=10,(0,S.compress)(r);case 10:l=t.sent,o.upLoadAjax(l);case 12:case"end":return t.stop()}},t,i)}),s=function(){var e=l.apply(this,arguments);return new c.default(function(t,a){return function n(r,i){try{var l=e[r](i),s=l.value}catch(e){return void a(e)}if(!l.done)return c.default.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});t(s)}("next")})},function(e){return s.apply(this,arguments)}),o.upLoadAjax=function(e){x.default.request(m({},M.compressImg,{data:{img:e}})).then(function(e){var t=e.data;o.setState({avatar:t.data.file.complete_url}),x.default.request(m({},M.uc_setUserInfo,{data:{avatar:t.data.file.complete_url},headers:{Authorization:"Bearer "+o.token}})).then(function(e){var t=e.data;v.default.MsgTip({msg:"头像修改"+("200"===t.code?"成功":"失败")})})}).catch(function(e){console.log(e),v.default.MsgTip({msg:e.response.data.message||"上传图片出错"})})},o.unBindUser=function(){x.default.request(m({},M.unbind,{params:{openid:(0,k.getCookie)("openId")}})).then(function(){v.default.MsgTip({msg:"解绑成功"}),o.unBindWx()}).catch(function(e){console.log(e),v.default.MsgTip({msg:e.response.data.message||"解绑用户信息失败"})})},o.unBindWx=function(){var e=o;x.default.request(m({},M.uc_unBindWx,{headers:{Authorization:"Bearer "+e.token},params:{type:"WECHAT"}})).then(function(t){"200"===t.data.code?e.exitLogin():v.default.MsgTip({msg:"解绑失败"})}).catch(function(e){var t=e.error;console.log(t),v.default.MsgTip({msg:"服务器繁忙"})})},o.exitLogin=function(){var e=o;x.default.request(m({},M.uc_logout,{headers:{Authorization:"Bearer "+e.token}})).then(function(e){"200"===e.data.code?((0,k.clearCookie)("openId"),(0,k.clearCookie)("token"),window.location.replace("/userCenter")):v.default.MsgTip({msg:"解绑失败"})}).catch(function(e){var t=e.error;console.log(t)})},o.unBindClick=function(){v.default.Modal({isOpen:!0,msg:"确定要解除绑定吗？"},o.unBindUser)},o.exitClick=function(){v.default.Modal({isOpen:!0,msg:"确定要退出登录吗？"},o.exitLogin)},o.shadyClick=function(){o.setState({shadySlide:!1,avatarSlideIn:!1,sexSlideIn:!1,birthSlideIn:!1})},o.state={update:!1,isEnterprise:!1,data:{},shadySlide:!1,avatar:"",showAvatar:!1,showStart:!1,birth:"",birthStart:!1,birthSlideIn:!1,sex:"",sexStart:!1,sexSlideIn:!1},o}return I(a,p.Component),f(a,[{key:"componentWillMount",value:function(){document.title="个人信息",this.context.isApp&&(window.location.href="jsbridge://set_title?title=个人信息"),this.token=(0,k.getCookie)("token");var e=this;x.default.request(m({},M.uc_getUserInfo,{headers:{Authorization:"Bearer "+e.token},params:{needPhone:!0}})).then(function(t){var a=t.data,n=a.body;"200"===a.code?e.setState({data:n,avatar:n.avatar,sex:n.gender,birth:(0,y.dateFormat)(n.birthDate,"yyyy-MM-dd"),isCompanyUser:"COMPANY"===n.type,update:!0}):v.default.MsgTip({msg:"服务器繁忙"})}).catch(function(e){v.default.MsgTip({msg:"服务器繁忙"})})}},{key:"componentWillUnmount",value:function(){var e=document.querySelector("#msgTip");e&&e.parentNode&&e.parentNode.removeChild(e)}},{key:"render",value:function(){var t=this.state,a=t.shadySlide,n=t.showStart,r=t.showAvatar,i=t.avatar,l=t.sex,s=t.sexStart,c=t.sexSlideIn,o=t.birth,d=t.birthStart,u=t.birthSlideIn,m=t.update,f=(t.isCompanyUser,t.data);return m?h.default.createElement("div",{"data-page":"user-info",style:{minHeight:e(window).height()}},h.default.createElement("div",{className:"shady "+(a?"":"c-dpno"),style:{height:e(window).height()},onClick:this.shadyClick}),h.default.createElement(A,{showStart:n,showAvatar:r,avatar:i,changeState:this.changeState}),h.default.createElement(B,{sexStart:s,shadySlide:a,sexSlideIn:c,changeState:this.changeState}),h.default.createElement(U,{birthStart:d,shadySlide:a,birthSlideIn:u,changeState:this.changeState,birth:o}),h.default.createElement("ul",{className:"info-list"},h.default.createElement("li",{className:"info-avatar-li"},h.default.createElement("div",{className:"avatar-div li-padding"},"头像",h.default.createElement("form",{className:"avatar-form"},h.default.createElement("input",{type:"file",name:"file",onChange:this.upLoadImg,accept:"image/*",className:"upLoadFromCamera"})),h.default.createElement("div",{className:"avatar-prompt prompt-msg",onClick:this.showAvatar},h.default.createElement("div",{className:"avatar-container"},h.default.createElement("img",{className:"avatar",src:i||"/src/img/icon/avatar/default-avatar.png"})),h.default.createElement("img",{className:"arrow-right avatar-arrow",src:"/src/img/userCenter/arrow_right.png"}))),h.default.createElement("div",{className:"split-line"})),h.default.createElement("li",null,h.default.createElement("div",{className:"li-padding"},"手机号",h.default.createElement("span",{className:"prompt-msg"},f.phone.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"))),h.default.createElement("div",{className:"split-line"})),h.default.createElement("li",null,h.default.createElement(g.Link,{to:"/userNickname?nickname="+(f.nickname?f.nickname:f.phone)},h.default.createElement("div",{className:"li-padding"},"昵称",h.default.createElement("div",{className:"prompt-msg"},h.default.createElement("span",null,f.nickname?f.nickname:f.phone),h.default.createElement("img",{className:"arrow-right",src:"/src/img/userCenter/arrow_right.png"}))),h.default.createElement("div",{className:"split-line"}))),h.default.createElement("li",{onClick:this.chooseSex},h.default.createElement("div",{className:"li-padding"},"性别",h.default.createElement("div",{className:"prompt-msg"},h.default.createElement("span",null,"UNKNOWN"!==l?"MALE"===l?"男":"女":"未设置"),h.default.createElement("img",{className:"arrow-right",src:"/src/img/userCenter/arrow_right.png"}))),h.default.createElement("div",{className:"split-line"})),h.default.createElement("li",{className:"li-padding",onClick:this.chooseBirth},"生日",h.default.createElement("div",{className:"prompt-msg"},h.default.createElement("span",null,o||"未设置"),h.default.createElement("img",{className:"arrow-right",src:"/src/img/userCenter/arrow_right.png"}))),h.default.createElement("li",{className:"info-area"},h.default.createElement(g.Link,{to:"/goodsReceiveInfo/identityManage"},h.default.createElement("div",{className:"li-padding"},"身份证管理",h.default.createElement("div",{className:"prompt-msg"},h.default.createElement("img",{className:"arrow-right",src:"/src/img/userCenter/arrow_right.png"}))),h.default.createElement("div",{className:"split-line"}))),h.default.createElement("li",null,h.default.createElement(g.Link,{to:"/goodsReceiveInfo/addressManage"},h.default.createElement("div",{className:"li-padding"},"收货地址",h.default.createElement("div",{className:"prompt-msg"},h.default.createElement("img",{className:"arrow-right",src:"/src/img/userCenter/arrow_right.png"}))))),h.default.createElement("li",{className:"li-padding info-area "+(E.browser.versions.weixin?"":"c-dpno"),onClick:this.unBindClick},"绑定微信",h.default.createElement("span",{className:"prompt-msg"},"解除绑定"))),h.default.createElement("button",{onClick:this.exitClick},"退出登录")):h.default.createElement(w.LoadingRound,null)}}]),a}();t.default=T;var A=function(t){function a(){var e,t,n;b(this,a);for(var i=arguments.length,l=Array(i),s=0;s<i;s++)l[s]=arguments[s];return t=n=_(this,(e=a.__proto__||(0,r.default)(a)).call.apply(e,[this].concat(l))),n.cancelShowAvatar=function(){n.props.changeState({showAvatar:!1})},_(n,t)}return I(a,p.Component),f(a,[{key:"componentDidMount",value:function(){e(".show-avatar").css({minHeight:e(window).height()})}},{key:"render",value:function(){var e=this.props,t=e.showStart,a=e.showAvatar,n=e.avatar;return h.default.createElement("div",{className:"show-avatar "+(t?a?"animationBg1":"animationBg2":"c-dpno"),onClick:this.cancelShowAvatar},h.default.createElement("img",{className:t?a?"animationAvatar1":"animationAvatar2":"c-dpno",src:n||"/src/img/icon/avatar/default-avatar.png"}))}}]),a}(),B=function(t){function a(){var t,n,i;b(this,a);for(var l=arguments.length,s=Array(l),c=0;c<l;c++)s[c]=arguments[c];return n=i=_(this,(t=a.__proto__||(0,r.default)(a)).call.apply(t,[this].concat(s))),i.cancelSex=function(){i.props.changeState({shadySlide:!1,sexSlideIn:!1})},i.confirmSex=function(){var t=e(".sex-container .swiper-slide-active").text();t="女"===t?"FEMALE":"男"===t?"MALE":"UNKNOWN";var a=(0,k.getCookie)("token"),n=i;x.default.request(m({},M.uc_setUserInfo,{headers:{Authorization:"Bearer "+a},data:{gender:t}})).then(function(e){"200"===e.data.code?(n.props.changeState({sex:t}),v.default.MsgTip({msg:"性别修改成功"})):v.default.MsgTip({msg:"性别修改失败"})}),i.props.changeState({shadySlide:!1,sexSlideIn:!1})},_(i,n)}return I(a,p.Component),f(a,[{key:"componentDidMount",value:function(){new Swiper(".sex-container",{preventClicks:!0,direction:"vertical",slideToClickedSlide:!0,slidesPerView:2})}},{key:"render",value:function(){var e=this.props,t=e.sexStart,a=e.sexSlideIn;return h.default.createElement("div",{className:"animation-sex"},h.default.createElement("div",{className:"choose-sex "+(t?a?"animation1":"animation2":"")},h.default.createElement("div",{className:"fixed-line c-pa",style:{top:"122px"}}),h.default.createElement("div",{className:"fixed-line c-pa",style:{top:"165px"}}),h.default.createElement("ul",{className:"nav"},h.default.createElement("li",{className:"cancel",onClick:this.cancelSex},"取消"),h.default.createElement("li",{className:"confirm",onClick:this.confirmSex},"完成")),h.default.createElement("div",{className:"sex-content","data-plugin":"swiper"},h.default.createElement("div",{className:"swiper-container sex-container"},h.default.createElement("div",{className:"swiper-wrapper"},h.default.createElement("div",{className:"swiper-slide"},"女"),h.default.createElement("div",{className:"swiper-slide"},"男"),h.default.createElement("div",{className:"swiper-slide"}))))))}}]),a}(),U=function(t){function a(t){b(this,a);var n=_(this,(a.__proto__||(0,r.default)(a)).call(this,t));n.getSelTime=function(){return{year:parseInt(e(".year-container .swiper-slide-active").text().split("年")[0]),month:parseInt(e(".month-container .swiper-slide-active").text().split("月")[0]),day:parseInt(e(".day-container .swiper-slide-active").text().split("日")[0])}},n.getDayNum=function(e,t){var a=void 0;switch(t){case 1:case 3:case 5:case 7:case 8:case 10:case 12:a=31;break;case 4:case 6:case 9:case 11:a=30;break;case 2:a=e%4==0&&e%100!=0||e%400==0?29:28}return a},n.dayGenerator=function(e,t){for(var a=[],r=n.getDayNum(e,t),i=1;i<=r;i++)a.push(i);return a},n.cancelBirth=function(){n.props.changeState({shadySlide:!1,birthSlideIn:!1})},n.confirmBirth=function(){var t=e(".year-container .swiper-slide-active").text().split("年")[0]+"-"+e(".month-container .swiper-slide-active").text().split("月")[0]+"-"+e(".day-container .swiper-slide-active").text().split("日")[0],a=n,r=(0,k.getCookie)("token");x.default.request(m({},M.uc_setUserInfo,{headers:{Authorization:"Bearer "+r},data:{birthDate:t}})).then(function(e){"200"===e.data.code?(a.props.changeState({birth:t}),v.default.MsgTip({msg:"生日修改成功"})):v.default.MsgTip({msg:"生日修改失败"})}),n.props.changeState({shadySlide:!1,birthSlideIn:!1})},n.getYear=function(){for(var e=[],t=(new Date).getFullYear(),a=t-70;a<=t;a++)e.push(a+"年");return e},n.getMonth=function(){for(var e=[],t=1;t<=12;t++)e.push((t<10?"0"+t:t)+"月");return e};var i=new Date,l=n.props.birth,s=l?l.split("-").map(function(e){return parseInt(e)}):[],c=s.length;return n.state={nowYear:i.getFullYear(),nowMonth:i.getMonth(),nowDay:i.getDate(),yearInit:c?70-(i.getFullYear()-s[0]):70,monthInit:c?s[1]-1:i.getMonth(),dayInit:c?s[2]:i.getDate(),yearCnt:0,monthCnt:0,dayCnt:0,dayArr:n.dayGenerator(c?i.getFullYear():s[0],(c?s[1]-1:i.getMonth())+1)},n}return I(a,p.Component),f(a,[{key:"componentDidMount",value:function(){var e=this.state,t=e.nowYear,a=e.nowMonth,n=e.nowDay,r=e.yearInit,i=e.monthInit,l=e.dayInit,s=e.yearCnt,c=e.monthCnt,o=e.dayCnt,d=this,u=new Swiper(".day-container",{preventClicks:!0,direction:"vertical",slideToClickedSlide:!0,slidesPerView:5,centeredSlides:!0,initialSlide:l-1,onSlideChangeEnd:function(e){if(o>0){var r=d.getSelTime(),i=r.year,l=r.month,s=r.day;i===t&&l-1===a&&s>n&&e.slideTo(n-1,200,!0)}o++}}),m=new Swiper(".month-container",{preventClicks:!0,direction:"vertical",slideToClickedSlide:!0,slidesPerView:5,centeredSlides:!0,initialSlide:i,onSlideChangeEnd:function(e){if(c>0){var r=d.getSelTime(),i=r.year,l=r.month,s=r.day;i===t&&l>a&&e.slideTo(a,200,!0),i===t&&l-1===a&&s>n&&u.slideTo(n-1,200,!0);var o=d.dayGenerator(i,l),m=d.getDayNum(i,l);d.setState({dayArr:o}),u.updateSlidesSize(),(!s||s>m)&&u.slideTo(m-1,200,!0)}c++}});new Swiper(".year-container",{preventClicks:!0,direction:"vertical",slideToClickedSlide:!0,slidesPerView:5,centeredSlides:!0,initialSlide:r,onSlideChangeEnd:function(e){if(s>0){var r=d.getSelTime(),i=r.year,l=r.month,c=r.day;i===t&&l>a&&m.slideTo(a,200,!0),i===t&&l-1===a&&c>n&&u.slideTo(n-1,200,!0);var o=d.dayGenerator(i,l),f=d.getDayNum(i,l);d.setState({dayArr:o}),u.updateSlidesSize(),(!c||c>f)&&u.slideTo(f-1,200,!0)}s++}})}},{key:"render",value:function(){var e=this.props,t=e.birthSlideIn,a=e.birthStart,n=this.state.dayArr,r=this.getYear().map(function(e,t){return h.default.createElement("div",{key:t,className:"swiper-slide"},h.default.createElement("p",{className:"each-year"},e))}),i=this.getMonth().map(function(e,t){return h.default.createElement("div",{key:t,className:"swiper-slide"},h.default.createElement("p",{className:"each-month"},e))}),l=n.map(function(e,t){return h.default.createElement("div",{key:t,className:"swiper-slide"},h.default.createElement("p",{className:"each-day"},(e<10?"0"+e:e)+"日"))});return h.default.createElement("div",{className:"animation-birth"},h.default.createElement("div",{className:"choose-birth "+(a?t?"animation1":"animation2":"")},h.default.createElement("div",{className:"fixed-line c-pa",style:{top:"126px"}}),h.default.createElement("div",{className:"fixed-line c-pa",style:{top:"169px"}}),h.default.createElement("ul",{className:"nav"},h.default.createElement("li",{className:"cancel",onClick:this.cancelBirth},"取消"),h.default.createElement("li",{className:"confirm",onClick:this.confirmBirth},"完成")),h.default.createElement("div",{className:"birth-content","data-plugin":"swiper"},h.default.createElement("div",{className:"swiper-container year-container"},h.default.createElement("div",{className:"swiper-wrapper"},r)),h.default.createElement("div",{className:"swiper-container month-container"},h.default.createElement("div",{className:"swiper-wrapper"},i)),h.default.createElement("div",{className:"swiper-container day-container"},h.default.createElement("div",{className:"swiper-wrapper"},l)))))}}]),a}()}).call(this,a("OOjC"))}}]);
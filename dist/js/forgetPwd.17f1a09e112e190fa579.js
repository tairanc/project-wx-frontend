(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{"Hd+C":function(e,t,a){"use strict";(function(e){var n=r(a("Zx67")),l=r(a("kiBT")),c=r(a("OvRC")),s=r(a("pFYg")),o=r(a("C4MV")),u=r(a("woOf"));function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=u.default||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},d=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,o.default)(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),p=a("U7vG"),f=C(p),g=C(a("4GUf")),m=a("5qLU"),h=a("Zfgq"),v=C(a("mtWM"));a("kVJM");a("qeJi");function C(e){return e&&e.__esModule?e:{default:e}}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,s.default)(t))&&"function"!=typeof t?e:t}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,s.default)(t)));e.prototype=(0,c.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(l.default?(0,l.default)(e,t):e.__proto__=t)}var _={uc_sendCode:{url:m.UCENTER+"/mock/send_code",method:"post"},uc_resetPwd:{url:m.UCENTER+"/password/reset",method:"put"},uc_phoneExist:function(e){return{url:m.UCENTER+"/user/phone_"+e+"/exists"}},uc_geeInit:function(e){return{url:m.UCGEE+"/gee/getChallenge?addressIp="+e+"&appId="+m.UCAPPID+"&t="+(new Date).getTime()}},uc_geeVerify:{url:m.UCGEE+"/gee/verifyLogin",method:"post"}},b=function(t){function a(t){w(this,a);var l=E(this,(a.__proto__||(0,n.default)(a)).call(this,t));return l.loadCaptchas=function(e){v.default.request(_.uc_geeInit(e)).then(function(e){if(200===e.status){var t=e.data;initGeetest({gt:t.gt,challenge:t.challenge,offline:!t.success,new_captcha:t.serverStatus,product:"bind"},l.handlerEmbed),l.setState({serverStatus:t.serverStatus})}}).catch(function(e){console.log(e),g.default.MsgTip({msg:"服务器繁忙"})})},l.handlerEmbed=function(t){var a=l;t.onError(function(){g.default.MsgTip({msg:"验证错误"})}).onSuccess(function(){var n=t.getValidate(),l=a.state.serverStatus,c=e("#tel").val().replace(/\s+/g,"");n||g.default.MsgTip({msg:"请完成验证"}),v.default.request(i({},_.uc_geeVerify,{data:{challenge:n.geetest_challenge,validate:n.geetest_validate,seccode:n.geetest_seccode,addressIp:c,appId:m.UCAPPID,serverStatus:l}})).then(function(e){200!==e.status&&t.reset()}).catch(function(e){console.log(e),g.default.MsgTip({msg:"服务器繁忙"})}),a.nextHandle()}),t&&l.setState({captchaObj:t})},l.checkTel=function(e){return/^1\d{10}$/.test(e)?(l.setState({telCorrect:!0}),!0):(g.default.MsgTip({msg:"请输入正确的手机号码"}),!1)},l.changeHandle=function(){var t=e("#tel").val().replace(/\s+/g,"");11===t.length?l.setState({tel:t,inputComp:!0}):l.setState({inputComp:!1})},l.deleteTel=function(){e("#tel").val("").focus(),l.setState({tel:"",inputComp:!1})},l.onlyNum=function(){e("#tel").val(e("#tel").val().replace(/\D/g,""))},l.onClickNext=function(){var t=e("#tel").val().replace(/\s+/g,"");l.checkTel(t)&&v.default.request(i({},_.uc_phoneExist(t),{params:{appId:m.UCAPPID}})).then(function(e){var a=e.data;"200"===a.code&&(a.body?(l.loadCaptchas(t),l.getCatcha()):g.default.MsgTip({msg:"手机号还未注册"}))}).catch(function(e){console.log(e),g.default.MsgTip({msg:"服务器繁忙"})})},l.getCatcha=function(){var e=l.state.captchaObj;e?e.verify():setTimeout(l.getCatcha,1e3)},l.nextHandle=function(){var t=e("#tel").val().replace(/\s+/g,"");v.default.request(i({},_.uc_sendCode,{data:{appId:m.UCAPPID,phone:t,usage:"RESET_PASSWORD"}})).then(function(e){var t=e.data;"200"===t.code?(g.default.MsgTip({msg:"验证码已发送"}),l.setState({nextStep:!0})):g.default.MsgTip({msg:t.message})}).catch(function(e){console.log(e),g.default.MsgTip({msg:"服务器繁忙"})})},l.state={tel:"",code:"",nextStep:!1,inputComp:!1},l}return y(a,p.Component),d(a,[{key:"render",value:function(){var t=this.state,a=t.tel,n=t.inputComp;return f.default.createElement("div",{"data-page":"forget-pwd",style:{minHeight:e(window).height()}},this.state.nextStep?f.default.createElement(T,{tel:a}):f.default.createElement("div",{className:"input-area"},f.default.createElement("div",{className:"c-pr"},f.default.createElement("input",{type:"tel",id:"tel",placeholder:"请输入手机号",maxLength:"11",onChange:this.changeHandle,onKeyUp:this.onlyNum,onPaste:this.onlyNum}),f.default.createElement("img",{className:"del-icon",src:"/src/img/user/delete.png",onClick:this.deleteTel})),f.default.createElement("input",{type:"button",className:"submit-btn c-tc",style:{background:n?"#353535":"#c9c9c9"},onClick:this.onClickNext,disabled:!n,value:"下一步"}),f.default.createElement("p",{className:"promotion"},"系统会发送验证码到您的手机，请尽快查收")))}}]),a}();t.default=b;var T=function(t){function a(t){w(this,a);var l=E(this,(a.__proto__||(0,n.default)(a)).call(this,t));return l.onlyNum=function(){e("#code").val(e("#code").val().replace(/\D/g,""))},l.checkCode=function(e){return!!/^\d{4}$/.test(e)||(g.default.MsgTip({msg:"验证码不正确"}),!1)},l.checkPwd=function(e){return e.length<6?(g.default.MsgTip({msg:"新密码长度小于6位，请重新输入"}),!1):!!/^[\x21-\x7E]{6,20}$/.test(e)||(g.default.MsgTip({msg:"新密码不能包含特殊字符，请重新输入"}),!1)},l.checkSame=function(e,t){return e===t||(g.default.MsgTip({msg:"两次密码不一致"}),!1)},l.changeHandle=function(){var t=e("#new-pwd").val().replace(/\s+/g,""),a=e("#confirm-pwd").val().replace(/\s+/g,"");t&&a?l.setState({inputComp:!0}):l.setState({inputComp:!1})},l.compHandle=function(){var t=e("#code").val(),a=e("#new-pwd").val(),n=e("#confirm-pwd").val();if(l.checkCode(t)&&l.checkPwd(a)&&l.checkSame(a,n)){var c=l.props.tel;v.default.request(i({},_.uc_resetPwd,{data:{appId:m.UCAPPID,encryptFlag:!1,newPassword:a,phone:c,phoneCode:t}})).then(function(e){var t=e.data;"200"===t.code?(g.default.MsgTip({msg:"密码修改成功"}),h.browserHistory.replace("/wapLogin")):g.default.MsgTip({msg:t.message})}).catch(function(e){console.log(e),g.default.MsgTip({msg:"服务器繁忙"})})}},l.deletePwd=function(t){e(t.target).prev().val("").focus(),l.setState({inputComp:!1})},l.state={inputComp:!1},l}return y(a,p.Component),d(a,[{key:"render",value:function(){var e=this.state.inputComp;return f.default.createElement("div",{className:"input-area"},f.default.createElement("div",{className:"c-pr"},f.default.createElement("input",{type:"text",id:"code",placeholder:"请输入验证码",maxLength:"4",onChange:this.changeHandle,onKeyUp:this.onlyNum,onPaste:this.onlyNum})),f.default.createElement("div",{className:"c-pr"},f.default.createElement("input",{type:"password",id:"new-pwd",placeholder:"新密码",maxLength:"20",onChange:this.changeHandle}),f.default.createElement("img",{className:"del-icon",src:"/src/img/user/delete.png",onClick:this.deletePwd})),f.default.createElement("div",{className:"c-pr"},f.default.createElement("input",{type:"password",id:"confirm-pwd",placeholder:"确认密码",maxLength:"20",onChange:this.changeHandle}),f.default.createElement("img",{className:"del-icon",src:"/src/img/user/delete.png",onClick:this.deletePwd})),f.default.createElement("div",{className:"pwd-rule"},"密码为6-20位，由字母、数字与符号中的两种组成"),f.default.createElement("input",{type:"button",className:"submit-btn c-tc",style:{background:e?"#353535":"#c9c9c9"},onClick:this.compHandle,value:"完成",disabled:!e}),f.default.createElement("div",{className:"not-recieve"},"如果您10分钟还未收到验证码，请联系客服",f.default.createElement("a",{href:"tel:400-669-6610"}," 400-669-6610 ")))}}]),a}()}).call(this,a("OOjC"))},kVJM:function(e,t,a){}}]);